{"version":3,"sources":["../../../../contexts/TableContext.tsx","../../../../contexts/MenuContext.tsx","../../../../utils/cartUtils.ts","../../../../contexts/UserContext.tsx","../../../../contexts/LanguageContext.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\r\n\r\ninterface TableContextType {\r\n  tableId: string | null;\r\n  tableName: string | null;\r\n  isSelfService: boolean;\r\n  sessionId: string | null;\r\n  setTableInfo: (tableId: string, tableName: string) => void;\r\n  setSelfServiceMode: (sessionId: string) => void;\r\n  clearTableInfo: () => void;\r\n  isTableMode: boolean; // table veya session var mƒ±? (sepet i√ßin)\r\n  canCallWaiter: boolean; // Garson √ßaƒüƒ±rabilir mi? (self-servis'te hayƒ±r)\r\n}\r\n\r\nconst TableContext = createContext<TableContextType | undefined>(undefined);\r\n\r\nexport function TableProvider({ children }: { children: React.ReactNode }) {\r\n  const [tableId, setTableId] = useState<string | null>(null);\r\n  const [tableName, setTableName] = useState<string | null>(null);\r\n  const [isSelfService, setIsSelfService] = useState(false);\r\n  const [sessionId, setSessionId] = useState<string | null>(null);\r\n\r\n  // Auto-detect table/session from URL on mount\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') {\r\n      return;\r\n    }\r\n\r\n    const params = new URLSearchParams(window.location.search);\r\n    const tableParam = params.get('table');\r\n    const sessionParam = params.get('session');\r\n\r\n    const selfServiceCookie = getCookie('isSelfService');\r\n\r\n    if (sessionParam) {\r\n      validateSession(sessionParam);\r\n    } else if (tableParam) {\r\n      setTableInfo(tableParam, tableParam);\r\n      if (selfServiceCookie) {\r\n        deleteCookie('isSelfService');\r\n      }\r\n    } else {\r\n      if (selfServiceCookie) {\r\n        deleteCookie('isSelfService');\r\n      }\r\n      setTableId(null);\r\n      setTableName(null);\r\n      setIsSelfService(false);\r\n      setSessionId(null);\r\n    }\r\n  }, []);\r\n\r\n  /**\r\n   * Validate session from API\r\n   */\r\n  const validateSession = async (session: string) => {\r\n    try {\r\n      const response = await fetch(`/api/selfservice/validate?sessionId=${session}`);\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        setSelfServiceMode(session);\r\n        markSessionAsUsed(session);\r\n      } else {\r\n        console.error('‚ùå Self-servis session ge√ßersiz:', data.message);\r\n        if (typeof window !== 'undefined') {\r\n          const url = new URL(window.location.href);\r\n          url.searchParams.delete('session');\r\n          window.history.replaceState({}, '', url.toString());\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('‚ùå Session validation error:', error);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Mark session as used (background API call)\r\n   */\r\n  const markSessionAsUsed = async (session: string) => {\r\n    try {\r\n      const userAgent = navigator.userAgent;\r\n\r\n      await fetch('/api/selfservice/use', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          sessionId: session,\r\n          endUserId: null,\r\n          ipAddress: null,\r\n          userAgent: userAgent,\r\n        }),\r\n      });\r\n    } catch (error) {\r\n      console.error('‚ùå UseSession error:', error);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Set table info (normal table mode)\r\n   */\r\n  const setTableInfo = useCallback((tableId: string, tableName: string) => {\r\n    setTableId(tableId);\r\n    setTableName(tableName);\r\n    setIsSelfService(false);\r\n    setSessionId(null);\r\n  }, []);\r\n\r\n  /**\r\n   * Set self-service mode\r\n   */\r\n  const setSelfServiceMode = useCallback((session: string) => {\r\n    setIsSelfService(true);\r\n    setSessionId(session);\r\n    setTableName('Self-Servis');\r\n    setTableId(null);\r\n    setCookie('isSelfService', 'true', 24);\r\n  }, []);\r\n\r\n  /**\r\n   * Clear table/session info\r\n   */\r\n  const clearTableInfo = useCallback(() => {\r\n    setTableId(null);\r\n    setTableName(null);\r\n    setIsSelfService(false);\r\n    setSessionId(null);\r\n    deleteCookie('isSelfService');\r\n  }, []);\r\n\r\n  const value: TableContextType = {\r\n    tableId,\r\n    tableName,\r\n    isSelfService,\r\n    sessionId,\r\n    setTableInfo,\r\n    setSelfServiceMode,\r\n    clearTableInfo,\r\n    isTableMode: !!tableId || isSelfService, // Sepet i√ßin: table VEYA session varsa true\r\n    canCallWaiter: !!tableId && !isSelfService, // Garson i√ßin: table var VE self-servis DEƒûƒ∞L\r\n  };\r\n\r\n  return <TableContext.Provider value={value}>{children}</TableContext.Provider>;\r\n}\r\n\r\nexport function useTable() {\r\n  const context = useContext(TableContext);\r\n  if (context === undefined) {\r\n    throw new Error('useTable must be used within a TableProvider');\r\n  }\r\n  return context;\r\n}\r\n\r\n// Cookie helper functions\r\nfunction setCookie(name: string, value: string, hours: number) {\r\n  const expires = new Date();\r\n  expires.setTime(expires.getTime() + hours * 60 * 60 * 1000);\r\n  document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/`;\r\n}\r\n\r\nfunction getCookie(name: string): string | null {\r\n  const nameEQ = name + '=';\r\n  const ca = document.cookie.split(';');\r\n  for (let i = 0; i < ca.length; i++) {\r\n    let c = ca[i];\r\n    while (c.charAt(0) === ' ') c = c.substring(1, c.length);\r\n    if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction deleteCookie(name: string) {\r\n  document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;`;\r\n}\r\n","'use client';\r\n\r\nimport { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport { useTable } from '@/contexts/TableContext';\r\nimport { checkAndCleanCart } from '@/utils/cartUtils';\r\nimport type { MenuDto, MenuListDto, Product, CustomerInfoResponse, CategoryDto, ProductTokenSetting } from '@/types/api';\r\n\r\ninterface MenuContextType {\r\n  menuData: MenuDto | null;\r\n  setMenuData: (data: MenuDto | null) => void;\r\n  customerData: CustomerInfoResponse | null;\r\n  setCustomerData: (data: CustomerInfoResponse | null) => void;\r\n  categoriesData: CategoryDto[];\r\n  setCategoriesData: (data: CategoryDto[]) => void;\r\n  customerCode: string | null;\r\n  setCustomerCode: (code: string | null) => void;\r\n  tableId: string | null;\r\n  setTableId: (tableId: string | null) => void;\r\n  selectedCategory: MenuListDto | null;\r\n  setSelectedCategory: (category: MenuListDto | null) => void;\r\n  selectedProduct: Product | null;\r\n  setSelectedProduct: (product: Product | null) => void;\r\n  isProductListModalOpen: boolean;\r\n  openProductListModal: (category: MenuListDto) => void;\r\n  closeProductListModal: () => void;\r\n  isProductDetailModalOpen: boolean;\r\n  openProductDetailModal: (product: Product) => void;\r\n  closeProductDetailModal: () => void;\r\n  // Game modal\r\n  isGameModalOpen: boolean;\r\n  selectedGame: '2048' | 'rps' | 'quiz' | 'okey' | 'backgammon' | null;\r\n  activeGame: '2048' | 'rps' | 'quiz' | 'okey' | 'backgammon' | null;\r\n  setActiveGame: (game: '2048' | 'rps' | 'quiz' | 'okey' | 'backgammon' | null) => void;\r\n  openGameModal: (game?: '2048' | 'rps' | 'quiz' | 'okey' | 'backgammon') => void;\r\n  closeGameModal: () => void;\r\n  pendingJoinRoomId: string | null;\r\n  setPendingJoinRoomId: (roomId: string | null) => void;\r\n  // Profile sidebar\r\n  isProfileOpen: boolean;\r\n  openProfile: () => void;\r\n  closeProfile: () => void;\r\n  // Token system\r\n  productTokenSettings: Record<number, ProductTokenSetting>;\r\n  setProductTokenSettings: (settings: Record<number, ProductTokenSetting>) => void;\r\n  userTokenBalance: number;\r\n  setUserTokenBalance: (balance: number) => void;\r\n  // Table/Session state (from TableContext)\r\n  isTableMode: boolean;\r\n  isSelfService: boolean;\r\n  sessionId: string | null;\r\n  cartKey: string; // tableId or sessionId for cart storage\r\n}\r\n\r\nconst MenuContext = createContext<MenuContextType | undefined>(undefined);\r\n\r\nexport function MenuProvider({ children }: { children: ReactNode }) {\r\n  // Get table/session state from TableContext\r\n  const { isTableMode, isSelfService, sessionId: tableSessionId, tableId: tableContextTableId } = useTable();\r\n\r\n  const [menuData, setMenuData] = useState<MenuDto | null>(null);\r\n  const [customerData, setCustomerData] = useState<CustomerInfoResponse | null>(null);\r\n  const [categoriesData, setCategoriesData] = useState<CategoryDto[]>([]);\r\n  const [customerCode, setCustomerCode] = useState<string | null>(null);\r\n  const [tableId, setTableId] = useState<string | null>(null);\r\n  const [selectedCategory, setSelectedCategory] = useState<MenuListDto | null>(null);\r\n  const [selectedProduct, setSelectedProduct] = useState<Product | null>(null);\r\n  const [isProductListModalOpen, setIsProductListModalOpen] = useState(false);\r\n  const [isProductDetailModalOpen, setIsProductDetailModalOpen] = useState(false);\r\n  const [isGameModalOpen, setIsGameModalOpen] = useState(false);\r\n  const [selectedGame, setSelectedGame] = useState<'2048' | 'rps' | 'quiz' | 'okey' | 'backgammon' | null>(null);\r\n  const [activeGame, setActiveGame] = useState<'2048' | 'rps' | 'quiz' | 'okey' | 'backgammon' | null>(null);\r\n  const [pendingJoinRoomId, setPendingJoinRoomId] = useState<string | null>(null);\r\n  const [isProfileOpen, setIsProfileOpen] = useState(false);\r\n  const [productTokenSettings, setProductTokenSettings] = useState<Record<number, ProductTokenSetting>>({});\r\n  const [userTokenBalance, setUserTokenBalance] = useState(0);\r\n\r\n  // Cart key: use tableId if available, otherwise sessionId\r\n  const cartKey = tableId || tableSessionId || tableContextTableId || '';\r\n\r\n  // üõí Sepet y√∂netimi: customer deƒüi≈ütiƒüinde veya 3 saat ge√ßtiƒüinde temizle\r\n  useEffect(() => {\r\n    if (cartKey && customerCode) {\r\n      checkAndCleanCart(cartKey, customerCode);\r\n    }\r\n  }, [cartKey, customerCode]);\r\n\r\n  const openProductListModal = (category: MenuListDto) => {\r\n    // Diƒüer modallarƒ± kapat\r\n    setIsProductDetailModalOpen(false);\r\n    setIsGameModalOpen(false);\r\n    setIsProfileOpen(false);\r\n    setSelectedProduct(null);\r\n    setSelectedGame(null);\r\n\r\n    // Bu modalƒ± a√ß\r\n    setSelectedCategory(category);\r\n    setIsProductListModalOpen(true);\r\n    document.body.style.overflow = 'hidden';\r\n  };\r\n\r\n  const closeProductListModal = () => {\r\n    setIsProductListModalOpen(false);\r\n    document.body.style.overflow = '';\r\n    setTimeout(() => setSelectedCategory(null), 300);\r\n  };\r\n\r\n  const openProductDetailModal = (product: Product) => {\r\n    // Diƒüer modallarƒ± kapat\r\n    setIsProductListModalOpen(false);\r\n    setIsGameModalOpen(false);\r\n    setIsProfileOpen(false);\r\n    setSelectedCategory(null);\r\n    setSelectedGame(null);\r\n\r\n    // Bu modalƒ± a√ß\r\n    setSelectedProduct(product);\r\n    setIsProductDetailModalOpen(true);\r\n    document.body.style.overflow = 'hidden';\r\n  };\r\n\r\n  const closeProductDetailModal = () => {\r\n    setIsProductDetailModalOpen(false);\r\n    document.body.style.overflow = '';\r\n    setTimeout(() => setSelectedProduct(null), 300);\r\n  };\r\n\r\n  const openGameModal = (game?: '2048' | 'rps' | 'quiz' | 'okey' | 'backgammon') => {\r\n    // Diƒüer modallarƒ± kapat\r\n    setIsProductListModalOpen(false);\r\n    setIsProductDetailModalOpen(false);\r\n    setIsProfileOpen(false);\r\n    setSelectedCategory(null);\r\n    setSelectedProduct(null);\r\n\r\n    // Bu modalƒ± a√ß\r\n    setSelectedGame(game || null);\r\n    setIsGameModalOpen(true);\r\n    document.body.style.overflow = 'hidden';\r\n  };\r\n\r\n  const closeGameModal = () => {\r\n    setIsGameModalOpen(false);\r\n    setActiveGame(null);\r\n    document.body.style.overflow = '';\r\n    setTimeout(() => setSelectedGame(null), 300);\r\n  };\r\n\r\n  const openProfile = () => {\r\n    // Diƒüer modallarƒ± kapat\r\n    setIsProductListModalOpen(false);\r\n    setIsProductDetailModalOpen(false);\r\n    setIsGameModalOpen(false);\r\n    setSelectedCategory(null);\r\n    setSelectedProduct(null);\r\n    setSelectedGame(null);\r\n\r\n    // Profili a√ß\r\n    setIsProfileOpen(true);\r\n    document.body.style.overflow = 'hidden';\r\n  };\r\n\r\n  const closeProfile = () => {\r\n    setIsProfileOpen(false);\r\n    document.body.style.overflow = '';\r\n  };\r\n\r\n  return (\r\n    <MenuContext.Provider\r\n      value={{\r\n        menuData,\r\n        setMenuData,\r\n        customerData,\r\n        setCustomerData,\r\n        categoriesData,\r\n        setCategoriesData,\r\n        customerCode,\r\n        setCustomerCode,\r\n        tableId,\r\n        setTableId,\r\n        selectedCategory,\r\n        setSelectedCategory,\r\n        selectedProduct,\r\n        setSelectedProduct,\r\n        isProductListModalOpen,\r\n        openProductListModal,\r\n        closeProductListModal,\r\n        isProductDetailModalOpen,\r\n        openProductDetailModal,\r\n        closeProductDetailModal,\r\n        isGameModalOpen,\r\n        selectedGame,\r\n        activeGame,\r\n        setActiveGame,\r\n        openGameModal,\r\n        closeGameModal,\r\n        pendingJoinRoomId,\r\n        setPendingJoinRoomId,\r\n        isProfileOpen,\r\n        openProfile,\r\n        closeProfile,\r\n        productTokenSettings,\r\n        setProductTokenSettings,\r\n        userTokenBalance,\r\n        setUserTokenBalance,\r\n        // Table/Session state (from TableContext)\r\n        isTableMode,\r\n        isSelfService,\r\n        sessionId: tableSessionId,\r\n        cartKey,\r\n      }}\r\n    >\r\n      {children}\r\n    </MenuContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useMenu() {\r\n  const context = useContext(MenuContext);\r\n  if (context === undefined) {\r\n    throw new Error('useMenu must be used within a MenuProvider');\r\n  }\r\n  return context;\r\n}\r\n","/**\r\n * Sepet y√∂netimi utility fonksiyonlarƒ±\r\n * Eski proje referansƒ±: UI/wwwroot/js/cartManager.js\r\n */\r\n\r\nconst CART_EXPIRY_TIME = 3 * 60 * 60 * 1000; // 3 saat (milisaniye)\r\n\r\ninterface CartData {\r\n  items: any[];\r\n  timestamp: number;\r\n  customerCode: string;\r\n}\r\n\r\n/**\r\n * Sepeti customerCode ile kaydet\r\n */\r\nexport function saveCart(cartKey: string, items: any[], customerCode: string) {\r\n  try {\r\n    const cartData: CartData = {\r\n      items,\r\n      timestamp: Date.now(),\r\n      customerCode,\r\n    };\r\n    localStorage.setItem(`cart_${cartKey}`, JSON.stringify(cartData));\r\n  } catch (error) {\r\n    console.error('Cart save error:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Sepeti y√ºkle ve ge√ßerlilik kontrol√º yap\r\n * - Ba≈üka customerCode'dan geliyorsa temizle\r\n * - 3 saatten eski ise temizle\r\n */\r\nexport function loadCart(cartKey: string, currentCustomerCode: string): any[] {\r\n  try {\r\n    const stored = localStorage.getItem(`cart_${cartKey}`);\r\n    if (!stored) return [];\r\n\r\n    const cartData: CartData = JSON.parse(stored);\r\n\r\n    // 1. CustomerCode kontrol√º - ba≈üka customer ise temizle\r\n    if (cartData.customerCode && cartData.customerCode !== currentCustomerCode) {\r\n      console.log('üóëÔ∏è Cart cleared: Different customer code', {\r\n        old: cartData.customerCode,\r\n        new: currentCustomerCode,\r\n      });\r\n      clearCart(cartKey);\r\n      return [];\r\n    }\r\n\r\n    // 2. Zaman kontrol√º - 3 saatten eski ise temizle\r\n    const now = Date.now();\r\n    const age = now - (cartData.timestamp || 0);\r\n    if (age > CART_EXPIRY_TIME) {\r\n      console.log('üóëÔ∏è Cart cleared: Expired (> 3 hours)', {\r\n        age: Math.floor(age / 1000 / 60),\r\n        minutes: Math.floor(age / 1000 / 60),\r\n      });\r\n      clearCart(cartKey);\r\n      return [];\r\n    }\r\n\r\n    return cartData.items || [];\r\n  } catch (error) {\r\n    console.error('Cart load error:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\n/**\r\n * Sepeti temizle\r\n */\r\nexport function clearCart(cartKey: string) {\r\n  try {\r\n    localStorage.removeItem(`cart_${cartKey}`);\r\n    // cartUpdated event'i dispatch et\r\n    if (typeof window !== 'undefined') {\r\n      window.dispatchEvent(new Event('cartUpdated'));\r\n    }\r\n  } catch (error) {\r\n    console.error('Cart clear error:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Sepet kontrol√º - customer deƒüi≈ütiƒüinde veya zaman a≈üƒ±mƒ±nda temizle\r\n */\r\nexport function checkAndCleanCart(cartKey: string, customerCode: string) {\r\n  if (!cartKey || !customerCode) return;\r\n  loadCart(cartKey, customerCode);\r\n}\r\n","'use client';\r\n\r\nimport React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\r\n\r\nexport interface UserData {\r\n  id?: number;\r\n  userId?: number;\r\n  Id?: number; // Backend might use capital I\r\n  firstName?: string;\r\n  lastName?: string;\r\n  name?: string;\r\n  surname?: string;\r\n  email: string;\r\n  phoneNumber?: string;\r\n  phoneNumberCompleted?: boolean;\r\n  loyaltyPoints?: number;\r\n  tokenBalance?: number;\r\n  registerDate?: string;\r\n  allergies?: string; // Alerji bilgileri (JSON array veya virg√ºlle ayrƒ±lmƒ±≈ü)\r\n  [key: string]: any; // Allow any other fields from backend\r\n}\r\n\r\ninterface UserContextType {\r\n  currentUser: UserData | null;\r\n  isAuthenticated: boolean;\r\n  isLoading: boolean;\r\n  login: (email: string, password: string) => Promise<{ success: boolean; error?: string }>;\r\n  register: (data: RegisterData) => Promise<{ success: boolean; error?: string }>;\r\n  logout: () => void;\r\n  refreshUserProfile: () => Promise<void>;\r\n  updateTokenBalance: (newBalance: number) => void;\r\n}\r\n\r\ninterface RegisterData {\r\n  name: string;\r\n  surname: string;\r\n  email: string;\r\n  password: string;\r\n  phoneNumber?: string;\r\n}\r\n\r\nconst UserContext = createContext<UserContextType | undefined>(undefined);\r\n\r\nexport function UserProvider({ children }: { children: React.ReactNode }) {\r\n  const [currentUser, setCurrentUser] = useState<UserData | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  // Helper function to extract user from nested response\r\n  const extractUser = (data: any): UserData | null => {\r\n    if (!data) return null;\r\n\r\n    // If data has success and user properties (wrong format), extract user\r\n    if (data.success && data.user) {\r\n      return data.user;\r\n    }\r\n\r\n    // Otherwise return as-is\r\n    return data;\r\n  };\r\n\r\n  // Auto-login: Check for existing session on mount\r\n  useEffect(() => {\r\n    checkUserSession();\r\n  }, []);\r\n\r\n  /**\r\n   * Check if user has an active session\r\n   */\r\n  const checkUserSession = useCallback(async () => {\r\n    try {\r\n      const token = localStorage.getItem('userToken');\r\n      const userData = localStorage.getItem('userData');\r\n\r\n      if (!token) {\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      // If we have token and userData, restore session immediately\r\n      if (userData) {\r\n        try {\r\n          let parsedUser = JSON.parse(userData);\r\n\r\n          // Extract user if in wrong format\r\n          const cleanUser = extractUser(parsedUser);\r\n\r\n          // Update localStorage with correct format\r\n          if (cleanUser && cleanUser !== parsedUser) {\r\n            localStorage.setItem('userData', JSON.stringify(cleanUser));\r\n          }\r\n\r\n          setCurrentUser(cleanUser);\r\n\r\n          // Validate token in background\r\n          validateToken(token).catch(() => {\r\n            logout();\r\n          });\r\n        } catch (e) {\r\n          console.error('‚ùå Failed to parse user data:', e);\r\n          localStorage.removeItem('userData');\r\n        }\r\n      } else if (token) {\r\n        // We have token but no userData, fetch from API\r\n        await validateToken(token);\r\n      }\r\n    } catch (error) {\r\n      console.error('‚ùå Session check error:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  /**\r\n   * Validate token and fetch user profile\r\n   */\r\n  const validateToken = async (token: string): Promise<boolean> => {\r\n    try {\r\n      const response = await fetch('/api/auth/profile', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Token validation failed');\r\n      }\r\n\r\n      const userData = await response.json();\r\n      const cleanUser = extractUser(userData);\r\n      setCurrentUser(cleanUser);\r\n      localStorage.setItem('userData', JSON.stringify(cleanUser));\r\n      return true;\r\n    } catch (error) {\r\n      console.error('‚ùå Token validation error:', error);\r\n      logout();\r\n      return false;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Login user\r\n   */\r\n  const login = async (email: string, password: string): Promise<{ success: boolean; error?: string }> => {\r\n    try {\r\n      const response = await fetch('/api/auth/login', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ phoneOrEmail: email, password }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (!response.ok || !data.success) {\r\n        return {\r\n          success: false,\r\n          error: data.message || 'Giri≈ü ba≈üarƒ±sƒ±z. L√ºtfen bilgilerinizi kontrol edin.'\r\n        };\r\n      }\r\n\r\n      const cleanUser = extractUser(data);\r\n\r\n      localStorage.setItem('userToken', data.token);\r\n      localStorage.setItem('userData', JSON.stringify(cleanUser));\r\n      localStorage.setItem('lastLoginTime', Date.now().toString());\r\n\r\n      setCurrentUser(cleanUser);\r\n\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('‚ùå Login error:', error);\r\n      return {\r\n        success: false,\r\n        error: 'Baƒülantƒ± hatasƒ±. L√ºtfen tekrar deneyin.'\r\n      };\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Register new user\r\n   */\r\n  const register = async (registerData: RegisterData): Promise<{ success: boolean; error?: string }> => {\r\n    try {\r\n      const response = await fetch('/api/auth/register', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          firstName: registerData.name,\r\n          lastName: registerData.surname,\r\n          email: registerData.email,\r\n          password: registerData.password,\r\n          phoneNumber: registerData.phoneNumber,\r\n        }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (!response.ok || !data.success) {\r\n        return {\r\n          success: false,\r\n          error: data.message || 'Kayƒ±t ba≈üarƒ±sƒ±z. L√ºtfen bilgilerinizi kontrol edin.'\r\n        };\r\n      }\r\n\r\n      // Auto-login after registration\r\n      if (data.token && data.user) {\r\n        const cleanUser = extractUser(data);\r\n        localStorage.setItem('userToken', data.token);\r\n        localStorage.setItem('userData', JSON.stringify(cleanUser));\r\n        localStorage.setItem('lastLoginTime', Date.now().toString());\r\n        setCurrentUser(cleanUser);\r\n      }\r\n\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('‚ùå Registration error:', error);\r\n      return {\r\n        success: false,\r\n        error: 'Baƒülantƒ± hatasƒ±. L√ºtfen tekrar deneyin.'\r\n      };\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Logout user\r\n   */\r\n  const logout = useCallback(() => {\r\n    localStorage.removeItem('userToken');\r\n    localStorage.removeItem('userData');\r\n    localStorage.removeItem('lastLoginTime');\r\n    setCurrentUser(null);\r\n  }, []);\r\n\r\n  /**\r\n   * Refresh user profile from API\r\n   */\r\n  const refreshUserProfile = async () => {\r\n    const token = localStorage.getItem('userToken');\r\n    if (!token) return;\r\n\r\n    try {\r\n      const response = await fetch('/api/auth/profile', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const userData = await response.json();\r\n        const cleanUser = extractUser(userData);\r\n        setCurrentUser(cleanUser);\r\n        localStorage.setItem('userData', JSON.stringify(cleanUser));\r\n      }\r\n    } catch (error) {\r\n      console.error('‚ùå Profile refresh error:', error);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Update token balance (called by SignalR or after token transaction)\r\n   */\r\n  const updateTokenBalance = useCallback((newBalance: number) => {\r\n    setCurrentUser(prev => {\r\n      if (!prev) return null;\r\n      const updated = { ...prev, tokenBalance: newBalance };\r\n      localStorage.setItem('userData', JSON.stringify(updated));\r\n      return updated;\r\n    });\r\n  }, []);\r\n\r\n  const value: UserContextType = {\r\n    currentUser,\r\n    isAuthenticated: !!currentUser,\r\n    isLoading,\r\n    login,\r\n    register,\r\n    logout,\r\n    refreshUserProfile,\r\n    updateTokenBalance,\r\n  };\r\n\r\n  return <UserContext.Provider value={value}>{children}</UserContext.Provider>;\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = useContext(UserContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within a UserProvider');\r\n  }\r\n  return context;\r\n}\r\n","'use client';\r\n\r\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\n\r\ntype Language = 'tr' | 'en';\r\n\r\ninterface LanguageContextType {\r\n  language: Language;\r\n  toggleLanguage: () => void;\r\n  t: (key: string) => string;\r\n}\r\n\r\nconst LanguageContext = createContext<LanguageContextType | undefined>(undefined);\r\n\r\nconst translations = {\r\n  tr: {\r\n    // Bottom Nav\r\n    profile: 'Profilim',\r\n    aiAssistant: 'AI Asistan',\r\n    waiterCall: 'Garson √áaƒüƒ±r',\r\n    games: 'Beklerken Eƒülen',\r\n    cart: 'Sepetim',\r\n    callUs: 'Bizi Arayƒ±n',\r\n    sendSuggestion: '√ñneri G√∂nder',\r\n\r\n    // Header Tabs\r\n    home: 'Ana Sayfa',\r\n    featuredProducts: '√ñne √áƒ±kan √úr√ºnler',\r\n    bestSelling: 'En √áok Satƒ±lan √úr√ºnler',\r\n\r\n    // Product Modal\r\n    price: 'Fiyat',\r\n    addToCart: 'Sepete Ekle',\r\n    description: 'A√ßƒ±klama:',\r\n    noPriceMessage: 'Fiyat bilgisi i√ßin l√ºtfen garsonumuza danƒ±≈üƒ±n',\r\n    tokenEarn: 'Bu √ºr√ºnden {amount} jeton kazanacaksƒ±nƒ±z',\r\n    tokenRedeem: '{amount} jeton ile bedava alabilirsiniz',\r\n    previousProduct: '√ñnceki √úr√ºn',\r\n    nextProduct: 'Sonraki √úr√ºn',\r\n\r\n    // Cart\r\n    myCart: 'Sepetim',\r\n    emptyCart: 'Sepetiniz bo≈ü',\r\n    total: 'Toplam',\r\n    placeOrder: 'Sipari≈ü Ver',\r\n    note: 'Not',\r\n\r\n    // Profile\r\n    myProfile: 'Profilim',\r\n    orders: 'Sipari≈ülerim',\r\n    tokens: 'Jetonlarƒ±m',\r\n    allergies: 'Alerji Bilgilerim',\r\n    settings: 'Ayarlar',\r\n    login: 'Giri≈ü Yap',\r\n    register: 'Kayƒ±t Ol',\r\n    logout: '√áƒ±kƒ±≈ü Yap',\r\n\r\n    // Suggestion Modal\r\n    suggestionTitle: '√ñneri & Geri Bildirim',\r\n    suggestionSubtitle: 'Fikirleriniz bizim i√ßin deƒüerli!',\r\n    name: 'ƒ∞sim',\r\n    nameOptional: 'ƒ∞sim (Opsiyonel)',\r\n    venueRequest: 'G√∂rmek ƒ∞stediƒüiniz Mekan',\r\n    category: 'Kategori',\r\n    selectCategory: 'Se√ßiniz',\r\n    suggestion: '√ñneri',\r\n    complaint: '≈ûikayet',\r\n    compliment: 'Te≈üekk√ºr',\r\n    featureRequest: '√ñzellik ƒ∞steƒüi',\r\n    other: 'Diƒüer',\r\n    yourMessage: 'Mesajƒ±nƒ±z',\r\n    send: 'G√∂nder',\r\n    cancel: 'ƒ∞ptal',\r\n    sending: 'G√∂nderiliyor...',\r\n    thankYou: 'Te≈üekk√ºrler!',\r\n    error: 'Hata!',\r\n\r\n    // Waiter Call\r\n    waiterCalled: 'Garson √ßaƒüƒ±rƒ±ldƒ±!',\r\n    waiterComingSoon: 'En kƒ±sa s√ºrede yanƒ±nƒ±zda olacak',\r\n    waiterRateLimit: 'Garson √áaƒüƒ±rma Limiti',\r\n    remainingTime: 'Kalan S√ºre:',\r\n    memberInfo: '√úye kullanƒ±cƒ±lar 10 dakikada bir garson √ßaƒüƒ±rabilir',\r\n    guestInfo: 'Misafirler 30 dakikada bir garson √ßaƒüƒ±rabilir',\r\n    becomeMember: '√úye olun ve 10 dakikada bir √ßaƒüƒ±rƒ±n!',\r\n\r\n    // Email Verified\r\n    emailVerified: 'Email adresiniz ba≈üarƒ±yla doƒürulandƒ±!',\r\n\r\n    // Products\r\n    noProductsInCategory: 'Bu kategoride √ºr√ºn bulunmamaktadƒ±r.',\r\n    productLoading: '√úr√ºn Y√ºkleniyor...',\r\n    noProductsFound: '√úr√ºn bulunamadƒ±',\r\n    noPrice: 'Fiyat yok',\r\n    noPriceInfo: 'Fiyat bilgisi yok',\r\n    addedToCart: 'sepete eklendi!',\r\n    earnTokensMessage: 'Bu √ºr√ºnden {count} jeton kazanacaksƒ±nƒ±z',\r\n    redeemTokensMessage: '{count} jeton ile bedava alabilirsiniz',\r\n\r\n    // Common\r\n    ok: 'Tamam',\r\n    close: 'Kapat',\r\n    confirm: 'Onayla',\r\n    back: 'Geri',\r\n    search: 'Ara',\r\n    loading: 'Y√ºkleniyor...',\r\n  },\r\n  en: {\r\n    // Bottom Nav\r\n    profile: 'My Profile',\r\n    aiAssistant: 'AI Assistant',\r\n    waiterCall: 'Call Waiter',\r\n    games: 'Play While Waiting',\r\n    cart: 'My Cart',\r\n    callUs: 'Call Us',\r\n    sendSuggestion: 'Send Suggestion',\r\n\r\n    // Header Tabs\r\n    home: 'Home',\r\n    featuredProducts: 'Featured Products',\r\n    bestSelling: 'Best Selling Products',\r\n\r\n    // Product Modal\r\n    price: 'Price',\r\n    addToCart: 'Add to Cart',\r\n    description: 'Description:',\r\n    noPriceMessage: 'Please ask our waiter for price information',\r\n    tokenEarn: 'You will earn {amount} tokens from this product',\r\n    tokenRedeem: 'You can get it for free with {amount} tokens',\r\n    previousProduct: 'Previous Product',\r\n    nextProduct: 'Next Product',\r\n\r\n    // Cart\r\n    myCart: 'My Cart',\r\n    emptyCart: 'Your cart is empty',\r\n    total: 'Total',\r\n    placeOrder: 'Place Order',\r\n    note: 'Note',\r\n\r\n    // Profile\r\n    myProfile: 'My Profile',\r\n    orders: 'My Orders',\r\n    tokens: 'My Tokens',\r\n    allergies: 'My Allergies',\r\n    settings: 'Settings',\r\n    login: 'Login',\r\n    register: 'Register',\r\n    logout: 'Logout',\r\n\r\n    // Suggestion Modal\r\n    suggestionTitle: 'Suggestions & Feedback',\r\n    suggestionSubtitle: 'Your ideas are valuable to us!',\r\n    name: 'Name',\r\n    nameOptional: 'Name (Optional)',\r\n    venueRequest: 'Venue You Want to See',\r\n    category: 'Category',\r\n    selectCategory: 'Select',\r\n    suggestion: 'Suggestion',\r\n    complaint: 'Complaint',\r\n    compliment: 'Thank You',\r\n    featureRequest: 'Feature Request',\r\n    other: 'Other',\r\n    yourMessage: 'Your Message',\r\n    send: 'Send',\r\n    cancel: 'Cancel',\r\n    sending: 'Sending...',\r\n    thankYou: 'Thank You!',\r\n    error: 'Error!',\r\n\r\n    // Waiter Call\r\n    waiterCalled: 'Waiter called!',\r\n    waiterComingSoon: 'Will be with you shortly',\r\n    waiterRateLimit: 'Waiter Call Limit',\r\n    remainingTime: 'Remaining Time:',\r\n    memberInfo: 'Members can call waiter every 10 minutes',\r\n    guestInfo: 'Guests can call waiter every 30 minutes',\r\n    becomeMember: 'Become a member and call every 10 minutes!',\r\n\r\n    // Email Verified\r\n    emailVerified: 'Your email has been successfully verified!',\r\n\r\n    // Products\r\n    noProductsInCategory: 'No products in this category.',\r\n    productLoading: 'Product Loading...',\r\n    noProductsFound: 'No products found',\r\n    noPrice: 'No price',\r\n    noPriceInfo: 'No price information',\r\n    addedToCart: 'added to cart!',\r\n    earnTokensMessage: 'You will earn {count} tokens from this product',\r\n    redeemTokensMessage: 'You can get it for free with {count} tokens',\r\n\r\n    // Common\r\n    ok: 'OK',\r\n    close: 'Close',\r\n    confirm: 'Confirm',\r\n    back: 'Back',\r\n    search: 'Search',\r\n    loading: 'Loading...',\r\n  },\r\n};\r\n\r\nexport function LanguageProvider({ children }: { children: ReactNode }) {\r\n  const [language, setLanguage] = useState<Language>('tr');\r\n\r\n  useEffect(() => {\r\n    // Load saved language preference\r\n    const savedLanguage = localStorage.getItem('preferredLanguage') as Language;\r\n    if (savedLanguage === 'en' || savedLanguage === 'tr') {\r\n      setLanguage(savedLanguage);\r\n    }\r\n  }, []);\r\n\r\n  const toggleLanguage = () => {\r\n    const newLang: Language = language === 'tr' ? 'en' : 'tr';\r\n    setLanguage(newLang);\r\n    localStorage.setItem('preferredLanguage', newLang);\r\n\r\n    // Dispatch event for other components\r\n    window.dispatchEvent(new CustomEvent('languageChanged', { detail: { language: newLang } }));\r\n  };\r\n\r\n  const t = (key: string): string => {\r\n    return translations[language][key as keyof typeof translations.tr] || key;\r\n  };\r\n\r\n  return (\r\n    <LanguageContext.Provider value={{ language, toggleLanguage, t }}>\r\n      {children}\r\n    </LanguageContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useLanguage() {\r\n  const context = useContext(LanguageContext);\r\n  if (context === undefined) {\r\n    throw new Error('useLanguage must be used within a LanguageProvider');\r\n  }\r\n  return context;\r\n}\r\n"],"names":[],"mappings":"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"}