module.exports=[63945,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(27064),f=a.i(33012),g=a.i(69590),h=a.i(18642),i=a.i(3207),j=a.i(12584),k=a.i(65581),l=a.i(53692),m=a.i(71987);function n({logoUrl:a,backgroundUrl:d,onComplete:e}){let[f,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(!1);if((0,c.useEffect)(()=>{let a=setTimeout(()=>{let a=document.querySelector(".splash-screen");a?.classList.add("liquid-morph"),setTimeout(()=>{g(!1),e()},600)},600);return()=>clearTimeout(a)},[e]),!f)return null;let j=d?{backgroundImage:`url('${d}')`,backgroundPosition:"center center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"};return(0,b.jsx)("div",{className:"splash-screen active",style:j,children:(0,b.jsx)("div",{className:"splash-content",children:h?(0,b.jsx)("div",{style:{width:"350px",height:"350px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"48px",color:"white",fontWeight:"bold"},children:"LOGO"}):(0,b.jsx)(m.default,{src:a,alt:"Logo",width:350,height:350,className:"splash-logo",priority:!0,onError:()=>i(!0)})})})}function o({bannerUrl:a,isOpen:d,onClose:e}){return((0,c.useEffect)(()=>(d?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[d]),d)?(0,b.jsx)("div",{className:"banner-overlay",style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,opacity:1,transition:"opacity 0.3s ease"},onClick:e,children:(0,b.jsxs)("div",{className:"banner-content",style:{position:"relative",maxWidth:window.innerWidth<=480?"95%":"90%",maxHeight:window.innerWidth<=480?"80%":"90%",borderRadius:"12px",overflow:"hidden",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.5)",transition:"transform 0.3s ease"},onClick:e,children:[(0,b.jsx)("button",{className:"banner-close-btn",onClick:a=>{a.stopPropagation(),e()},"aria-label":"Kapat",style:{position:"absolute",top:"10px",right:"10px",width:"32px",height:"32px",background:"rgba(0, 0, 0, 0.7)",border:"none",borderRadius:"50%",color:"white",fontSize:"20px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10,transition:"background 0.2s ease, transform 0.2s ease"},onMouseEnter:a=>{a.currentTarget.style.background="rgba(0, 0, 0, 0.9)",a.currentTarget.style.transform="scale(1.1)"},onMouseLeave:a=>{a.currentTarget.style.background="rgba(0, 0, 0, 0.7)",a.currentTarget.style.transform="scale(1)"},children:"√ó"}),(0,b.jsx)("img",{src:a,alt:"Banner",className:"banner-image",loading:"eager",fetchPriority:"high",decoding:"async",style:{width:"100%",height:"auto",display:"block",cursor:"pointer",maxHeight:"90vh",objectFit:"contain"}})]})}):null}var p=a.i(31626);function q({logoUrl:a,backgroundUrl:c}){let d=c?{backgroundImage:`url('${c}')`,backgroundPosition:"center center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"};return(0,b.jsxs)("div",{style:{...d,position:"fixed",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9998},className:"jsx-bf6e493c172f8c8c",children:[(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"20px"},className:"jsx-bf6e493c172f8c8c",children:a?(0,b.jsx)("div",{style:{animation:"pulse 1s ease-in-out infinite",transformOrigin:"center"},className:"jsx-bf6e493c172f8c8c",children:(0,b.jsx)(m.default,{src:a,alt:"Logo",width:200,height:200,priority:!0,style:{objectFit:"contain",filter:"drop-shadow(0 0 20px rgba(255,255,255,0.3))"}})}):(0,b.jsx)("div",{style:{width:"60px",height:"60px",border:"4px solid rgba(255, 255, 255, 0.3)",borderTop:"4px solid white",borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-bf6e493c172f8c8c"})}),(0,b.jsx)(p.default,{id:"bf6e493c172f8c8c",children:"@keyframes pulse{0%,to{opacity:1;transform:scale(1)}50%{opacity:.8;transform:scale(1.05)}}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"})]})}function r(){let{language:a,toggleLanguage:c}=(0,g.useLanguage)();return(0,b.jsx)("div",{className:"language-selector",children:(0,b.jsx)("button",{id:"languageToggle",className:`language-toggle ${"en"===a?"active":""}`,onClick:c,children:(0,b.jsx)("span",{id:"languageText",children:a.toUpperCase()})})})}function s({tab:a}){let[d,e]=(0,c.useState)(0),[f,g]=(0,c.useState)([]);return((0,c.useEffect)(()=>{a.imageUrl&&g(a.imageUrl.split(",").map(a=>a.trim()).filter(a=>a).map(a=>{if(!a.startsWith("http://")&&!a.startsWith("https://")){let b=a.startsWith("Uploads/")?a.substring(8):a;return`https://api.canlimenu.com/Uploads/${b}`}return a.replace("http://","https://")}))},[a.imageUrl]),(0,c.useEffect)(()=>{if(f.length<=1)return;let b=setInterval(()=>{e(a=>(a+1)%f.length)},a.sliderInterval||8e3);return()=>clearInterval(b)},[f.length,a.sliderInterval]),0===f.length)?(0,b.jsx)("div",{className:"header-content-image",children:(0,b.jsx)("div",{style:{textAlign:"center",padding:"20px",color:"rgba(255,255,255,0.7)"},children:"G√∂rsel bulunamadƒ±"})}):(0,b.jsx)("div",{className:"header-content-image",children:(0,b.jsxs)("div",{className:"header-image-slider",children:[f.map((a,c)=>(0,b.jsx)("div",{className:`header-image-slide ${c===d?"active":""}`,"data-slide":c,children:(0,b.jsx)(m.default,{src:a,alt:`Slide ${c+1}`,width:1920,height:1080,style:{width:"100%",height:"100%",objectFit:"cover"},loading:"eager",fetchPriority:"high"})},c)),f.length>1&&(0,b.jsx)("div",{className:"header-slider-dots",children:f.map((a,c)=>(0,b.jsx)("span",{className:`header-slider-dot ${c===d?"active":""}`,onClick:()=>e(c),"data-slide":c},c))})]})})}function t({tab:a}){return a.videoUrl?(0,b.jsx)("div",{className:"header-content-video",children:(0,b.jsxs)("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{width:"100%",height:"100%",objectFit:"cover"},children:[(0,b.jsx)("source",{src:a.videoUrl,type:"video/mp4"}),"Tarayƒ±cƒ±nƒ±z video oynatmayƒ± desteklemiyor."]})}):(0,b.jsx)("div",{className:"header-content-video",children:(0,b.jsx)("div",{style:{textAlign:"center",padding:"20px",color:"rgba(255,255,255,0.7)"},children:"Video bulunamadƒ±"})})}function u({tab:a}){let c=(a=>{if(!a)return{title:"",subtitle:"",ctaText:""};try{let b=JSON.parse(a);return{title:b.title||b.Title||"",subtitle:b.subtitle||b.Subtitle||"",ctaText:b.ctaText||b.CtaText||""}}catch{return{title:a,subtitle:"",ctaText:""}}})(a.campaignText);return(0,b.jsxs)("div",{className:"header-content-campaign",children:[c.title&&(0,b.jsx)("div",{className:"header-campaign-title",children:c.title}),c.subtitle&&(0,b.jsx)("div",{className:"header-campaign-subtitle",children:c.subtitle}),c.ctaText&&(0,b.jsx)("a",{href:"#categories",className:"header-campaign-cta",onClick:a=>{a.preventDefault();let b=document.querySelector(".categories-grid");b&&b.scrollIntoView({behavior:"smooth"})},children:c.ctaText})]})}function v(a,b){if("en"===b){let b=a.titleEnglish||a.TitleEnglish||a.titleEn||a.TitleEn||a.nameEn||a.title||a.Title||a.name||"";if(b&&""!==b.trim())return b}return a.title||a.Title||a.name||""}function w(a,b){if("en"===b){let b=a.detailEnglish||a.DetailEnglish||a.detailEn||a.DetailEn||a.descriptionEnglish||a.DescriptionEnglish||a.descriptionEn||a.DescriptionEn||a.detail||a.Detail||a.description||a.Description||"";if(b&&""!==b.trim())return b}return a.detail||a.Detail||a.description||a.Description||""}function x({tab:a}){let{language:d,t:e}=(0,g.useLanguage)(),[f,h]=(0,c.useState)([]),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(!0);if((0,c.useEffect)(()=>{if(a.selectedProductIds)try{let b=JSON.parse(a.selectedProductIds);j(b)}catch(a){console.error("Failed to parse product IDs:",a),l(!1)}else l(!1)},[a.selectedProductIds]),(0,c.useEffect)(()=>{0===i.length?l(!1):(async()=>{try{let a=i.map(a=>({id:a,sambaId:a,title:e("productLoading"),price:0,categoryId:0,orderNo:0}));h(a),l(!1)}catch(a){console.error("Failed to load products:",a),l(!1)}})()},[i]),k)return(0,b.jsxs)("div",{className:"header-content-products",children:[(0,b.jsx)("div",{className:"header-products-title",children:"FavoriteProducts"===a.tabType?e("featuredProducts"):e("bestSelling")}),(0,b.jsx)("div",{className:"header-products-scroll",children:[1,2,3,4].map(a=>(0,b.jsxs)("div",{className:"header-product-card",style:{animation:"pulse 1.5s ease-in-out infinite"},children:[(0,b.jsx)("div",{style:{width:"100%",height:"80px",background:"rgba(255,255,255,0.1)",borderRadius:"8px"}}),(0,b.jsxs)("div",{className:"header-product-info",children:[(0,b.jsx)("div",{style:{width:"80%",height:"12px",background:"rgba(255,255,255,0.1)",borderRadius:"4px",marginBottom:"4px"}}),(0,b.jsx)("div",{style:{width:"50%",height:"10px",background:"rgba(255,255,255,0.1)",borderRadius:"4px"}})]})]},a))})]});if(0===f.length)return(0,b.jsx)("div",{className:"header-content-products",children:(0,b.jsx)("div",{style:{textAlign:"center",padding:"20px",color:"rgba(255,255,255,0.7)"},children:e("noProductsFound")})});let n="FavoriteProducts"===a.tabType?e("featuredProducts"):e("bestSelling");return(0,b.jsxs)("div",{className:"header-content-products",children:[(0,b.jsx)("div",{className:"header-products-title",children:n}),(0,b.jsx)("div",{className:"header-products-scroll",children:f.map(a=>{let c=v(a,d);return(0,b.jsxs)("div",{className:"header-product-card",onClick:()=>{console.log("Product clicked:",a.id)},children:[a.picture?(0,b.jsx)(m.default,{src:a.picture.startsWith("http")?a.picture.replace("http://","https://"):`https://api.canlimenu.com/Uploads/${a.picture.replace("Uploads/","")}`,alt:c,width:100,height:80,className:"header-product-image",loading:"eager"}):(0,b.jsx)("div",{className:"header-product-image",style:{background:"rgba(0,0,0,0.2)"}}),(0,b.jsxs)("div",{className:"header-product-info",children:[(0,b.jsx)("div",{className:"header-product-name",children:c}),(0,b.jsx)("div",{className:"header-product-price",children:a.price>0?`${a.price.toFixed(2)} ‚Ç∫`:e("noPrice")})]})]},a.id)})})]})}function y({customerCode:a,fallbackLogoUrl:d}){let[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(0),[i,j]=(0,c.useState)(!0),k=(0,c.useRef)(null),l=(0,c.useRef)(0),m=(0,c.useRef)(0);return(0,c.useEffect)(()=>{async function b(){try{let b=await fetch(`/api/advertisements/${a}`),c=await b.json();c.success&&c.data&&c.data.length>0&&f(c.data)}catch(a){console.error("Failed to fetch header tabs:",a)}finally{j(!1)}}a?b():j(!1)},[a]),(0,c.useEffect)(()=>{if(!(e.length<=1))return k.current=setInterval(()=>{h(a=>(a+1)%e.length)},5e3),()=>{k.current&&clearInterval(k.current)}},[e.length]),!i&&0===e.length&&d?(0,b.jsx)("div",{id:"headerArea",className:"restaurant-info logo-container",children:(0,b.jsx)("div",{className:"header-tabs-wrapper",style:{display:"flex"},children:(0,b.jsx)("div",{className:"header-content-image",style:{position:"relative",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsx)("img",{src:d,alt:"Logo",loading:"eager",fetchPriority:"high",style:{maxWidth:"90%",maxHeight:"90%",objectFit:"contain",borderRadius:"12px"}})})})}):i||0===e.length?null:(0,b.jsx)("div",{id:"headerArea",className:"restaurant-info logo-container",children:(0,b.jsxs)("div",{className:"header-tabs-wrapper",style:{display:"flex"},children:[(0,b.jsx)("div",{className:"header-tabs-slider",onTouchStart:a=>{l.current=a.touches[0].clientX},onTouchEnd:a=>{let b;m.current=a.changedTouches[0].clientX,Math.abs(b=l.current-m.current)>50&&(b>0?h(a=>(a+1)%e.length):h(a=>(a-1+e.length)%e.length))},children:e.map((a,c)=>(0,b.jsxs)("div",{className:`header-tab-content ${c===g?"active":""}`,style:{position:c===g?"relative":"absolute",visibility:c===g?"visible":"hidden",opacity:+(c===g),width:"100%",height:"100%"},children:["Image"===a.tabType&&(0,b.jsx)(s,{tab:a}),"Video"===a.tabType&&(0,b.jsx)(t,{tab:a}),"Campaign"===a.tabType&&(0,b.jsx)(u,{tab:a}),("FavoriteProducts"===a.tabType||"BestSellingProducts"===a.tabType)&&(0,b.jsx)(x,{tab:a})]},a.id))}),e.length>1&&(0,b.jsx)("div",{className:"header-tabs-dots",children:e.map((a,c)=>(0,b.jsx)("span",{className:`header-tab-dot ${c===g?"active":""}`,onClick:()=>{h(c),k.current&&clearInterval(k.current)},"data-index":c},c))})]})})}function z({categories:a}){let{menuData:c,customerData:d,openProductListModal:f}=(0,e.useMenu)(),{language:h}=(0,g.useLanguage)(),i=d?.customer.categoryFont||"Inter, serif";return(0,b.jsx)("div",{className:"categories-grid",children:a.map((a,d)=>{let e="en"===h&&a.nameEn?a.nameEn:a.name;return(0,b.jsxs)("a",{href:`#${a.id}`,className:"category-card",style:{animation:"categoryAppear 0.6s ease-out backwards",animationDelay:`${.1+.05*d}s`},onClick:b=>((a,b)=>{if(a.preventDefault(),c?.menu){let a=c.menu.find(a=>a.sambaId===b);a&&f(a)}})(b,a.id),children:[(0,b.jsx)(m.default,{src:a.image,alt:e,width:300,height:300,className:"card-image",priority:!0,unoptimized:!0}),(0,b.jsx)("div",{className:"card-content",children:(0,b.jsx)("h3",{className:"card-title",style:{fontFamily:i},children:e})})]},a.id)})})}function A({onProfileClick:a,onAIClick:d,onCartClick:e,onWaiterCall:f,onGameClick:h,onContactClick:i,onSuggestionClick:j,showAIChat:k=!0,showCart:l=!0,showWaiterCall:m=!1,cartItemCount:n=0,tableId:o,phone:q}){let[r,s]=(0,c.useState)(!1),{t}=(0,g.useLanguage)(),u=({icon:a,label:c,onClick:d,gradient:e,top:f="0",badge:g})=>(0,b.jsxs)("div",{className:"nav-item",onClick:d,style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"pointer",padding:"8px",borderRadius:"12px",transition:"all 0.3s ease",position:"relative",top:f},children:[(0,b.jsxs)("div",{style:{width:"0"!==f?"50px":"32px",height:"0"!==f?"50px":"32px",background:e,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"4px",position:"relative",boxShadow:"0"!==f?"0 4px 15px rgba(102, 126, 234, 0.3)":"none"},children:[a,void 0!==g&&g>0&&(0,b.jsx)("div",{style:{position:"absolute",top:"-5px",right:"-5px",background:"#dc3545",color:"white",borderRadius:"50%",width:"18px",height:"18px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:700,minWidth:"18px"},children:g})]}),(0,b.jsx)("span",{style:{fontSize:"11px",color:"0"!==f?"#667eea":"#666",fontWeight:"0"!==f?600:500},children:c})]});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{id:"bottomNavBar",style:{position:"fixed",bottom:0,left:0,right:0,height:"80px",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderTop:"1px solid rgba(0, 0, 0, 0.1)",display:"flex",justifyContent:"space-around",alignItems:"center",zIndex:999999,boxShadow:"0 -2px 20px rgba(0, 0, 0, 0.1)"},className:"jsx-c34ac28e8e3b4496",children:[(0,b.jsx)(u,{icon:(0,b.jsx)("svg",{style:{width:"18px",height:"18px",fill:"white"},viewBox:"0 0 24 24",className:"jsx-c34ac28e8e3b4496",children:(0,b.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z",className:"jsx-c34ac28e8e3b4496"})}),label:t("profile"),onClick:a,gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",className:"jsx-c34ac28e8e3b4496"}),k&&(0,b.jsx)(u,{icon:(0,b.jsx)("svg",{style:{width:"18px",height:"18px",fill:"white"},viewBox:"0 0 24 24",className:"jsx-c34ac28e8e3b4496",children:(0,b.jsx)("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h4l4 4 4-4h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z",className:"jsx-c34ac28e8e3b4496"})}),label:t("aiAssistant"),onClick:d,gradient:"linear-gradient(135deg, #3498db 0%, #2980b9 100%)",className:"jsx-c34ac28e8e3b4496"}),m&&o&&(0,b.jsx)(u,{icon:(0,b.jsx)("svg",{style:{width:"24px",height:"24px",fill:"white"},viewBox:"0 0 24 24",className:"jsx-c34ac28e8e3b4496",children:(0,b.jsx)("path",{d:"M18.06 23H19.72C20.56 23 21.25 22.35 21.35 21.53L23 5.05H18V1H16.03V5.05H11.06L11.36 7.39C13.07 7.86 14.67 8.71 15.63 9.65C17.07 11.07 18.06 12.54 18.06 14.94V23M1 22V21H16.03V22C16.03 22.54 15.58 23 15.03 23H2C1.45 23 1 22.54 1 22M16.03 15C16.03 7 1 7 1 15H16.03M1 17H16V19H1V17Z",className:"jsx-c34ac28e8e3b4496"})}),label:t("waiterCall"),onClick:()=>{s(!0)},gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",top:"-15px",className:"jsx-c34ac28e8e3b4496"}),(0,b.jsx)(u,{icon:(0,b.jsx)("svg",{style:{width:"18px",height:"18px",fill:"white"},viewBox:"0 0 24 24",className:"jsx-c34ac28e8e3b4496",children:(0,b.jsx)("path",{d:"M7.97,16L5,19C4.67,19.3 4.23,19.5 3.75,19.5A1.75,1.75 0 0,1 2,17.75V17.5L3,10.12C3.21,7.81 5.14,6 7.5,6H16.5C18.86,6 20.79,7.81 21,10.12L22,17.5V17.75A1.75,1.75 0 0,1 20.25,19.5C19.77,19.5 19.33,19.3 19,19L16.03,16H7.97M7.5,8A0.5,0.5 0 0,0 7,8.5A0.5,0.5 0 0,0 7.5,9A0.5,0.5 0 0,0 8,8.5A0.5,0.5 0 0,0 7.5,8M16.5,8A0.5,0.5 0 0,0 16,8.5A0.5,0.5 0 0,0 16.5,9A0.5,0.5 0 0,0 17,8.5A0.5,0.5 0 0,0 16.5,8M8.5,11A1.5,1.5 0 0,0 7,12.5A1.5,1.5 0 0,0 8.5,14A1.5,1.5 0 0,0 10,12.5A1.5,1.5 0 0,0 8.5,11M15.5,11A1.5,1.5 0 0,0 14,12.5A1.5,1.5 0 0,0 15.5,14A1.5,1.5 0 0,0 17,12.5A1.5,1.5 0 0,0 15.5,11M12,13C12.27,13 12.5,13.14 12.65,13.35L15,16H9L11.35,13.35C11.5,13.14 11.73,13 12,13Z",className:"jsx-c34ac28e8e3b4496"})}),label:t("games"),onClick:h,gradient:"linear-gradient(135deg, #9c27b0 0%, #673ab7 100%)",className:"jsx-c34ac28e8e3b4496"}),l?(0,b.jsx)(u,{icon:(0,b.jsx)("svg",{style:{width:"18px",height:"18px",fill:"white"},viewBox:"0 0 24 24",className:"jsx-c34ac28e8e3b4496",children:(0,b.jsx)("path",{d:"M7 4V2C7 1.45 7.45 1 8 1H16C16.55 1 17 1.45 17 2V4H20C20.55 4 21 4.45 21 5S20.55 6 20 6H19V19C19 20.1 18.1 21 17 21H7C5.9 21 5 20.1 5 19V6H4C3.45 6 3 5.55 3 5S3.45 4 4 4H7ZM9 3V4H15V3H9ZM7 6V19H17V6H7Z",className:"jsx-c34ac28e8e3b4496"})}),label:t("cart"),onClick:e,gradient:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",badge:n,className:"jsx-c34ac28e8e3b4496"}):q?(0,b.jsx)(u,{icon:(0,b.jsx)("svg",{style:{width:"18px",height:"18px",fill:"white"},viewBox:"0 0 24 24",className:"jsx-c34ac28e8e3b4496",children:(0,b.jsx)("path",{d:"M6.62,10.79C8.06,13.62 10.38,15.94 13.21,17.38L15.41,15.18C15.69,14.9 16.08,14.82 16.43,14.93C17.55,15.3 18.75,15.5 20,15.5A1,1 0 0,1 21,16.5V20A1,1 0 0,1 20,21A17,17 0 0,1 3,4A1,1 0 0,1 4,3H7.5A1,1 0 0,1 8.5,4C8.5,5.25 8.7,6.45 9.07,7.57C9.18,7.92 9.1,8.31 8.82,8.59L6.62,10.79Z",className:"jsx-c34ac28e8e3b4496"})}),label:t("callUs"),onClick:i,gradient:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",className:"jsx-c34ac28e8e3b4496"}):(0,b.jsx)(u,{icon:(0,b.jsx)("svg",{style:{width:"18px",height:"18px",fill:"white"},viewBox:"0 0 24 24",className:"jsx-c34ac28e8e3b4496",children:(0,b.jsx)("path",{d:"M20,2H4A2,2 0 0,0 2,4V22L6,18H20A2,2 0 0,0 22,16V4A2,2 0 0,0 20,2M6,9H18V11H6M14,14H6V12H14M18,8H6V6H18",className:"jsx-c34ac28e8e3b4496"})}),label:t("sendSuggestion"),onClick:j,gradient:"linear-gradient(135deg, #FF6B6B 0%, #FFE66D 100%)",className:"jsx-c34ac28e8e3b4496"})]}),r&&(0,b.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999,animation:"fadeIn 0.2s ease"},onClick:()=>s(!1),className:"jsx-c34ac28e8e3b4496",children:(0,b.jsxs)("div",{style:{background:"white",borderRadius:"20px",padding:"30px",maxWidth:"400px",width:"90%",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.3)",animation:"slideUp 0.3s ease",textAlign:"center"},onClick:a=>a.stopPropagation(),className:"jsx-c34ac28e8e3b4496",children:[(0,b.jsx)("div",{style:{fontSize:"60px",marginBottom:"20px"},className:"jsx-c34ac28e8e3b4496",children:"üõéÔ∏è"}),(0,b.jsx)("h3",{style:{fontSize:"22px",color:"#2d3748",marginBottom:"15px",fontWeight:600},className:"jsx-c34ac28e8e3b4496",children:"Garson √áaƒüƒ±rƒ±lsƒ±n Mƒ±?"}),(0,b.jsx)("p",{style:{color:"#718096",fontSize:"15px",marginBottom:"30px",lineHeight:1.5},className:"jsx-c34ac28e8e3b4496",children:"Garsonunuz en kƒ±sa s√ºrede masanƒ±za gelecektir"}),(0,b.jsxs)("div",{style:{display:"flex",gap:"12px"},className:"jsx-c34ac28e8e3b4496",children:[(0,b.jsx)("button",{onClick:()=>s(!1),style:{flex:1,padding:"14px 20px",background:"#e2e8f0",color:"#4a5568",border:"none",borderRadius:"12px",fontSize:"16px",fontWeight:600,cursor:"pointer",transition:"all 0.2s ease"},className:"jsx-c34ac28e8e3b4496",children:"ƒ∞ptal"}),(0,b.jsx)("button",{onClick:()=>{s(!1),f&&f()},style:{flex:1,padding:"14px 20px",background:"linear-gradient(135deg, #4ade80 0%, #22c55e 100%)",color:"white",border:"none",borderRadius:"12px",fontSize:"16px",fontWeight:600,cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 12px rgba(74, 222, 128, 0.3)"},className:"jsx-c34ac28e8e3b4496",children:"Onayla"})]})]})}),(0,b.jsx)(p.default,{id:"c34ac28e8e3b4496",children:"@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes slideUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}"})]})}function B({productAllergens:a,className:d=""}){let[e,f]=(0,c.useState)(null);return((0,c.useEffect)(()=>{f(function(a,b){if(!b||0===b.length||!a||""===a.trim())return null;let c=[];try{c=JSON.parse(a)}catch(b){c=a.split(",").map(a=>a.trim()).filter(a=>a)}let d=c.filter(a=>b.some(b=>{let c=b.replace("Diƒüer: ","").toLowerCase().trim(),d=a.toLowerCase().trim();return c===d||d.includes(c)}));if(d.length>0){let a=d.join(", "),b=d.map(a=>{let b;return(b=a.toLowerCase().trim()).includes("gluten")||b.includes("buƒüday")||b.includes("wheat")?"üåæ":b.includes("laktoz")||b.includes("s√ºt")||b.includes("milk")||b.includes("dairy")?"ü•õ":b.includes("yumurta")||b.includes("egg")?"ü•ö":b.includes("fƒ±ndƒ±k")||b.includes("fƒ±stƒ±k")||b.includes("nut")||b.includes("hazelnut")||b.includes("peanut")?"ü•ú":b.includes("balƒ±k")||b.includes("fish")?"üêü":b.includes("karides")||b.includes("deniz")||b.includes("shellfish")||b.includes("seafood")?"ü¶ê":b.includes("soya")||b.includes("soy")?"ü´ò":b.includes("susam")||b.includes("sesame")?"üå∞":b.includes("kereviz")||b.includes("celery")?"ü•¨":b.includes("hardal")||b.includes("mustard")?"üå∂Ô∏è":"‚ö†Ô∏è"}).join(" ");return{allergens:d,icons:b,text:a}}return null}(a,function(){try{let a=localStorage.getItem("userData");if(!a)return[];let b=JSON.parse(a);if(!b.allergies)return[];if(Array.isArray(b.allergies))return b.allergies;if("string"==typeof b.allergies)try{let a=JSON.parse(b.allergies);if(Array.isArray(a))return a;return[b.allergies]}catch{return[b.allergies]}return[]}catch(a){return console.error("Alerji bilgisi alƒ±namadƒ±:",a),[]}}()))},[a]),e)?(0,b.jsx)("span",{className:`allergen-warning ${d}`,title:`‚ö†Ô∏è Alerjen: ${e.text}`,children:e.icons}):null}function C(){let{menuData:a,customerData:d,categoriesData:f,selectedCategory:h,isProductListModalOpen:i,closeProductListModal:j,openProductDetailModal:k,isTableMode:l,cartKey:m,productTokenSettings:n}=(0,e.useMenu)(),{language:o,t:p}=(0,g.useLanguage)(),[q,r]=(0,c.useState)(h),[s,t]=(0,c.useState)([]),u=(0,c.useRef)(null);(0,c.useRef)(null);let x=(0,c.useRef)(0),y=(0,c.useRef)(0);(0,c.useEffect)(()=>{let a=()=>{if(l&&m){let a=localStorage.getItem(`cart_${m}`);t(a?JSON.parse(a):[])}};a();let b=()=>{a()};return window.addEventListener("cartUpdated",b),()=>window.removeEventListener("cartUpdated",b)},[l,m]);let z=a=>{let b=s.find(b=>b.productId===a);return b?b.quantity:0};(0,c.useEffect)(()=>{h&&r(h)},[h]),(0,c.useEffect)(()=>{let a=a=>{"Escape"===a.key&&i&&j()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[i,j]);(0,c.useEffect)(()=>{if(u.current&&q&&a?.menu){let b=a.menu.findIndex(a=>a.sambaId===q.sambaId);if(-1!==b){let a=u.current.querySelectorAll(".category-item")[b];a&&setTimeout(()=>{let b=a.offsetLeft-u.current.offsetWidth/2+a.offsetWidth/2;u.current?.scrollTo({left:b,behavior:"smooth"})},100)}}},[q,a]);let A=a?.menu||[],C=a=>{r(a)},D=(a,b)=>a?a.startsWith("http")?a.replace("http://","https://"):"https://api.canlimenu.com/Uploads/"+(a.startsWith("Uploads/")?a.substring(8):a):b||'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="300" height="300"%3E%3Crect fill="%23667eea" width="300" height="300"/%3E%3C/svg%3E',E=a?.customerLogo?D(a.customerLogo):void 0,F=d?.customer.webBackground?d.customer.webBackground.startsWith("http")?d.customer.webBackground.replace("http://","https://"):`https://api.canlimenu.com/Uploads/${d.customer.webBackground.replace("Uploads/","")}`:void 0,G=F?{backgroundImage:`url('${F}')`,backgroundPosition:"center center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},H=d?.customer.productFont||"Inter, sans-serif",I=d?.customer.productTitleColor||"#FFFFFF",J=d?.customer.productDescriptionColor||"rgba(255, 255, 255, 0.88)",K={fontFamily:H,color:I},L={fontFamily:H,color:J};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"product-modal-overlay",onClick:j,style:{display:i?"block":"none",opacity:+!!i}}),(0,b.jsx)("div",{className:"product-modal-container",style:{...G,display:i?"flex":"none",opacity:+!!i,transform:i?"translateX(-50%) translateY(0)":"translateX(-50%) translateY(20px)"},children:(0,b.jsxs)("div",{className:"page-content",children:[(0,b.jsx)("div",{className:"container page-header",style:{marginBottom:0,paddingBottom:0},children:(0,b.jsxs)("a",{href:"#",onClick:a=>{a.preventDefault(),j()},style:{fontSize:"20px",color:"white"},children:[(0,b.jsx)("i",{className:"fa-solid fa-caret-left"})," ",p("back")]})}),(0,b.jsx)("div",{className:"container",style:{paddingBottom:0},children:(0,b.jsx)("div",{className:"current-category-title",children:(0,b.jsx)("h2",{id:"modalCategoryTitle",children:(()=>{if(!q)return"";let a=f.find(a=>a.category.sambaId===q.sambaId),b=a?.category?.titleEnglish||"";return"en"===o&&b?b:q.title})()})})}),(0,b.jsx)("div",{className:"container",style:{paddingBottom:0,overflowX:"visible"},children:(0,b.jsx)("div",{className:"category-slider-section",children:(0,b.jsx)("div",{className:"category-slider",id:"modalCategorySlider",ref:u,children:A.map(a=>{let c=f.find(b=>b.category.sambaId===a.sambaId),d="";if(c&&c.picture){let a=c.picture;if(a.startsWith("http"))d=a.replace("http://","https://");else{let b=a.startsWith("Uploads/")?a.substring(8):a;d=`https://api.canlimenu.com/Uploads/${b}`}}else d=E||'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="300" height="300"%3E%3Crect fill="%23667eea" width="300" height="300"/%3E%3C/svg%3E';let e=a.sambaId===q?.sambaId,g=c?.category?.titleEnglish||"",h="en"===o&&g?g:a.title;return(0,b.jsxs)("a",{href:"#",className:"category-item category-slide"+(e?" active":""),"data-category-id":a.sambaId,onClick:b=>{b.preventDefault(),C(a)},children:[(0,b.jsx)("div",{className:"image-box",children:(0,b.jsx)("img",{src:d,alt:h,loading:"eager"})}),(0,b.jsx)("div",{className:"category-title",children:h})]},a.sambaId)})})})}),(0,b.jsx)("div",{className:"container",style:{paddingTop:0,paddingBottom:"120px"},children:(0,b.jsx)("div",{className:"serach-area",id:"modalProductList",onTouchStart:a=>{x.current=a.changedTouches[0].screenX},onTouchEnd:a=>{y.current=a.changedTouches[0].screenX,(()=>{let a=x.current-y.current;if(Math.abs(a)>50&&A.length>0){let b=A.findIndex(a=>a.sambaId===q?.sambaId);if(-1!==b)if(a>0){let a=(b+1)%A.length;C(A[a])}else{let a=(b-1+A.length)%A.length;C(A[a])}}})()},children:A.map(a=>{let c=a.products||[],d=a.sambaId===q?.sambaId;return(0,b.jsx)("div",{"data-category-container":`cat_${a.sambaId}`,style:{display:d?"block":"none"},children:0===c.length?(0,b.jsx)("div",{style:{padding:"50px",textAlign:"center",color:"white"},children:p("noProductsInCategory")}):(0,b.jsx)("div",{className:"product-list-container",children:(0,b.jsx)("div",{className:"products-no-tabs-wrapper",children:c.map(a=>{let c,d,e=D(a.picture,E),f=v(a,o),g=w(a,o);return(0,b.jsxs)("div",{className:"product-card product-item",style:{cursor:"pointer",position:"relative"},"data-product-id":a.id,"data-samba-product-id":a.sambaId,onClick:()=>k(a),children:[l&&z(a.id)>0&&(0,b.jsx)("span",{className:"cart-badge",style:{position:"absolute",top:"8px",right:"8px",background:"#dc3545",color:"white",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:700,zIndex:10,boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:z(a.id)}),l&&((c=n[a.id]||n[a.sambaId])&&c.earnTokens&&!(c.earnTokens<=0)?(0,b.jsx)("div",{style:{position:"absolute",top:"10px",left:"10px",zIndex:10,pointerEvents:"none"},children:(0,b.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"6px 12px",background:"linear-gradient(135deg, #ffc107 0%, #ff9800 100%)",color:"white",borderRadius:"20px",fontSize:"12px",fontWeight:700,boxShadow:"0 4px 12px rgba(255, 193, 7, 0.4), 0 2px 4px rgba(0, 0, 0, 0.2)",border:"2px solid rgba(255, 255, 255, 0.3)"},children:["+",c.earnTokens," jeton"]})}):null),(0,b.jsxs)("div",{className:"product-content",children:[(0,b.jsxs)("div",{className:"product-image",style:{position:"relative"},children:[(0,b.jsx)(B,{productAllergens:a.allergens,className:"allergen-on-image"}),e?(0,b.jsx)("img",{src:e,alt:f,loading:"eager",decoding:"async"}):(0,b.jsx)("div",{className:"no-image-placeholder",children:"üçΩÔ∏è"}),(0,b.jsx)("div",{className:"product-header",children:(0,b.jsx)("h3",{className:"product-name product-title","data-title-tr":a.title,"data-title-en":a.titleEn||a.title,style:K,children:f})})]}),(0,b.jsxs)("div",{className:"product-info",children:[a.price>0&&(0,b.jsx)("div",{className:"price-container moved",children:(0,b.jsxs)("div",{className:"product-price price",children:[(0,b.jsxs)("span",{className:"kdv-label",children:[(0,b.jsx)("span",{children:"KDV"}),(0,b.jsx)("span",{children:"Dahil"})]}),(0,b.jsxs)("span",{className:"price-value",style:{fontFamily:H},children:[a.price.toFixed(2)," ‚Ç∫",l&&((d=n[a.id]||n[a.sambaId])&&d.redeemTokens&&!(d.redeemTokens<=0)?(0,b.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"4px",marginLeft:"8px",padding:"4px 10px",background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",color:"white",borderRadius:"12px",fontSize:"11px",fontWeight:600,boxShadow:"0 2px 6px rgba(40, 167, 69, 0.3)",border:"1px solid rgba(255, 255, 255, 0.2)"},children:[d.redeemTokens," jeton ile"]}):null)]})]})}),g&&(0,b.jsx)("p",{className:"product-detail","data-detail-tr":a.detail,"data-detail-en":a.detailEn||a.DetailEn||a.detail,style:L,children:g}),l&&(0,b.jsxs)("button",{type:"button",className:"add-to-cart-btn",onClick:b=>((a,b)=>{if(b.stopPropagation(),!l||!m)return;let c=localStorage.getItem(`cart_${m}`),d=c?JSON.parse(c):[],e=d.findIndex(b=>b.productId===a.id);if(e>=0)d[e].quantity+=1;else{let b=D(a.picture,E),c=v(a,o);d.push({id:Date.now(),productId:a.id,sambaId:a.sambaId,name:c,price:a.price,quantity:1,image:b})}localStorage.setItem(`cart_${m}`,JSON.stringify(d)),t(d),window.dispatchEvent(new Event("cartUpdated"));let f=b.currentTarget,g=f.innerHTML,h=f.style.background;f.innerHTML='<i class="fas fa-check"></i> Eklendi!',f.style.background="linear-gradient(135deg, #28a745, #20c997)",setTimeout(()=>{f.innerHTML=g,f.style.background=h},1500)})(a,b),style:{width:"100%",padding:"10px",marginTop:"8px",background:"linear-gradient(135deg, #f39c12 0%, #e67e22 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"13px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[(0,b.jsx)("i",{className:"fas fa-shopping-cart"}),p("addToCart")]})]})]})]},a.id)})})})},`category-container-${a.sambaId}`)})})})]})})]})}var D=a.i(49468);function E(){let a,d,f,h,i,{menuData:j,customerData:k,selectedProduct:l,isProductDetailModalOpen:m,closeProductDetailModal:n,isTableMode:o,cartKey:p,productTokenSettings:q}=(0,e.useMenu)(),{language:r,t:s}=(0,g.useLanguage)(),[t,u]=(0,c.useState)(1),x=k?.customer.productFont||"Inter, sans-serif",y=k?.customer.productTitleColor||"#FFFFFF",z=k?.customer.productDescriptionColor||"rgba(255, 255, 255, 0.88)";if((0,c.useEffect)(()=>{m&&u(1)},[m]),(0,c.useEffect)(()=>{let a=a=>{"Escape"===a.key&&m&&n()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[m,n]),!m||!l)return null;let A=(a=>{if(!a){let a=j?.customerLogo;if(a){if(a.startsWith("http"))return a.replace("http://","https://");let b=a.startsWith("Uploads/")?a.substring(8):a;return`https://api.canlimenu.com/Uploads/${b}`}return'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="800" height="600"%3E%3Crect fill="%23667eea" width="800" height="600"/%3E%3C/svg%3E'}if(a.startsWith("http"))return a.replace("http://","https://");let b=a.startsWith("Uploads/")?a.substring(8):a;return`https://api.canlimenu.com/Uploads/${b}`})(l.Picture),C=v(l,r),E=w(l,r),F=w(l,r);return(0,b.jsxs)("div",{className:"single-product-modal",style:{display:m?"flex":"none"},children:[(0,b.jsx)("div",{className:"modal-overlay",onClick:n}),(0,b.jsxs)("div",{className:"modal-content",children:[(0,b.jsx)("button",{className:"modal-close",onClick:n,"aria-label":s("close"),children:(0,b.jsx)("i",{className:"fa-solid fa-xmark"})}),(0,b.jsxs)("div",{className:"modal-image-container",style:{position:"relative"},children:[(0,b.jsx)(B,{productAllergens:l.Allergens??l.allergens,className:"allergen-on-image"}),(0,b.jsx)("img",{src:A,alt:C,className:"modal-product-image",loading:"eager"})]}),(0,b.jsxs)("div",{className:"modal-info-container",children:[(0,b.jsx)("h1",{className:"modal-product-title",style:{fontFamily:x,color:y},children:C}),E&&(0,b.jsx)("p",{className:"modal-product-description",style:{fontFamily:x,color:z},children:E}),F&&(0,b.jsx)("div",{className:"modal-product-detail",children:(0,b.jsx)("p",{style:{fontFamily:x,color:z},children:F})}),o&&(a=l.Id??l.id,d=l.SambaId??l.sambaId,h=(f=a&&q[a]||d&&q[d])&&f.earnTokens>0,i=f&&f.redeemTokens>0,h||i?(0,b.jsxs)("div",{style:{marginBottom:"18px"},children:[h&&(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",borderRadius:"10px",background:"linear-gradient(135deg, rgba(255, 193, 7, 0.2), rgba(255, 152, 0, 0.15))",border:"1px solid rgba(255, 193, 7, 0.3)",backdropFilter:"blur(10px)",marginBottom:i?"8px":"0"},children:[(0,b.jsx)("span",{style:{fontSize:"20px"},children:"ü™ô"}),(0,b.jsx)("span",{style:{color:"white",fontSize:"0.95rem",fontWeight:500},children:s("earnTokensMessage").replace("{count}",String(f.earnTokens))})]}),i&&(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",borderRadius:"10px",background:"linear-gradient(135deg, rgba(40, 167, 69, 0.2), rgba(32, 201, 151, 0.15))",border:"1px solid rgba(40, 167, 69, 0.3)",backdropFilter:"blur(10px)"},children:[(0,b.jsx)("span",{style:{fontSize:"20px"},children:"ü™ô"}),(0,b.jsx)("span",{style:{color:"white",fontSize:"0.95rem",fontWeight:500},children:s("redeemTokensMessage").replace("{count}",String(f.redeemTokens))})]})]}):null),(0,b.jsx)("div",{className:"modal-product-price",children:(l.Price??l.price??0)>0?`${(l.Price??l.price??0).toFixed(2)} TL`:s("noPriceInfo")}),o&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"15px",margin:"20px 0"},children:[(0,b.jsx)("button",{onClick:()=>u(Math.max(1,t-1)),style:{width:"40px",height:"40px",border:"2px solid #ddd",background:"white",borderRadius:"8px",cursor:"pointer",fontSize:"18px",fontWeight:600,color:"#666"},children:"-"}),(0,b.jsx)("span",{style:{fontSize:"20px",fontWeight:600,minWidth:"40px",textAlign:"center",color:"white"},children:t}),(0,b.jsx)("button",{onClick:()=>u(t+1),style:{width:"40px",height:"40px",border:"2px solid #28a745",background:"#28a745",color:"white",borderRadius:"8px",cursor:"pointer",fontSize:"18px",fontWeight:600},children:"+"})]}),(0,b.jsxs)("button",{className:"modal-add-to-cart-btn",onClick:()=>{if(!l||!o||!p||!j)return;let a=j.customerTitle||"unknown",b=(0,D.loadCart)(p,a),c=l.Id??l.id,d=b.findIndex(a=>a.productId===c);if(d>=0)b[d].quantity+=t;else{let a=v(l,r);b.push({id:Date.now(),productId:c,sambaId:l.SambaId??l.sambaId,name:a,price:l.Price??l.price??0,quantity:t,image:l.Picture??l.picture})}(0,D.saveCart)(p,b,a),window.dispatchEvent(new Event("cartUpdated"));let e=v(l,r);alert(`${e} ${s("addedToCart")}`),n()},children:[(0,b.jsx)("i",{className:"fa-solid fa-cart-plus"}),(0,b.jsx)("span",{children:s("addToCart")})]})]})]})]})]})}var F=a.i(82417),G=a.i(807);let H={tr:F.default,en:G.default};function I(a,b,c){var d;let e=(d=H[a],b.split(".").reduce((a,b)=>a?.[b],d)||b);return c?Object.entries(c).reduce((a,[b,c])=>a.replace(RegExp(`{{${b}}}`,"g"),String(c)),e):e}async function J(a){try{let b=await fetch("/api/game/submit",{method:"POST",headers:{"Content-Type":"application/json","Accept-Language":"tr"},body:JSON.stringify(a)}),c=await b.json();if(b.ok&&c.success)return{success:!0,message:c.message||I("tr","api.success.scoreSubmitted")};return console.error("‚ùå Skor kaydedilemedi:",c),{success:!1,message:c.message||I("tr","game.errors.scoreNotSubmitted")}}catch(a){return console.error("‚ùå Skor submit hatasƒ±:",a),{success:!1,message:I("tr","game.messages.connectionError")}}}async function K(a,b=10){try{let c=await fetch(`/api/game/leaderboard/${a}/${b}`,{headers:{"Accept-Language":"tr"}});if(c.ok)return await c.json();return console.error("‚ùå",I("tr","game.errors.leaderboardNotLoaded")),[]}catch(a){return console.error("‚ùå Leaderboard fetch hatasƒ±:",a),[]}}class L{size;cells;constructor(a){this.size=a,this.cells=[];for(let b=0;b<a;b++){this.cells[b]=[];for(let c=0;c<a;c++)this.cells[b][c]=null}}randomAvailableCell(){let a=this.availableCells();return a.length?a[Math.floor(Math.random()*a.length)]:null}availableCells(){let a=[];for(let b=0;b<this.size;b++)for(let c=0;c<this.size;c++)this.cells[b][c]||a.push({x:b,y:c});return a}cellsAvailable(){return this.availableCells().length>0}cellContent(a){return this.withinBounds(a)?this.cells[a.x][a.y]:null}insertTile(a){this.cells[a.x][a.y]=a}removeTile(a){this.cells[a.x][a.y]=null}withinBounds(a){return a.x>=0&&a.x<this.size&&a.y>=0&&a.y<this.size}serialize(){let a=[];for(let b=0;b<this.size;b++)for(let c=0;c<this.size;c++){let d=this.cells[b][c];d&&a.push({position:{x:b,y:c},value:d.value})}return a}}function M({onGameOver:a,onGameWon:d,playerNickname:e,customerCode:f}){let[g,h]=(0,c.useState)(new L(4)),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(0),[m,n]=(0,c.useState)(0),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!0),[E,F]=(0,c.useState)(0),[G,H]=(0,c.useState)(1024),I=(0,c.useRef)(0);(0,c.useEffect)(()=>{let a=localStorage.getItem("bestScore_2048");a&&n(parseInt(a));let b=localStorage.getItem("leaderboardVisibility_2048");if(null!==b&&D("true"===b),M(),O(),console.log("üéÆ Game2048 mounted - initialNickname:",e),""===e&&(console.log("üóëÔ∏è Logout tespit edildi - localStorage temizleniyor"),localStorage.removeItem("playerNickname_2048")),void 0!==e&&e.trim())console.log("‚úÖ Giri≈ü yapmƒ±≈ü kullanƒ±cƒ±:",e),x(e),localStorage.setItem("playerNickname_2048",e);else{let a=localStorage.getItem("playerNickname_2048");a&&a.trim()?(console.log("üì¶ LocalStorage nickname:",a),x(a)):(console.log("‚ö†Ô∏è Nickname yok - Modal g√∂steriliyor"),v(!0))}},[e]),(0,c.useEffect)(()=>{let a=()=>{H(window.innerWidth)};return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]);let M=async()=>{z(await K("2048",10))};(0,c.useEffect)(()=>{k>m&&(n(k),localStorage.setItem("bestScore_2048",k.toString()))},[k,m]),(0,c.useEffect)(()=>{!(i.length>0)||o||q||N()},[i,k,o,q]);let N=()=>{let a={grid:g.serialize(),score:k,timestamp:Date.now()};localStorage.setItem("gameState_2048",JSON.stringify(a))},O=()=>{let a=localStorage.getItem("gameState_2048");if(a)try{let b=JSON.parse(a);if(Date.now()-b.timestamp<36e5){let a=new L(4);b.grid.forEach(b=>{let c={id:I.current++,value:b.value,x:b.position.x,y:b.position.y};a.insertTile(c)}),h(a),l(b.score);return}}catch(a){console.error("Failed to restore game state",a)}P()},P=(0,c.useCallback)(()=>{let a=new L(4);h(a),j([]),l(0),p(!1),r(!1),t(!1),B(!1),F(0),I.current=0,localStorage.removeItem("gameState_2048"),setTimeout(()=>{Q(a)},100)},[]),Q=a=>{R(a),setTimeout(()=>R(a),100)},R=a=>{let b=a.randomAvailableCell();if(b){let c=.9>Math.random()?2:4,d={id:I.current++,value:c,x:b.x,y:b.y,isNew:!0};a.insertTile(d),j(b=>[...b.filter(b=>a.cellContent({x:b.x,y:b.y})),d])}},S=a=>({0:{x:0,y:-1},1:{x:1,y:0},2:{x:0,y:1},3:{x:-1,y:0}})[a],T=a=>{if(o||q)return;let b=S(a),c=(a=>{let b={x:[],y:[]};for(let a=0;a<g.size;a++)b.x.push(a),b.y.push(a);return 1===a.x&&(b.x=b.x.reverse()),1===a.y&&(b.y=b.y.reverse()),b})(b),d=!1,e=0;if(g.cells.forEach(a=>{a.forEach(a=>{a&&(a.mergedFrom=null,a.previousPosition={x:a.x,y:a.y})})}),c.x.forEach(a=>{c.y.forEach(c=>{let f=g.cellContent({x:a,y:c});if(f){let h=((a,b,c)=>{let d,e={x:a.x,y:a.y};do e={x:(d=e).x+b.x,y:d.y+b.y};while(c.withinBounds(e)&&!c.cellContent(e))return{farthest:d,next:e}})({x:a,y:c},b,g),i=g.cellContent(h.next);if(i&&i.value===f.value&&!i.mergedFrom){let a={id:I.current++,value:2*f.value,x:h.next.x,y:h.next.y,mergedFrom:[f,i],isMerged:!0};if(g.removeTile(f),g.removeTile(i),g.insertTile(a),f.x=h.next.x,f.y=h.next.y,e+=a.value,2048===a.value&&!q){let a=k+e;setTimeout(()=>{r(!0),t(!0),X(a,!0)},200)}d=!0}else(h.farthest.x!==a||h.farthest.y!==c)&&(g.removeTile(f),f.x=h.farthest.x,f.y=h.farthest.y,g.insertTile(f),d=!0)}})}),d){R(g);let a=[];for(let b=0;b<4;b++)for(let c=0;c<4;c++){let d=g.cells[b][c];d&&a.push(d)}j([...a]);let b=k+e;e>0&&(l(b),F(e),setTimeout(()=>F(0),600)),setTimeout(()=>{g.cells.forEach(a=>{a.forEach(a=>{a&&(a.isNew=!1,a.isMerged=!1)})})},400),U(g)||setTimeout(()=>{p(!0),t(!0),X(b,!1)},200)}},U=a=>a.cellsAvailable()||V(a),V=a=>{for(let b=0;b<a.size;b++)for(let c=0;c<a.size;c++){let d=a.cellContent({x:b,y:c});if(d)for(let e=0;e<4;e++){let f=S(e),g={x:b+f.x,y:c+f.y},h=a.cellContent(g);if(h&&h.value===d.value)return!0}}return!1};(0,c.useEffect)(()=>{let a=a=>{let b={ArrowUp:0,w:0,W:0,ArrowRight:1,d:1,D:1,ArrowDown:2,s:2,S:2,ArrowLeft:3,a:3,A:3};void 0!==b[a.key]&&(a.preventDefault(),T(b[a.key]))};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[g,o,q,k]);let W=(0,c.useRef)({x:0,y:0}),X=async(b,c)=>{c?d?.(b):a?.(b),!w&&b>0?v(!0):w&&b>0&&!A&&await Y(b)},Y=async a=>{!a||A||(await J({GameType:"2048",PlayerNickname:w,Score:a,DeviceType:/mobile/i.test(navigator.userAgent)?"Mobile":"Desktop",VenueCode:f||"demo"})).success&&(B(!0),await M())},Z=async()=>{w.trim()?w.trim().length<2?alert("Takma ad en az 2 karakter olmalƒ±dƒ±r!"):(localStorage.setItem("playerNickname_2048",w.trim()),v(!1),P(),await Y(k)):alert("L√ºtfen bir takma ad girin!")};return(0,b.jsxs)("div",{className:"game-2048-container",children:[(0,b.jsxs)("div",{className:"game-2048-header",children:[(0,b.jsx)("h1",{className:"game-2048-title",children:"2048"}),(0,b.jsxs)("div",{className:"game-2048-scores",children:[(0,b.jsxs)("div",{className:"game-2048-score-box",children:[(0,b.jsx)("div",{className:"game-2048-score-label",children:"Skor"}),(0,b.jsx)("div",{className:"game-2048-score-value",children:k.toLocaleString("tr-TR")}),E>0&&(0,b.jsxs)("div",{className:"game-2048-score-increment",children:["+",E.toLocaleString("tr-TR")]})]}),(0,b.jsxs)("div",{className:"game-2048-score-box",style:{background:"linear-gradient(135deg, rgba(255, 193, 7, 0.9), rgba(255, 152, 0, 0.9))"},children:[(0,b.jsx)("div",{className:"game-2048-score-label",children:"En ƒ∞yi"}),(0,b.jsx)("div",{className:"game-2048-score-value",children:m.toLocaleString("tr-TR")})]})]})]}),(0,b.jsx)("div",{className:"game-2048-controls",children:(0,b.jsxs)("p",{className:"game-2048-instructions",children:["Karolarƒ± birle≈ütirerek ",(0,b.jsx)("strong",{style:{color:"#667eea"},children:"2048"})," sayƒ±sƒ±na ula≈ü!"]})}),(0,b.jsxs)("div",{className:"game-2048-board",onTouchStart:a=>{W.current={x:a.touches[0].clientX,y:a.touches[0].clientY}},onTouchEnd:a=>{let b={x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY},c=b.x-W.current.x,d=b.y-W.current.y;30>Math.abs(c)&&30>Math.abs(d)||(Math.abs(c)>Math.abs(d)?T(c>0?1:3):T(2*(d>0)))},children:[(0,b.jsx)("div",{className:"game-2048-grid-bg",children:Array.from({length:16}).map((a,c)=>(0,b.jsx)("div",{className:"game-2048-grid-cell"},c))}),(0,b.jsx)("div",{className:"game-2048-tiles",children:i.map(a=>(0,b.jsx)("div",{className:"game-2048-tile",style:((a,b)=>{let c=10;G<=360?c=6:G<=480?c=8:G<=768&&(c=10);if(G<=360){let d=(G-20-20-3*c)/4+c;return{transform:`translate(${a*d}px, ${b*d}px)`}}if(G<=480){let d=(G-30-24-3*c)/4+c;return{transform:`translate(${a*d}px, ${b*d}px)`}}if(G<=768){let d=(Math.min(G-40,450)-30-3*c)/4+c;return{transform:`translate(${a*d}px, ${b*d}px)`}}let d=(450-3*c)/4+c;return{transform:`translate(${a*d}px, ${b*d}px)`}})(a.x,a.y),children:(0,b.jsx)("div",{className:`game-2048-tile-inner tile-${a.value} ${a.isNew?"tile-new":""} ${a.isMerged?"tile-merged":""}`,children:a.value})},a.id))}),s&&(0,b.jsxs)("div",{className:"game-2048-message",children:[(0,b.jsx)("h2",{className:`game-2048-message-title ${q?"won":"lost"}`,children:q?"Kazandƒ±n! üéâ":"Oyun Bitti!"}),(0,b.jsxs)("p",{className:"game-2048-message-score",children:["Skorun: ",(0,b.jsx)("strong",{style:{color:"#ffd700",fontSize:"32px"},children:k.toLocaleString("tr-TR")})]}),(0,b.jsx)("button",{onClick:P,className:"game-2048-message-btn",children:"Tekrar Oyna"})]})]}),y.length>0&&(0,b.jsx)("div",{className:"game-leaderboard-toggle",children:(0,b.jsx)("button",{onClick:()=>{let a=!C;D(a),localStorage.setItem("leaderboardVisibility_2048",a.toString())},className:"game-leaderboard-toggle-btn",children:C?"üèÜ Sƒ±ralamayƒ± Gizle":"üèÜ Sƒ±ralamayƒ± G√∂ster"})}),C&&y.length>0&&(0,b.jsxs)("div",{className:"game-leaderboard",children:[(0,b.jsx)("h3",{className:"game-leaderboard-title",children:"üèÜ En ƒ∞yi Skorlar"}),(0,b.jsx)("div",{className:"game-leaderboard-list",children:y.slice(0,5).map(a=>(0,b.jsxs)("div",{className:"game-leaderboard-item",children:[(0,b.jsxs)("div",{className:"game-leaderboard-info",children:[(0,b.jsx)("div",{className:`game-leaderboard-rank rank-${a.rank<=3?a.rank:"other"}`,children:1===a.rank?"ü•á":2===a.rank?"ü•à":3===a.rank?"ü•â":a.rank}),(0,b.jsx)("span",{className:"game-leaderboard-name",children:a.playerNickname})]}),(0,b.jsx)("span",{className:"game-leaderboard-score",children:a.score.toLocaleString()})]},a.rank))})]}),u&&(0,b.jsx)("div",{className:"game-nickname-modal",children:(0,b.jsxs)("div",{className:"game-nickname-modal-content",children:[(0,b.jsx)("h2",{className:"game-nickname-modal-title",children:"üéÆ Skorunu Kaydet"}),(0,b.jsx)("p",{className:"game-nickname-modal-desc",children:"Sƒ±ralama tablosuna girmek i√ßin bir takma ad girin:"}),(0,b.jsx)("input",{type:"text",value:w,onChange:a=>x(a.target.value),placeholder:"Takma adƒ±n",maxLength:20,className:"game-nickname-input",onKeyDown:a=>"Enter"===a.key&&Z()}),(0,b.jsx)("div",{className:"game-nickname-buttons",children:(0,b.jsx)("button",{onClick:Z,className:"game-nickname-btn primary",children:"Kaydet"})})]})})]})}function N({onClose:a,playerNickname:d,customerCode:e}){let[f,g]=(0,c.useState)(null),[h,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)("setup"),[p,q]=(0,c.useState)(d||""),[r,s]=(0,c.useState)("normal"),[t,u]=(0,c.useState)(5),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(1),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)("Bekliyor..."),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)({}),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(""),[X,Y]=(0,c.useState)([]),Z=(0,c.useRef)(null);(0,c.useEffect)(()=>((async()=>{let a=new j.HubConnectionBuilder().withUrl("https://game.canlimenu.com/gamehub",{transport:k.HttpTransportType.WebSockets,skipNegotiation:!0}).withAutomaticReconnect({nextRetryDelayInMilliseconds:()=>1e4*Math.random()}).configureLogging(l.LogLevel.Error).build();a.on("RoomCreated",_),a.on("GameJoined",aa),a.on("JoinedRoom",ab),a.on("PlayerJoined",ac),a.on("PlayerLeft",ad),a.on("GameStarted",ae),a.on("RoundStarted",af),a.on("PlayerMadeChoice",ag),a.on("RoundResult",ah),a.on("GameFinished",ai),a.on("Error",aj);try{await a.start(),console.log("SignalR Connected"),m(!0),g(a),Z.current=a;let b=$();A(b)}catch(a){console.error("SignalR Connection Error:",a)}})(),()=>{Z.current&&Z.current.stop()}),[]);let $=()=>"player_"+Math.random().toString(36).substr(2,9),_=a=>{console.log("Room created:",a),a.success?(y(a.roomId),o("waiting"),I(!0),K("Diƒüer oyuncularƒ±n katƒ±lmasƒ± bekleniyor...")):alert(a.message||"Oyun olu≈üturulamadƒ±")},aa=a=>{console.log("Game joined:",a),a.success&&(y(a.roomId),o("waiting"),I(!1))},ab=a=>{console.log("Joined room:",a),a.players&&C(a.players)},ac=a=>{console.log("Player joined:",a),a.players&&C(a.players)},ad=a=>{console.log("Player left:",a),a.players&&C(a.players)},ae=a=>{console.log("Game started:",a),o("playing"),E(1)},af=a=>{console.log("Round started:",a),o("playing"),G(null),M(!1),S({})},ag=a=>{console.log("Player made choice:",a)},ah=a=>{console.log("Round result:",a);let{result:b,players:c}=a;M(!0);let d="draw",e=b.resultText;b.isDraw?e="ü§ù Berabere!":b.winnerId===z?(d="win",e="üéâ Kazandƒ±nƒ±z!"):(d="lose",e="üò¢ Kaybettiniz!"),O(e),Q(d),b.choices&&S(b.choices),c&&C(c),o("result")},ai=a=>{console.log("Game finished:",a);let{winner:b,finalScores:c}=a;o("finished"),Y(c||B),b?b.id===z?W("üéä Tebrikler! Oyunu Kazandƒ±nƒ±z! üéä"):W(`üèÜ ${b.name} Oyunu Kazandƒ±!`):W("ü§ù Oyun Berabere Bitti!"),U(!0)},aj=a=>{console.error("Game error:",a),alert(a.message||"Bir hata olu≈ütu")},ak=async a=>{if(a.preventDefault(),!p.trim())return void alert("L√ºtfen bir takma ad girin");if(!f||f.state!==i.HubConnectionState.Connected)return void alert("Baƒülantƒ± kurulamadƒ±. L√ºtfen sayfayƒ± yenileyin.");let b=Math.floor(1e3+9e3*Math.random()).toString(),c=e||"demo";try{"tournament"===r?await f.invoke("CreateTournament",b,c,z,p,4,v):await f.invoke("CreateRoom",b,c,z,p,{maxRounds:t,maxPlayers:"tournament"===r?4:2,isTournament:"tournament"===r},v)}catch(a){console.error("Create game error:",a),alert("Oyun olu≈üturulamadƒ±")}},al=async()=>{if(f&&H)try{await f.invoke("StartGame",x)}catch(a){console.error("Start game error:",a)}},am=async a=>{if(!F&&f){G(a);try{await f.invoke("MakeChoice",x,z,a)}catch(a){console.error("Make choice error:",a)}}},an=async()=>{if(f)try{await f.invoke("LeaveRoom",x,z),o("setup"),y(""),C([])}catch(a){console.error("Leave game error:",a)}},ao=B.find(a=>a.id===z),ap=B.find(a=>a.id!==z);return"setup"===n?(0,b.jsxs)("div",{className:"rps-setup-modal",children:[(0,b.jsx)("h2",{children:"Ta≈ü Kaƒüƒ±t Makas"}),(0,b.jsxs)("form",{onSubmit:ak,children:[(0,b.jsxs)("div",{className:"rps-form-group",children:[(0,b.jsx)("label",{htmlFor:"nickname",children:"Takma Ad"}),(0,b.jsx)("input",{type:"text",id:"nickname",value:p,onChange:a=>q(a.target.value),placeholder:"Takma adƒ±nƒ±zƒ± girin",maxLength:20,required:!0})]}),(0,b.jsxs)("div",{className:"rps-lobby-switch-container",children:[(0,b.jsxs)("div",{className:"rps-lobby-switch-label",children:[(0,b.jsx)("div",{className:"rps-lobby-switch-title",children:"üèõÔ∏è Lobby'de G√∂ster"}),(0,b.jsx)("div",{className:"rps-lobby-switch-desc",children:"Diƒüer oyuncular oyununuza katƒ±labilir"})]}),(0,b.jsxs)("label",{className:"rps-toggle-switch",children:[(0,b.jsx)("input",{type:"checkbox",checked:v,onChange:a=>w(a.target.checked)}),(0,b.jsx)("span",{className:"rps-toggle-slider"})]})]}),(0,b.jsxs)("div",{className:"rps-mode-container",children:[(0,b.jsx)("div",{className:"rps-mode-title",children:"Oyun Modu"}),(0,b.jsxs)("div",{className:"rps-mode-buttons",children:[(0,b.jsx)("button",{type:"button",className:`rps-mode-btn ${"normal"===r?"active":""}`,onClick:()=>s("normal"),children:"Normal Oyun (2 Ki≈üi)"}),(0,b.jsx)("button",{type:"button",className:`rps-mode-btn ${"tournament"===r?"active":""}`,onClick:()=>s("tournament"),children:"Turnuva (4 Ki≈üi)"})]})]}),"normal"===r&&(0,b.jsxs)("div",{className:"rps-rounds-container",children:[(0,b.jsx)("div",{className:"rps-rounds-title",children:"Ka√ß El Oynanacak?"}),(0,b.jsx)("div",{className:"rps-round-buttons",children:[3,5,7,10].map(a=>(0,b.jsxs)("button",{type:"button",className:`rps-round-btn ${t===a?"active":""}`,onClick:()=>u(a),children:[a," El"]},a))})]}),"tournament"===r&&(0,b.jsxs)("div",{className:"rps-mode-container",children:[(0,b.jsx)("div",{className:"rps-mode-title",children:"Turnuva (4 Ki≈üi)"}),(0,b.jsxs)("div",{style:{background:"rgba(52, 152, 219, 0.1)",padding:"15px",borderRadius:"8px",borderLeft:"4px solid #3498db"},children:[(0,b.jsx)("p",{style:{margin:"5px 0",fontSize:"14px",color:"#bdc3c7"},children:"‚Ä¢ Her ma√ß 5 el (best of 5)"}),(0,b.jsx)("p",{style:{margin:"5px 0",fontSize:"14px",color:"#bdc3c7"},children:"‚Ä¢ E≈üle≈ümeler sƒ±rayla oynanƒ±r"}),(0,b.jsx)("p",{style:{margin:"5px 0",fontSize:"14px",color:"#bdc3c7"},children:"‚Ä¢ Diƒüer oyuncular izleyebilir"}),(0,b.jsx)("p",{style:{margin:"5px 0",fontSize:"14px",color:"#bdc3c7"},children:"‚Ä¢ Final sƒ±ralamasƒ± g√∂sterilir"})]})]}),(0,b.jsx)("button",{type:"submit",className:"rps-create-game-btn",disabled:!h,children:h?"Oyun Olu≈ütur":"Baƒülanƒ±yor..."})]})]}):(0,b.jsxs)("div",{className:"rps-game-container",children:[x&&(0,b.jsxs)("div",{className:"rps-room-info",children:[(0,b.jsx)("div",{className:"rps-room-code",children:x}),(0,b.jsx)("div",{children:"Oyun Kodu ile arkada≈ülarƒ±nƒ±zƒ± davet edin!"})]}),(0,b.jsxs)("div",{className:"rps-players-section",children:[(0,b.jsxs)("div",{className:`rps-player-card ${"playing"===n&&ao?"active":""}`,children:[(0,b.jsx)("div",{className:"rps-player-name",children:ao?.name||"Bekliyor..."}),(0,b.jsx)("div",{className:"rps-player-score",children:ao?.score||0})]}),(0,b.jsx)("div",{className:"rps-vs-text",children:"VS"}),(0,b.jsxs)("div",{className:`rps-player-card ${"playing"===n&&ap?"active":""}`,children:[(0,b.jsx)("div",{className:"rps-player-name",children:ap?.name||"Bekliyor..."}),(0,b.jsx)("div",{className:"rps-player-score",children:ap?.score||0})]})]}),"waiting"===n&&(0,b.jsxs)("div",{className:"rps-waiting-section",style:{display:"block"},children:[(0,b.jsx)("div",{className:"rps-waiting-text",children:J}),(0,b.jsx)("div",{className:"rps-spinner"})]}),"playing"===n&&!L&&(0,b.jsxs)("div",{className:"rps-choice-section",children:[(0,b.jsxs)("div",{className:"rps-round-info",children:["Raund ",D," / ",t]}),(0,b.jsxs)("div",{className:"rps-choices-container",children:[(0,b.jsxs)("button",{className:`rps-choice-btn ${"rock"===F?"selected":""} ${F?"disabled":""}`,onClick:()=>am("rock"),disabled:!!F,children:[(0,b.jsx)("div",{className:"rps-choice-icon",children:"‚úä"}),(0,b.jsx)("div",{className:"rps-choice-text",children:"Ta≈ü"})]}),(0,b.jsxs)("button",{className:`rps-choice-btn ${"paper"===F?"selected":""} ${F?"disabled":""}`,onClick:()=>am("paper"),disabled:!!F,children:[(0,b.jsx)("div",{className:"rps-choice-icon",children:"‚úã"}),(0,b.jsx)("div",{className:"rps-choice-text",children:"Kaƒüƒ±t"})]}),(0,b.jsxs)("button",{className:`rps-choice-btn ${"scissors"===F?"selected":""} ${F?"disabled":""}`,onClick:()=>am("scissors"),disabled:!!F,children:[(0,b.jsx)("div",{className:"rps-choice-icon",children:"‚úåÔ∏è"}),(0,b.jsx)("div",{className:"rps-choice-text",children:"Makas"})]})]})]}),L&&(0,b.jsxs)("div",{className:"rps-result-section",style:{display:"block"},children:[(0,b.jsx)("div",{className:`rps-result-text ${P}`,children:N}),(0,b.jsx)("div",{className:"rps-player-choices",children:B.map(a=>(0,b.jsxs)("div",{className:"rps-player-choice",children:[(0,b.jsx)("div",{className:"rps-player-choice-name",children:a.name}),(0,b.jsx)("div",{className:"rps-player-choice-icon",children:R[a.id]?(a=>{switch(a){case"rock":return"‚úä";case"paper":return"‚úã";case"scissors":return"‚úåÔ∏è"}})(R[a.id]):"?"})]},a.id))})]}),(0,b.jsxs)("div",{className:"rps-game-controls",children:["waiting"===n&&H&&B.length>=2&&(0,b.jsx)("button",{className:"rps-control-btn start",onClick:al,children:"Oyunu Ba≈ülat"}),(0,b.jsx)("button",{className:"rps-control-btn leave",onClick:an,children:"Odadan Ayrƒ±l"}),a&&(0,b.jsx)("button",{className:"rps-control-btn back",onClick:a,children:"Geri"})]}),T&&(0,b.jsx)("div",{className:"rps-game-over-modal",children:(0,b.jsxs)("div",{className:"rps-game-over-content",children:[(0,b.jsx)("div",{className:"rps-game-over-title",children:"üéÆ Oyun Bitti!"}),(0,b.jsx)("div",{className:"rps-game-over-message",children:V}),(0,b.jsxs)("div",{className:"rps-game-over-scores",children:[(0,b.jsx)("h3",{style:{marginBottom:"15px",color:"#776e65"},children:"Final Skorlarƒ±:"}),X.map((a,c)=>(0,b.jsxs)("div",{style:{padding:"10px",margin:"5px 0",background:a.id===z?"rgba(52, 152, 219, 0.2)":"transparent",borderRadius:"5px"},children:[c+1,". ",a.name,": ",a.score," puan"]},a.id))]}),(0,b.jsxs)("div",{className:"rps-game-over-controls",children:[(0,b.jsx)("button",{className:"rps-play-again-btn",onClick:()=>{U(!1),o("setup"),y(""),C([]),G(null),M(!1),E(1)},children:"üîÑ Tekrar Oyna"}),a&&(0,b.jsx)("button",{className:"rps-control-btn back",onClick:a,style:{padding:"15px 30px",fontSize:"16px"},children:"Ana Men√ºye D√∂n"})]})]})})]})}function O({onClose:a,currentUser:d,customerCode:e}){let[f,g]=(0,c.useState)(null),[h,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)("setup"),[p,q]=(0,c.useState)(10),[r,s]=(0,c.useState)(!0),t=d?.nickName||d?.nickname||d?.firstName||"Oyuncu",[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(0),[G,H]=(0,c.useState)(p),[I,J]=(0,c.useState)(null),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(20),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)(!1),[U,V]=(0,c.useState)(""),[W,X]=(0,c.useState)([]),Y=(0,c.useRef)(null);(0,c.useEffect)(()=>((async()=>{let a=new j.HubConnectionBuilder().withUrl("https://game.canlimenu.com/gamehub",{transport:k.HttpTransportType.WebSockets,skipNegotiation:!0}).withAutomaticReconnect().configureLogging(l.LogLevel.Error).build();a.on("QuizRoomCreated",$),a.on("QuizJoined",_),a.on("PlayerJoinedQuiz",aa),a.on("QuizStarted",ac),a.on("NextQuestion",ad),a.on("AnswerSubmitted",ae),a.on("QuestionResults",af),a.on("QuizFinished",ag),a.on("PlayerLeft",ab),a.on("Error",ah);try{await a.start(),console.log("SignalR Connected"),m(!0),g(a),Y.current=a;let b=Z();x(b)}catch(a){console.error("SignalR Connection Error:",a)}})(),()=>{Q&&clearInterval(Q),Y.current&&Y.current.stop()}),[]),(0,c.useEffect)(()=>{if("playing"===n&&!M&&O>0){let a=setInterval(()=>{P(b=>b<=1?(clearInterval(a),null===I&&f&&ak(-1),0):b-1)},1e3);return R(a),()=>clearInterval(a)}},[n,M,O]);let Z=()=>"player_"+Math.random().toString(36).substr(2,9),$=a=>{console.log("Quiz room created:",a),a.success?(v(a.roomId),o("waiting"),B(!0)):alert(a.message||"Quiz olu≈üturulamadƒ±")},_=a=>{console.log("Quiz joined:",a),a.success&&(v(a.roomId),o("waiting"),B(!1))},aa=a=>{console.log("Player joined:",a),a.players&&z(a.players)},ab=a=>{console.log("Player left:",a),a.players&&z(a.players)},ac=a=>{console.log("Quiz started:",a),o("playing"),H(a.totalQuestions||p)},ad=a=>{console.log("Next question:",a);let{question:b,questionNumber:c}=a;D({id:b.id,text:b.text,answers:b.answers}),F(c),J(null),L(null),N(!1),P(20),z(a=>a.map(a=>({...a,answered:!1})))},ae=a=>{console.log("Answer submitted:",a),z(b=>b.map(b=>b.id===a.playerId?{...b,answered:!0}:b))},af=a=>{console.log("Question results:",a);let{correctAnswer:b,players:c}=a;L(b),N(!0),z(c),Q&&clearInterval(Q)},ag=a=>{console.log("Quiz finished:",a);let{winner:b,finalScores:c}=a;o("finished"),X(c||y),b?b.id===w?V("üéä Tebrikler! Quizi Kazandƒ±nƒ±z! üéä"):V(`üèÜ ${b.name} Quizi Kazandƒ±!`):V("Quiz Tamamlandƒ±!"),T(!0)},ah=a=>{console.error("Quiz error:",a),alert(a.message||"Bir hata olu≈ütu")},ai=async a=>{if(a.preventDefault(),!f||f.state!==i.HubConnectionState.Connected)return void alert("Baƒülantƒ± kurulamadƒ±. L√ºtfen sayfayƒ± yenileyin.");let b=Math.floor(1e3+9e3*Math.random()).toString();try{await f.invoke("CreateQuizRoom",b,e||"demo",w,t,{questionCount:p,maxPlayers:8},r)}catch(a){console.error("Create quiz error:",a),alert("Quiz olu≈üturulamadƒ±")}},aj=async()=>{if(f&&A)try{await f.invoke("StartQuiz",u)}catch(a){console.error("Start quiz error:",a)}},ak=async a=>{if(null===I&&f){J(a);try{await f.invoke("SubmitAnswer",u,w,a)}catch(a){console.error("Submit answer error:",a)}}},al=async()=>{if(f)try{await f.invoke("LeaveRoom",u,w),o("setup"),v(""),z([])}catch(a){console.error("Leave quiz error:",a)}};return(y.find(a=>a.id===w),"setup"===n)?t&&(d?.nickName||d?.nickname)?(0,b.jsxs)("div",{className:"quiz-setup-modal",children:[(0,b.jsx)("h2",{children:"üìö Bilgi Yarƒ±≈ümasƒ±"}),(0,b.jsxs)("form",{onSubmit:ai,children:[(0,b.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",background:"rgba(102, 126, 234, 0.1)",borderRadius:"8px",textAlign:"center"},children:[(0,b.jsx)("div",{style:{fontSize:"14px",color:"#bdc3c7",marginBottom:"5px"},children:"Oyuncu"}),(0,b.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#667eea"},children:t})]}),(0,b.jsxs)("div",{className:"rps-lobby-switch-container",children:[(0,b.jsxs)("div",{className:"rps-lobby-switch-label",children:[(0,b.jsx)("div",{className:"rps-lobby-switch-title",children:"üèõÔ∏è Lobby'de G√∂ster"}),(0,b.jsx)("div",{className:"rps-lobby-switch-desc",children:"Diƒüer oyuncular quiz'inize katƒ±labilir"})]}),(0,b.jsxs)("label",{className:"rps-toggle-switch",children:[(0,b.jsx)("input",{type:"checkbox",checked:r,onChange:a=>s(a.target.checked)}),(0,b.jsx)("span",{className:"rps-toggle-slider"})]})]}),(0,b.jsx)("div",{className:"quiz-options",children:(0,b.jsx)("div",{className:"quiz-option-row",children:(0,b.jsxs)("div",{className:"quiz-option-group",children:[(0,b.jsx)("label",{children:"Soru Sayƒ±sƒ±"}),(0,b.jsxs)("select",{value:p,onChange:a=>q(Number(a.target.value)),children:[(0,b.jsx)("option",{value:"5",children:"5 Soru"}),(0,b.jsx)("option",{value:"10",children:"10 Soru"}),(0,b.jsx)("option",{value:"15",children:"15 Soru"}),(0,b.jsx)("option",{value:"20",children:"20 Soru"})]})]})})}),(0,b.jsx)("button",{type:"submit",className:"quiz-create-game-btn",disabled:!h,children:h?"Quiz Olu≈ütur":"Baƒülanƒ±yor..."})]})]}):(0,b.jsxs)("div",{className:"quiz-setup-modal",children:[(0,b.jsx)("h2",{children:"üìö Bilgi Yarƒ±≈ümasƒ±"}),(0,b.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px",color:"#ecf0f1"},children:[(0,b.jsx)("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"üîí"}),(0,b.jsx)("p",{style:{fontSize:"18px",marginBottom:"10px"},children:"Quiz oynamak i√ßin giri≈ü yapmalƒ±sƒ±nƒ±z"}),(0,b.jsx)("p",{style:{fontSize:"14px",color:"#95a5a6"},children:"L√ºtfen √∂nce hesabƒ±nƒ±za giri≈ü yapƒ±n"}),a&&(0,b.jsx)("button",{onClick:a,style:{marginTop:"20px",padding:"12px 24px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",cursor:"pointer"},children:"Geri D√∂n"})]})]}):(0,b.jsxs)("div",{className:"quiz-game-container",children:[u&&(0,b.jsxs)("div",{className:"quiz-header",children:[(0,b.jsxs)("div",{className:"quiz-room-code",children:["Oda: ",u]}),(0,b.jsxs)("div",{className:"quiz-question-counter",children:["Soru ",E," / ",G]})]}),"waiting"===n&&(0,b.jsxs)("div",{className:"quiz-waiting-section",children:[(0,b.jsx)("div",{className:"quiz-waiting-text",children:A?"Diƒüer oyuncularƒ±n katƒ±lmasƒ± bekleniyor...":"Host tarafƒ±ndan quiz'in ba≈ülatƒ±lmasƒ± bekleniyor..."}),(0,b.jsx)("div",{className:"quiz-spinner"}),u&&(0,b.jsxs)("div",{style:{marginTop:"30px",padding:"20px",background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",textAlign:"center"},children:[(0,b.jsx)("div",{style:{marginBottom:"15px",fontSize:"16px",fontWeight:"bold",color:"#ecf0f1"},children:"QR Kodu taratarak quiz'e katƒ±lƒ±n"}),(0,b.jsx)("div",{style:{background:"white",padding:"15px",borderRadius:"8px",display:"inline-block",marginBottom:"15px"},children:(0,b.jsx)("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent("")}`,alt:"QR Kod",style:{display:"block",width:"200px",height:"200px"}})}),(0,b.jsxs)("div",{style:{marginTop:"15px"},children:[(0,b.jsx)("div",{style:{fontSize:"14px",color:"#bdc3c7",marginBottom:"8px"},children:"Quiz linkini payla≈ü:"}),(0,b.jsx)("div",{onClick:()=>{},style:{background:"#2c3e50",padding:"8px",borderRadius:"5px",fontSize:"12px",wordBreak:"break-all",color:"#3498db",cursor:"pointer"},children:""}),(0,b.jsx)("div",{style:{fontSize:"12px",color:"#95a5a6",marginTop:"5px"},children:"Linke tƒ±klayarak kopyalayƒ±n"})]})]}),y.length>0&&(0,b.jsxs)("div",{className:"quiz-players-section",style:{marginTop:"30px"},children:[(0,b.jsxs)("div",{className:"quiz-players-title",children:["Katƒ±lƒ±mcƒ±lar (",y.length,"/8)"]}),(0,b.jsx)("div",{className:"quiz-players-list",children:y.map(a=>(0,b.jsx)("div",{className:`quiz-player-card ${a.id===w?"me":""}`,children:(0,b.jsx)("div",{className:"quiz-player-name",children:a.name})},a.id))})]})]}),"playing"===n&&C&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"quiz-question-section",children:[(0,b.jsx)("div",{className:"quiz-question-header",children:(0,b.jsxs)("div",{className:O<=5?"quiz-timer warning":"quiz-timer",children:["‚è±Ô∏è ",O,"s"]})}),(0,b.jsx)("div",{className:"quiz-question-text",children:C.text}),(0,b.jsx)("div",{className:"quiz-answers-grid",children:C.answers.map((a,c)=>{let d="quiz-answer-btn";return M?(c===K?d+=" correct":c===I&&c!==K&&(d+=" incorrect"),d+=" disabled"):(c===I&&(d+=" selected"),null!==I&&(d+=" disabled")),(0,b.jsx)("button",{className:d,onClick:()=>ak(c),disabled:null!==I,children:a},c)})})]}),(0,b.jsxs)("div",{className:"quiz-players-section",children:[(0,b.jsxs)("div",{className:"quiz-players-title",children:["Katƒ±lƒ±mcƒ±lar (",y.filter(a=>a.answered).length,"/",y.length," cevapladƒ±)"]}),(0,b.jsx)("div",{className:"quiz-players-list",children:y.map(a=>(0,b.jsxs)("div",{className:`quiz-player-card ${a.id===w?"me":""} ${a.answered?"answered":""}`,children:[(0,b.jsxs)("div",{className:"quiz-player-name",children:[a.name," ",a.answered&&"‚úì"]}),(0,b.jsx)("div",{className:"quiz-player-score",children:a.score})]},a.id))})]})]}),"results"===n&&(0,b.jsxs)("div",{className:"quiz-scoreboard",children:[(0,b.jsx)("div",{className:"quiz-scoreboard-title",children:"üèÜ Skor Tablosu"}),(0,b.jsx)("ul",{className:"quiz-scoreboard-list",children:y.sort((a,b)=>b.score-a.score).map((a,c)=>(0,b.jsxs)("li",{className:`quiz-scoreboard-item rank-${c+1<=3?c+1:""}`,children:[(0,b.jsxs)("span",{className:"quiz-rank",children:[c+1,"."]}),(0,b.jsx)("span",{className:"quiz-player-info",children:a.name}),(0,b.jsx)("span",{className:"quiz-score",children:a.score})]},a.id))})]}),(0,b.jsxs)("div",{className:"quiz-controls",children:["waiting"===n&&A&&y.length>=2&&(0,b.jsx)("button",{className:"quiz-control-btn start",onClick:aj,children:"Quiz'i Ba≈ülat"}),(0,b.jsx)("button",{className:"quiz-control-btn leave",onClick:al,children:"Odadan Ayrƒ±l"}),a&&(0,b.jsx)("button",{className:"rps-control-btn back",onClick:a,children:"Geri"})]}),S&&(0,b.jsx)("div",{className:"quiz-game-over-modal",children:(0,b.jsxs)("div",{className:"quiz-game-over-content",children:[(0,b.jsx)("div",{className:"quiz-game-over-title",children:"üéì Quiz Tamamlandƒ±!"}),(0,b.jsx)("div",{className:"quiz-game-over-message",children:U}),(0,b.jsxs)("div",{className:"quiz-scoreboard",style:{marginBottom:"20px"},children:[(0,b.jsx)("div",{className:"quiz-scoreboard-title",children:"Final Sƒ±ralamasƒ±"}),(0,b.jsx)("ul",{className:"quiz-scoreboard-list",children:W.sort((a,b)=>b.score-a.score).map((a,c)=>(0,b.jsxs)("li",{className:`quiz-scoreboard-item rank-${c+1<=3?c+1:""}`,style:{background:a.id===w?"rgba(102, 126, 234, 0.3)":void 0},children:[(0,b.jsx)("span",{className:"quiz-rank",children:0===c?"ü•á":1===c?"ü•à":2===c?"ü•â":`${c+1}.`}),(0,b.jsx)("span",{className:"quiz-player-info",children:a.name}),(0,b.jsx)("span",{className:"quiz-score",children:a.score})]},a.id))})]}),(0,b.jsxs)("div",{className:"quiz-game-over-controls",children:[(0,b.jsx)("button",{className:"quiz-play-again-btn",onClick:()=>{T(!1),o("setup"),v(""),z([]),D(null),F(0),J(null),L(null)},children:"üîÑ Tekrar Oyna"}),a&&(0,b.jsx)("button",{className:"rps-control-btn back",onClick:a,style:{padding:"15px 30px",fontSize:"16px"},children:"Ana Men√ºye D√∂n"})]})]})})]})}function P(){let{isGameModalOpen:a,selectedGame:d,activeGame:f,setActiveGame:g,closeGameModal:i,customerCode:j}=(0,e.useMenu)(),{currentUser:k}=(0,h.useAuth)(),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(!1);(0,c.useEffect)(()=>(a?(g(d),o(!1),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[a,d]),(0,c.useEffect)(()=>{let b=b=>{"Escape"===b.key&&a&&p()};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[a]);let p=()=>{o(!0),setTimeout(()=>{i(),o(!1)},300)},q=a=>{g(a)},r=()=>{g(null)};return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("div",{className:`game-modal-container ${a?"show":""} ${n?"closing":""}`,children:[(0,b.jsx)("button",{className:"game-modal-close-btn",onClick:p,children:"√ó"}),!f&&(0,b.jsxs)("div",{className:"games-container",children:[(0,b.jsxs)("div",{className:"games-header",children:[(0,b.jsx)("h2",{children:"üéÆ Oyunlar"}),(0,b.jsx)("p",{children:"Bu mekandaki oyuncularla e≈üle≈ü!"}),(0,b.jsx)("small",{children:"Sadece bu mekan m√º≈üterilerine √∂zel!"})]}),(0,b.jsxs)("div",{className:"games-grid",children:[(0,b.jsxs)("button",{className:"game-card-btn",onClick:()=>q("2048"),children:[(0,b.jsx)("i",{className:"game-icon",children:"üî¢"}),(0,b.jsx)("h3",{children:"2048"}),(0,b.jsx)("p",{className:"player-count",children:"(Tek ki≈üilik)"})]}),(0,b.jsxs)("button",{className:"game-card-btn",onClick:()=>q("rps"),children:[(0,b.jsx)("i",{className:"game-icon",children:"‚úä"}),(0,b.jsx)("h3",{children:"Ta≈ü Kaƒüƒ±t Makas"}),(0,b.jsx)("p",{className:"player-count",children:"(2-4 ki≈üilik)"})]}),(0,b.jsxs)("button",{className:"game-card-btn",onClick:()=>{q("quiz")},style:{position:"relative"},children:[(0,b.jsx)("i",{className:"game-icon",children:"üìö"}),(0,b.jsx)("h3",{children:"Bilgi Yarƒ±≈ümasƒ±"}),(0,b.jsx)("p",{className:"player-count",children:"(2-8 ki≈üilik)"})]})]})]}),f&&(0,b.jsxs)("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column"},children:[(0,b.jsxs)("button",{onClick:r,style:{width:"100%",padding:"15px 20px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",fontSize:"16px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",transition:"all 0.3s ease",flexShrink:0},onMouseEnter:a=>{a.currentTarget.style.background="linear-gradient(135deg, #764ba2 0%, #667eea 100%)"},onMouseLeave:a=>{a.currentTarget.style.background="linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[(0,b.jsx)("span",{children:"‚Üê"}),(0,b.jsx)("span",{children:"Oyun Se√ßimine D√∂n"})]}),"2048"===f&&(0,b.jsx)("div",{style:{width:"100%",flex:1,overflow:"auto",padding:"10px 20px"},children:(0,b.jsx)(M,{onGameOver:()=>{},onGameWon:()=>{},playerNickname:l,customerCode:j||void 0})}),"rps"===f&&(0,b.jsx)("div",{style:{width:"100%",flex:1,overflow:"auto",padding:"10px 20px"},children:(0,b.jsx)(N,{onClose:r,playerNickname:l,customerCode:j||void 0})}),"quiz"===f&&(0,b.jsx)("div",{style:{width:"100%",flex:1,overflow:"auto",padding:"10px 20px"},children:(0,b.jsx)(O,{onClose:r,currentUser:k,customerCode:j||void 0})})]})]})})}function Q({isOpen:a,onClose:d,tableId:f,customerCode:g}){let h,i,{customerData:j,productTokenSettings:k,cartKey:l,isSelfService:m,sessionId:n}=(0,e.useMenu)(),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(0),w=l||f||"",x=(0,c.useCallback)(()=>{w&&g&&p((0,D.loadCart)(w,g))},[w,g]);(0,c.useEffect)(()=>{w&&a&&x()},[w,a,x]),(0,c.useEffect)(()=>{let a=()=>{x()};return window.addEventListener("cartUpdated",a),()=>window.removeEventListener("cartUpdated",a)},[x]),(0,c.useEffect)(()=>{let a=a=>{let{balance:b,message:c}=a.detail;v(b),c&&y(c,"success")};return window.addEventListener("tokenBalanceUpdated",a),()=>window.removeEventListener("tokenBalanceUpdated",a)},[]);let y=(a,b="info")=>{let c=document.createElement("div");c.textContent=a,c.style.cssText=`
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      background: ${"success"===b?"#28a745":"error"===b?"#dc3545":"#007bff"};
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 100001;
      font-size: 14px;
      font-weight: 600;
      max-width: 90%;
      text-align: center;
    `,document.body.appendChild(c),setTimeout(()=>{c.parentNode&&c.parentNode.removeChild(c)},3e3)};(0,c.useEffect)(()=>{let b=async()=>{let a=localStorage.getItem("userData");if(a&&g)try{let b=JSON.parse(a),c=b.id||b.userId||b.Id;if(!c)return;let d=await fetch(`/api/user/token-balance?userId=${c}&customerCode=${g}`),e=await d.json();if(e.balance){let a=e.balance.currentTokens||e.balance.CurrentTokens||0;v(a)}}catch(a){console.error("Failed to load token balance:",a)}};a&&b()},[a,g]);let z=a=>{w&&g&&((0,D.saveCart)(w,a,g),p(a),window.dispatchEvent(new Event("cartUpdated")))},A=(a,b)=>{b<=0?B(a):z(o.map(c=>c.productId===a?{...c,quantity:b}:c))},B=a=>{let b=o.find(b=>b.productId===a),c=b?.name||"Bu √ºr√ºn√º";confirm(`${c} sepetten kaldƒ±rƒ±lsƒ±n mƒ±?`)&&z(o.filter(b=>b.productId!==a))},C=async()=>{if(0!==o.length){if(!g||!f&&!n)return void alert(m?"Oturum bilgisi bulunamadƒ±.":"Masa bilgisi bulunamadƒ±.");if(await new Promise(a=>{let b=localStorage.getItem("userData"),c=b?JSON.parse(b):null,d=localStorage.getItem("currentTableName"),e=m?"Self-Servis":d||`Masa ${f}`,g=`
        <div id="orderConfirmationModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 100000;">
          <div style="background: white; border-radius: 15px; padding: 25px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
            <div style="text-align: center; margin-bottom: 20px;">
              <h3 style="color: #2c5530; margin: 0; font-size: 22px;">
                <i class="fas fa-receipt" style="margin-right: 8px;"></i>
                Sipari≈ü \xd6zeti
              </h3>
            </div>

            <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <span><strong>üë§ M\xfc≈üteri:</strong></span>
                <span>${c?c.firstName+(c.nickName?` (${c.nickName})`:""):"Misafir"}</span>
              </div>
              <div style="display: flex; justify-content: space-between;">
                <span><strong>üçΩÔ∏è Masa:</strong></span>
                <span>${e}</span>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h4 style="color: #2c5530; margin-bottom: 15px; border-bottom: 2px solid #e9ecef; padding-bottom: 8px;">
                <i class="fas fa-shopping-cart" style="margin-right: 8px;"></i>
                Sipari≈ü Detaylarƒ±
              </h4>
              <div id="orderItemsList">
                ${o.map(a=>{let b=a.tokenQuantity||0,c=k?.[a.sambaId||a.productId],d="",e=`${a.quantity} x ${a.price.toFixed(2)} ‚Ç∫`,f=`${(a.price*a.quantity).toFixed(2)} ‚Ç∫`;if(b>0&&c?.redeemTokens){let e=b*c.redeemTokens,g=a.quantity-b;d=`<div style="font-size: 11px; color: #28a745; font-weight: 600;">ü™ô ${b} adet jeton ile (${e} jeton)</div>`,f=`<span style="text-decoration: line-through; color: #999;">${(a.price*a.quantity).toFixed(2)} ‚Ç∫</span> <span style="color: #28a745; font-weight: 700;">${(a.price*g).toFixed(2)} ‚Ç∫</span>`}return`
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #eee; background: #fff;">
                      <div style="flex: 1;">
                        <div style="font-weight: 600; color: #333; margin-bottom: 4px;">${a.name}</div>
                        ${d}
                        ${a.note?`<div style="font-size: 12px; color: #666; font-style: italic;">üí¨ ${a.note}</div>`:""}
                      </div>
                      <div style="text-align: right; margin-left: 15px;">
                        <div style="font-weight: 600; color: #2c5530;">${e}</div>
                        <div style="font-size: 12px; color: #666;">${f}</div>
                      </div>
                    </div>
                  `}).join("")}
              </div>
            </div>

            ${s?`
              <div style="margin-bottom: 20px;">
                <h4 style="color: #2c5530; margin-bottom: 10px;">
                  <i class="fas fa-comment" style="margin-right: 8px;"></i>
                  \xd6zel ƒ∞steƒüiniz
                </h4>
                <div style="background: #fff3cd; border: 2px solid #dc3545; border-radius: 8px; padding: 15px; font-style: italic; color: #856404;">
                  "${s}"
                </div>
              </div>
            `:""}

            ${F>0?`
              <div style="background: linear-gradient(135deg, rgba(40, 167, 69, 0.15), rgba(32, 201, 151, 0.1)); border: 1px solid rgba(40, 167, 69, 0.3); border-radius: 8px; padding: 10px 12px; margin-bottom: 15px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                  <span style="color: #28a745; font-weight: 600; font-size: 14px;">ü™ô Jeton Kullanƒ±mƒ±</span>
                  <span style="color: #28a745; font-weight: 700; font-size: 14px;">${F} jeton</span>
                </div>
              </div>
            `:""}

            <div style="background: linear-gradient(135deg, #2c5530, #3a6b3f); border-radius: 10px; padding: 15px; margin-bottom: 25px; color: white; text-align: center;">
              <div style="font-size: 18px; font-weight: bold;">
                <i class="fas fa-calculator" style="margin-right: 8px;"></i>
                TOPLAM: ${E.toFixed(2)} ‚Ç∫
              </div>
            </div>

            <div style="display: flex; gap: 15px; justify-content: center;">
              <button id="confirmOrderBtn" style="flex: 1; max-width: 180px; background: linear-gradient(135deg, #28a745, #20c997); color: white; border: none; padding: 15px 20px; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer;">
                <i class="fas fa-check" style="margin-right: 8px;"></i>
                Onayla
              </button>
              <button id="cancelOrderBtn" style="flex: 1; max-width: 180px; background: linear-gradient(135deg, #dc3545, #c82333); color: white; border: none; padding: 15px 20px; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer;">
                <i class="fas fa-times" style="margin-right: 8px;"></i>
                ƒ∞ptal
              </button>
            </div>
          </div>
        </div>
      `;document.body.insertAdjacentHTML("beforeend",g),document.getElementById("confirmOrderBtn").addEventListener("click",()=>{document.getElementById("orderConfirmationModal").remove(),a(!0)}),document.getElementById("cancelOrderBtn").addEventListener("click",()=>{document.getElementById("orderConfirmationModal").remove(),a(!1)}),document.getElementById("orderConfirmationModal").addEventListener("click",b=>{"orderConfirmationModal"===b.target.id&&(document.getElementById("orderConfirmationModal").remove(),a(!1))})})){r(!0);try{let a=localStorage.getItem("userData"),b=a?JSON.parse(a).id:null,c={customerCode:g,tableName:m?n:f,endUserId:b,Source:"UI",isSelfService:m,items:o.map(a=>{let b=k?.[a.sambaId||a.productId],c=a.tokenQuantity||0;return{productId:a.sambaId||a.productId,actualProductId:a.productId,productName:a.name,quantity:a.quantity,price:a.price,orderTag:a.note||"",tokenQuantity:c,tokensPerItem:b?.redeemTokens||0}}),notificationMessage:s?`üìù M\xfc≈üteri Notu: ${s}`:"",customerNote:s},e=await fetch("/api/order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),h=await e.json();if(e.ok&&h.success){if(h.warning&&h.warningMessage&&!confirm(`‚ö†Ô∏è UYARI

${h.warningMessage}

Sipari≈üleriniz birle≈ütirilebilir.

Devam etmek istiyor musunuz?`))return void r(!1);alert(`Sipari≈üiniz ba≈üarƒ±yla alƒ±ndƒ±! Sipari≈ü No: #${h.orderNumber||"N/A"}`),w&&((0,D.clearCart)(w),p([]),t("")),d()}else h.userBlocked?alert("Hesabƒ±nƒ±z askƒ±ya alƒ±nmƒ±≈ütƒ±r. L√ºtfen destek ile ileti≈üime ge√ßin."):h.restaurantBlocked?alert(h.error||"Bu restorandan sipari≈ü verme yetkiniz kaldƒ±rƒ±lmƒ±≈ütƒ±r."):h.dailyLimitReached?alert("Bu restorandan bug√ºn 7 sipari≈ü verdiniz. G√ºnl√ºk limit doldu."):h.differentTableError?alert(h.error||"Farklƒ± masadan sipari≈ü verme hatasƒ±."):alert(h.error||"Sipari≈ü g√∂nderilirken bir hata olu≈ütu.")}catch(a){console.error("Order submission error:",a),alert("Sipari≈ü g√∂nderilirken bir hata olu≈ütu.")}finally{r(!1)}}}},{totalPrice:E,totalTokensUsed:F}=(h=0,i=0,o.forEach(a=>{let b=a.tokenQuantity||0,c=a.quantity-b;if(h+=c*a.price,b>0){let c=k?.[a.sambaId||a.productId];c&&(i+=b*c.redeemTokens)}}),{totalPrice:h,totalTokensUsed:i}),G=o.reduce((a,b)=>a+b.quantity,0);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"cart-overlay",onClick:d,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",opacity:+!!a,visibility:a?"visible":"hidden",transition:"all 0.3s ease",zIndex:99998}}),(0,b.jsxs)("div",{className:`cart-sidebar ${a?"sidebar-open":""}`,style:{position:"fixed",top:0,right:a?0:"-100%",width:"100%",maxWidth:"400px",height:"100vh",background:"rgba(245, 245, 245, 0.95)",backdropFilter:"blur(10px)",boxShadow:"-4px 0 20px rgba(0, 0, 0, 0.2)",transition:"right 0.3s ease",zIndex:99999,display:"flex",flexDirection:"column",paddingBottom:"80px"},children:[(0,b.jsxs)("div",{className:"cart-header",style:{background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",color:"white",padding:"12px 15px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.1)",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",flexShrink:0},children:[(0,b.jsx)("i",{className:"fas fa-shopping-cart",style:{fontSize:"16px"}}),(0,b.jsx)("span",{style:{fontSize:"16px",fontWeight:600},children:"Sepetim"}),(0,b.jsx)("span",{style:{background:"rgba(255, 255, 255, 0.2)",padding:"2px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:600},children:G})]}),(0,b.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"12px",flex:1,justifyContent:"center"},children:u>0&&(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1px"},children:[(0,b.jsx)("span",{style:{fontSize:"9px",opacity:.9,fontWeight:500},children:"Jeton"}),(0,b.jsxs)("span",{style:{background:"rgba(255, 255, 255, 0.25)",padding:"4px 12px",borderRadius:"6px",fontWeight:700,fontSize:"16px"},children:["ü™ô ",u-F]})]})}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[(0,b.jsx)("span",{style:{fontSize:"10px",opacity:.95,fontWeight:600,letterSpacing:"0.5px"},children:"TOPLAM"}),(0,b.jsxs)("span",{style:{background:"rgba(255, 255, 255, 0.3)",padding:"6px 14px",borderRadius:"8px",fontWeight:800,fontSize:"20px",letterSpacing:"0.5px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[E.toFixed(2)," ‚Ç∫"]})]}),(0,b.jsx)("button",{onClick:d,style:{background:"rgba(255, 255, 255, 0.25)",border:"2px solid rgba(255, 255, 255, 0.4)",color:"white",width:"32px",height:"32px",borderRadius:"50%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold",flexShrink:0,marginLeft:"8px"},children:"√ó"})]}),(0,b.jsx)("div",{className:"cart-items",style:{flex:1,overflowY:"auto",padding:"15px"},children:0===o.length?(0,b.jsxs)("div",{className:"empty-cart",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",textAlign:"center",color:"#666"},children:[(0,b.jsx)("i",{className:"fas fa-shopping-cart",style:{fontSize:"60px",marginBottom:"20px",opacity:.3}}),(0,b.jsx)("h4",{style:{margin:"0 0 10px 0",fontSize:"18px",fontWeight:600},children:"Sepetiniz bo≈ü"}),(0,b.jsx)("p",{style:{margin:0,fontSize:"14px",opacity:.8},children:'√úr√ºn eklemek i√ßin men√ºdeki "Sepete Ekle" butonlarƒ±nƒ± kullanƒ±n'})]}):o.map(a=>{let c,d;return(0,b.jsx)("div",{className:"cart-item",style:{background:"white",borderRadius:"12px",padding:"12px",marginBottom:"10px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)"},children:(0,b.jsxs)("div",{style:{display:"flex",gap:"12px",alignItems:"flex-start"},children:[a.image&&(0,b.jsx)("div",{style:{flexShrink:0},children:(0,b.jsx)("img",{src:a.image,alt:a.name,style:{width:"60px",height:"60px",objectFit:"cover",borderRadius:"8px"}})}),(0,b.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px",gap:"8px"},children:[(0,b.jsx)("div",{style:{fontSize:"14px",fontWeight:600,color:"#333",flex:1,minWidth:0},children:a.name}),(0,b.jsxs)("div",{style:{display:"flex",gap:"4px",alignItems:"center",flexShrink:0},children:[(0,b.jsx)("button",{onClick:()=>A(a.productId,a.quantity-1),style:{width:"26px",height:"26px",border:"1px solid #ddd",background:"white",borderRadius:"4px",cursor:"pointer",fontSize:"16px",color:"#666",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center"},children:"‚àí"}),(0,b.jsx)("span",{style:{fontSize:"14px",fontWeight:700,color:"#333",minWidth:"20px",textAlign:"center"},children:a.quantity}),(0,b.jsx)("button",{onClick:()=>A(a.productId,a.quantity+1),style:{width:"26px",height:"26px",border:"1px solid #28a745",background:"#28a745",color:"white",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"})]})]}),(0,b.jsxs)("div",{style:{fontSize:"13px",marginBottom:"8px"},children:[(()=>{let c=a.tokenQuantity||0,d=k?.[a.sambaId||a.productId];if(c>0&&d){let e=a.quantity-c;return e>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{style:{color:"#28a745",fontWeight:"bold",fontSize:"12px"},children:["ü™ô ",c," adet jeton ile (",c*d.redeemTokens," jeton)"]}),(0,b.jsxs)("div",{style:{color:"#666",fontSize:"12px"},children:[e," adet nakit: ",(e*a.price).toFixed(2)," ‚Ç∫"]})]}):(0,b.jsxs)("div",{style:{color:"#28a745",fontWeight:"bold"},children:["ü™ô ",c," adet x ",d.redeemTokens," jeton"]})}return(0,b.jsxs)("div",{style:{color:"#666"},children:[a.price.toFixed(2)," ‚Ç∫ x ",a.quantity]})})(),(c=a.tokenQuantity||0,(d=k?.[a.sambaId||a.productId])&&d.earnTokens>0&&0===c?(0,b.jsxs)("div",{style:{fontSize:"11px",color:"#28a745",marginTop:"4px"},children:["+",d.earnTokens*a.quantity," jeton kazanacaksƒ±nƒ±z"]}):null)]}),(0,b.jsx)("input",{type:"text",placeholder:"√ñzel isteƒüiniz var mƒ±? (Opsiyonel)",value:a.note||"",onChange:b=>{var c,d;return c=a.productId,d=b.target.value,void z(o.map(a=>a.productId===c?{...a,note:d}:a))},maxLength:100,style:{width:"100%",padding:"6px 8px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"12px",marginBottom:"8px"}}),(()=>{let c=k?.[a.sambaId||a.productId];if(!c||c.redeemTokens<=0)return null;let d=a.tokenQuantity||0,e=Math.floor(u/c.redeemTokens),f=Math.min(a.quantity,e),g=u>=c.redeemTokens;return(0,b.jsxs)("button",{onClick:()=>(a=>{let b=o.find(b=>b.productId===a);if(!b)return;let c=k?.[b.sambaId||b.productId];if(!c||c.redeemTokens<=0)return;let d=b.tokenQuantity||0,e=Math.floor(u/c.redeemTokens),f=Math.min(b.quantity,e),g=0;g=0===d&&f>0?1:d<f?d+1:0,z(o.map(b=>b.productId===a?{...b,tokenQuantity:g}:b))})(a.productId),disabled:!g,style:{width:"100%",padding:"6px 10px",marginBottom:"8px",background:d>0?"linear-gradient(135deg, #28a745 0%, #20c997 100%)":g?"linear-gradient(135deg, #ffc107 0%, #ff9800 100%)":"#e9ecef",color:g?"white":"#adb5bd",border:"none",borderRadius:"6px",fontSize:"11px",fontWeight:600,cursor:g?"pointer":"not-allowed",transition:"all 0.2s"},children:["ü™ô ",0===d?`${c.redeemTokens} Jeton kullan${!g?" (Yetersiz)":""}`:d<f?`${d}/${f} adet (tƒ±kla: +1)`:`${d}/${f} adet (tƒ±kla: iptal)`]})})()]})]})},a.productId)})}),o.length>0&&(0,b.jsxs)("div",{className:"cart-footer",style:{borderTop:"1px solid #e2e8f0",padding:"12px 15px",background:"white",flexShrink:0},children:[(0,b.jsx)("div",{style:{marginBottom:"10px"},children:(0,b.jsx)("textarea",{placeholder:"Sipari≈ü notu (opsiyonel)...",value:s,onChange:a=>t(a.target.value),maxLength:200,style:{width:"100%",padding:"8px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"12px",resize:"none",height:"50px",fontFamily:"inherit"}})}),(0,b.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,b.jsxs)("button",{onClick:()=>{confirm("Sepeti temizlemek istediƒüinize emin misiniz?")&&w&&((0,D.clearCart)(w),p([]),t(""))},style:{flex:1,padding:"12px",background:"#dc3545",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[(0,b.jsx)("i",{className:"fas fa-trash-alt"}),(0,b.jsx)("span",{children:"Temizle"})]}),(0,b.jsxs)("button",{onClick:C,disabled:q,style:{flex:2,padding:"12px",background:q?"#ccc":"linear-gradient(135deg, #28a745 0%, #20c997 100%)",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:600,cursor:q?"not-allowed":"pointer",boxShadow:q?"none":"0 4px 12px rgba(40, 167, 69, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[(0,b.jsx)("i",{className:"fas fa-paper-plane"}),(0,b.jsx)("span",{children:q?"G√∂nderiliyor...":"Sipari≈ü Ver"})]})]})]})]})]})}function R({isOpen:a,onClose:d,customerCode:e}){let{currentUser:f,isAuthenticated:g,login:i,register:j,logout:k}=(0,h.useAuth)(),[l,m]=(0,c.useState)("orders"),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)({firstName:"",lastName:"",email:"",phoneNumber:"",password:"",nickName:""}),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)([]),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)(""),[N,O]=(0,c.useState)({email:"",phoneNumber:"",birthDate:"",gender:""}),[P,Q]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=a=>{let{balance:b,message:c}=a.detail;f&&"tokens"===l&&X(),c&&V(c,"success")};return window.addEventListener("tokenBalanceUpdated",a),()=>window.removeEventListener("tokenBalanceUpdated",a)},[f,l]);let R=async a=>{a.preventDefault(),s(!0);try{let a=await i(t,v);a.success?(setTimeout(()=>{alert(`Ho≈ügeldin ${f?.name||""}!`)},100),o(!1),u(""),w("")):alert(a.error||"Giri≈ü ba≈üarƒ±sƒ±z")}catch(a){console.error("Login error:",a),alert("Baƒülantƒ± hatasƒ±. L√ºtfen tekrar deneyin.")}finally{s(!1)}},S=async a=>{try{s(!0);let b=await fetch("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:a.credential,mode:"login",customerCode:e||""})}),c=await b.json();c.success&&c.token&&c.user?(localStorage.setItem("userToken",c.token),localStorage.setItem("userData",JSON.stringify(c.user)),localStorage.setItem("lastLoginTime",Date.now().toString()),window.location.reload()):alert(c.error||"Google ile giri≈ü ba≈üarƒ±sƒ±z")}catch(a){console.error("Google login error:",a),alert("Google ile baƒülantƒ± sƒ±rasƒ±nda hata olu≈ütu")}finally{s(!1)}},T=async()=>{try{s(!0),await new Promise((a,b)=>{let c=setInterval(()=>{},100);setTimeout(()=>{clearInterval(c),b(Error("Google SDK y√ºklenemedi"))},1e4)}),window.google.accounts.id.initialize({client_id:"272265935268-q6o120vjjoch144ppf3bfp1l2o8da7ka.apps.googleusercontent.com",callback:S,ux_mode:"popup",use_fedcm_for_prompt:!1}),window.google.accounts.id.prompt()}catch(a){console.error("Google SDK load error:",a),alert("Google ile giri≈ü ba≈ülatƒ±lamadƒ±. L√ºtfen tekrar deneyin."),s(!1)}},U=async a=>{if(a.preventDefault(),!x.email)return void alert("E-posta adresi zorunludur");if(!x.email.includes("@"))return void alert("Ge√ßerli bir e-posta adresi giriniz");if(!x.phoneNumber)return void alert("Telefon numarasƒ± zorunludur");if(11!==x.phoneNumber.length)return void alert("Telefon numarasƒ± 11 haneli olmalƒ±dƒ±r (05XXXXXXXXX)");if(!x.phoneNumber.startsWith("05"))return void alert("Telefon numarasƒ± 05 ile ba≈ülamalƒ±dƒ±r");if(!x.nickName||0===x.nickName.trim().length)return void alert("Kullanƒ±cƒ± adƒ± zorunludur");if(!x.firstName)return void alert("ƒ∞sim zorunludur");if(!x.lastName)return void alert("Soyisim zorunludur");if(!x.password||x.password.length<6)return void alert("≈ûifre en az 6 karakter olmalƒ±dƒ±r");try{s(!0);let a=await j({name:x.firstName,surname:x.lastName,email:x.email,password:x.password,phoneNumber:x.phoneNumber});a.success?(alert(`Ho≈ügeldin ${x.firstName}! Kayƒ±t ba≈üarƒ±yla tamamlandƒ±.`),q(!1),y({firstName:"",lastName:"",email:"",phoneNumber:"",password:"",nickName:""})):alert(a.error||"Kayƒ±t i≈ülemi ba≈üarƒ±sƒ±z")}catch(a){console.error("Register error:",a),alert("Baƒülantƒ± hatasƒ±. L√ºtfen tekrar deneyin.")}finally{s(!1)}},V=(a,b="info")=>{let c=document.createElement("div");c.textContent=a,c.style.cssText=`
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      background: ${"success"===b?"#28a745":"error"===b?"#dc3545":"#007bff"};
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 100001;
      font-size: 14px;
      font-weight: 600;
      max-width: 90%;
      text-align: center;
    `,document.body.appendChild(c),setTimeout(()=>{c.parentNode&&c.parentNode.removeChild(c)},3e3)};(0,c.useEffect)(()=>{f&&("orders"===l?W():"tokens"===l?X():"allergies"===l?Y():"settings"===l&&Z())},[l,f]);let W=async()=>{let a=f?.id||f?.userId||f?.Id;if(a){C(!0);try{let b=await fetch(`/api/user/orders/${a}`),c=await b.json();c.errors&&console.error("Validation errors:",c.errors),c.success&&c.orders?A(c.orders):A([])}catch(a){console.error("Failed to load orders:",a),A([])}finally{C(!1)}}},X=async()=>{let a=localStorage.getItem("userToken");if(a){G(!0);try{let b=await fetch("/api/user/tokens",{headers:{Authorization:`Bearer ${a}`}}),c=await b.json();c.success?E(c):E(null)}catch(a){console.error("Failed to load tokens:",a),E(null)}finally{G(!1)}}},Y=()=>{let a=localStorage.getItem("global_userAllergies");if(a)try{let b=JSON.parse(a),c=b.filter(a=>!a.startsWith("Diƒüer: ")),d=b.filter(a=>a.startsWith("Diƒüer: "));if(I(c),d.length>0){let a=d.map(a=>a.replace("Diƒüer: ","")).join(", ");M(a)}}catch(a){I([])}else I([])},Z=()=>{f&&O({email:f.email||"",phoneNumber:f.phoneNumber||"",birthDate:f.birthDate||"",gender:f.gender||""})},$=async()=>{let a=localStorage.getItem("userToken"),b=[...H];if(L&&L.trim()){let a=L.split(",").map(a=>`Diƒüer: ${a.trim()}`).filter(a=>"Diƒüer: "!==a);b.push(...a)}if(localStorage.setItem("global_userAllergies",JSON.stringify(b)),a)try{await fetch("/api/user/allergies",{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({allergies:b})}),alert("Alerjan bilgileriniz kaydedildi")}catch(a){alert("Alerjan bilgileriniz yerel olarak kaydedildi")}else alert("Alerjan bilgileriniz yerel olarak kaydedildi")},_=async()=>{if(N.phoneNumber&&N.phoneNumber.trim()){if(11!==N.phoneNumber.length)return void alert("Telefon numarasƒ± 11 haneli olmalƒ±dƒ±r (05XXXXXXXXX)");if(!N.phoneNumber.startsWith("05"))return void alert("Telefon numarasƒ± 05 ile ba≈ülamalƒ±dƒ±r")}if(N.email&&N.email.trim()&&!N.email.includes("@"))return void alert("Ge√ßerli bir e-posta adresi giriniz");Q(!0);let a=localStorage.getItem("userToken");try{let b=await fetch("/api/user/profile",{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({email:N.email||null,phoneNumber:N.phoneNumber||null,birthDate:N.birthDate||null,gender:N.gender||null})}),c=await b.json();if(c.success){let a=JSON.parse(localStorage.getItem("userData")||"{}"),b={...a,email:N.email||a.email,phoneNumber:N.phoneNumber||a.phoneNumber,birthDate:N.birthDate||a.birthDate,gender:N.gender||a.gender};localStorage.setItem("userData",JSON.stringify(b)),alert("Profil bilgileriniz ba≈üarƒ±yla g√ºncellendi"),window.location.reload()}else alert(c.error||"Profil g√ºncellenirken hata olu≈ütu")}catch(a){console.error("Profile update error:",a),alert("Baƒülantƒ± hatasƒ±. L√ºtfen tekrar deneyin.")}finally{Q(!1)}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"profile-overlay",onClick:d,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",opacity:+!!a,visibility:a?"visible":"hidden",transition:"all 0.3s ease",zIndex:99998}}),(0,b.jsxs)("div",{className:`profile-sidebar ${a?"sidebar-open":""}`,style:{position:"fixed",top:0,left:a?0:"-100%",width:"100%",maxWidth:"450px",height:"100vh",background:"#f8f9fa",transition:"left 0.3s ease",zIndex:99999,display:"flex",flexDirection:"column",boxShadow:"2px 0 20px rgba(0, 0, 0, 0.2)"},children:[(0,b.jsxs)("div",{className:"profile-header",style:{background:"linear-gradient(135deg, #343a40 0%, #212529 100%)",color:"white",padding:"15px 20px",position:"relative",textAlign:"center"},children:[(0,b.jsx)("button",{className:"modal-close",onClick:d,style:{position:"absolute",top:"10px",right:"15px",background:"rgba(255,255,255,0.2)",border:"none",color:"white",fontSize:"18px",cursor:"pointer",width:"28px",height:"28px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.3s ease"},children:(0,b.jsx)("i",{className:"fas fa-times"})}),(0,b.jsx)("div",{className:"user-avatar",style:{margin:"0 auto 10px auto",width:"50px",height:"50px",fontSize:"20px",background:f?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"rgba(255,255,255,0.2)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",border:"2px solid rgba(255,255,255,0.3)"},children:(0,b.jsx)("i",{className:"fas fa-user"})}),(0,b.jsx)("h3",{style:{margin:"0 0 3px 0",fontSize:"16px",fontWeight:600},children:f?`${f.firstName} ${f.lastName}`:"Misafir"}),(0,b.jsx)("p",{style:{margin:"0 0 5px 0",opacity:.9,fontSize:"12px"},children:f?f.email||f.phoneNumber||"":"Giri≈ü yaparak √∂zelliklerden faydalanƒ±n"})]}),(0,b.jsx)("div",{className:"profile-nav",style:{background:"#f8f9fa",padding:"15px",display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"6px"},children:[{id:"orders",icon:"fa-shopping-cart",label:"Sipari≈üler"},{id:"tokens",icon:"fa-coins",label:"Jetonlar"},{id:"allergies",icon:"fa-exclamation-triangle",label:"Alerjanlar"},{id:"settings",icon:"fa-cog",label:"Ayarlar"}].map(a=>(0,b.jsxs)("button",{onClick:()=>m(a.id),style:{background:"white",border:l===a.id?"2px solid #667eea":"2px solid #e9ecef",padding:"10px 4px",cursor:"pointer",fontSize:"9px",fontWeight:600,color:l===a.id?"#667eea":"#6c757d",borderRadius:"8px",textAlign:"center",transition:"all 0.3s ease",boxShadow:l===a.id?"0 2px 8px rgba(102, 126, 234, 0.15)":"0 2px 8px rgba(0,0,0,0.05)"},children:[(0,b.jsx)("div",{children:(0,b.jsx)("i",{className:`fas ${a.icon}`,style:{fontSize:"11px",display:"block",marginBottom:"3px",color:"tokens"===a.id?"#ffc107":"inherit"}})}),(0,b.jsx)("div",{children:a.label})]},a.id))}),(0,b.jsx)("div",{className:"profile-content",style:{padding:"15px",flex:1,overflowY:"auto"},children:f?(0,b.jsxs)("div",{children:["orders"===l&&(0,b.jsx)("div",{style:{padding:"15px"},children:B?(0,b.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#6c757d"},children:[(0,b.jsx)("i",{className:"fas fa-spinner fa-spin",style:{fontSize:"32px",marginBottom:"15px"}}),(0,b.jsx)("p",{children:"Sipari≈üleriniz y√ºkleniyor..."})]}):0===z.length?(0,b.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#6c757d"},children:[(0,b.jsx)("div",{style:{fontSize:"48px",marginBottom:"10px",opacity:.3},children:"üçΩÔ∏è"}),(0,b.jsx)("p",{style:{margin:0,fontSize:"14px",fontWeight:600},children:"Hen√ºz sipari≈üiniz bulunmuyor"}),(0,b.jsx)("p",{style:{margin:"5px 0 0 0",fontSize:"12px",opacity:.7},children:"Sipari≈ü vererek ba≈ülayƒ±n!"})]}):(0,b.jsx)("div",{children:z.map(a=>{let c="";if(a.venueLogo)if(a.venueLogo.startsWith("http://")||a.venueLogo.startsWith("https://"))c=a.venueLogo.replace("http://","https://");else{let b=a.venueLogo.replace(/^\/+/,"").replace("Uploads/","");c=`https://api.canlimenu.com/Uploads/${b}`}return(0,b.jsxs)("div",{style:{background:"white",padding:"15px",borderRadius:"12px",marginBottom:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",border:"1px solid #e9ecef"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"10px"},children:[(0,b.jsxs)("div",{style:{flex:1},children:[(0,b.jsx)("div",{style:{fontWeight:600,fontSize:"14px",marginBottom:"5px"},children:a.orderNumber||`#${a.id}`}),(0,b.jsxs)("div",{style:{fontSize:"12px",color:"#6c757d"},children:["üìÖ ",new Date(a.date).toLocaleDateString("tr-TR")," ",new Date(a.date).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})]})]}),(0,b.jsx)("div",{style:{background:"Processed"===a.status?"#d4edda":"#fff3cd",color:"Processed"===a.status?"#155724":"#856404",padding:"4px 10px",borderRadius:"12px",fontSize:"11px",fontWeight:600},children:"Processed"===a.status?"‚úì Tamamlandƒ±":a.status})]}),a.venueName&&(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px",paddingBottom:"8px",borderBottom:"1px solid #f0f0f0"},children:[c&&(0,b.jsx)("img",{src:c,alt:a.venueName,style:{width:"30px",height:"30px",borderRadius:"6px",objectFit:"cover",marginRight:"8px"},onError:a=>{a.target.style.display="none"}}),(0,b.jsxs)("div",{style:{fontSize:"13px",fontWeight:500},children:["üè™ ",a.venueName]})]}),(0,b.jsxs)("div",{style:{fontSize:"12px",color:"#6c757d",marginBottom:"8px"},children:["üçΩÔ∏è ",a.tableName||"Masa bilgisi yok"]}),a.items&&a.items.length>0&&(0,b.jsxs)("div",{style:{marginTop:"10px",paddingTop:"10px",borderTop:"1px solid #f0f0f0"},children:[(0,b.jsxs)("div",{style:{fontSize:"11px",color:"#6c757d",marginBottom:"5px"},children:["√úr√ºnler (",a.itemCount||a.items.length,"):"]}),a.items.slice(0,3).map((a,c)=>(0,b.jsxs)("div",{style:{fontSize:"12px",marginBottom:"3px",display:"flex",justifyContent:"space-between"},children:[(0,b.jsxs)("span",{children:[a.quantity||a.count,"x ",a.name||a.productName]}),(0,b.jsxs)("span",{style:{fontWeight:600},children:[a.price?.toFixed(2)," ‚Ç∫"]})]},c)),a.items.length>3&&(0,b.jsxs)("div",{style:{fontSize:"11px",color:"#6c757d",marginTop:"3px"},children:["+",a.items.length-3," √ºr√ºn daha..."]})]}),(0,b.jsxs)("div",{style:{marginTop:"10px",paddingTop:"10px",borderTop:"1px solid #f0f0f0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,b.jsx)("span",{style:{fontSize:"12px",color:"#6c757d"},children:"Toplam:"}),(0,b.jsxs)("span",{style:{fontSize:"16px",fontWeight:700,color:"#333"},children:[a.totalAmount?.toFixed(2)," ‚Ç∫"]})]})]},a.id)})})}),"tokens"===l&&(0,b.jsx)("div",{style:{padding:"15px"},children:F?(0,b.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#6c757d"},children:[(0,b.jsx)("i",{className:"fas fa-spinner fa-spin",style:{fontSize:"32px",marginBottom:"15px",color:"#ffc107"}}),(0,b.jsx)("p",{children:"Jetonlar y√ºkleniyor..."})]}):D&&D.restaurants&&0!==D.restaurants.length?(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{style:{background:"linear-gradient(135deg, #ffc107 0%, #ff9800 100%)",padding:"20px",borderRadius:"10px",marginBottom:"15px",textAlign:"center",color:"white"},children:[(0,b.jsx)("div",{style:{fontSize:"14px",marginBottom:"5px"},children:"Toplam Jeton"}),(0,b.jsxs)("div",{style:{fontSize:"32px",fontWeight:"bold"},children:["ü™ô ",D.summary?.totalTokens||0]})]}),D.restaurants.map((a,c)=>{let d="";if(a.restaurantLogo)if(a.restaurantLogo.startsWith("http://")||a.restaurantLogo.startsWith("https://"))d=a.restaurantLogo.replace("http://","https://");else{let b=a.restaurantLogo.replace(/^\/+/,"").replace("Uploads/","");d=`https://api.canlimenu.com/Uploads/${b}`}return(0,b.jsxs)("div",{style:{background:"white",padding:"15px",borderRadius:"12px",marginBottom:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",border:"1px solid #e9ecef"},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[d?(0,b.jsx)("img",{src:d,alt:a.restaurantName,style:{width:"40px",height:"40px",borderRadius:"8px",objectFit:"cover",marginRight:"10px"},onError:a=>{a.target.style.display="none"}}):null,(0,b.jsx)("div",{style:{fontWeight:600,fontSize:"14px",flex:1},children:a.restaurantName})]}),(0,b.jsxs)("div",{style:{background:"linear-gradient(135deg, #fff9e6 0%, #fff4cc 100%)",borderRadius:"8px",padding:"10px",border:"2px solid #ffc107",textAlign:"center"},children:[(0,b.jsxs)("div",{style:{fontSize:"20px",fontWeight:700,color:"#856404"},children:[(0,b.jsx)("i",{className:"fas fa-coins",style:{color:"#ffc107",fontSize:"16px",marginRight:"5px"}}),a.currentTokens]}),(0,b.jsx)("div",{style:{marginTop:"4px",fontSize:"10px",color:"#856404",fontWeight:500},children:"Jeton"})]})]},a.customerId||`restaurant-${c}`)})]}):(0,b.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#6c757d"},children:[(0,b.jsx)("i",{className:"fas fa-coins",style:{fontSize:"48px",marginBottom:"15px",opacity:.5,color:"#ffc107"}}),(0,b.jsx)("p",{children:"Hen√ºz jetonunuz bulunmuyor"})]})}),"allergies"===l&&(0,b.jsxs)("div",{style:{padding:"15px"},children:[(0,b.jsx)("h4",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#333"},children:"Alerji Bilgilerim"}),(0,b.jsxs)("div",{style:{background:"linear-gradient(135deg, rgba(220, 53, 69, 0.1), rgba(220, 53, 69, 0.15))",border:"1px solid rgba(220, 53, 69, 0.3)",borderRadius:"8px",padding:"12px",marginBottom:"15px",fontSize:"12px",color:"#721c24"},children:[(0,b.jsx)("div",{style:{fontWeight:600,marginBottom:"5px"},children:"‚ö†Ô∏è √ñnemli Uyarƒ±"}),(0,b.jsx)("div",{children:"Ciddi alerjiniz varsa l√ºtfen sipari≈ü verirken garsonunuza mutlaka bildirin. Bu sistem sadece hatƒ±rlatma ama√ßlƒ±dƒ±r."})]}),[{name:"Gluten",emoji:"üåæ"},{name:"Laktoz",emoji:"ü•õ"},{name:"Yumurta",emoji:"ü•ö"},{name:"Balƒ±k",emoji:"üêü"},{name:"Fƒ±ndƒ±k",emoji:"üå∞"},{name:"Yer Fƒ±stƒ±ƒüƒ±",emoji:"ü•ú"},{name:"Soya",emoji:"ü´ò"},{name:"S√ºt",emoji:"ü•õ"},{name:"Susam",emoji:"üå∞"},{name:"Hardal",emoji:"üå∂Ô∏è"},{name:"Kereviz",emoji:"ü•¨"}].map(a=>(0,b.jsxs)("label",{style:{display:"flex",alignItems:"center",padding:"10px 12px",background:H.includes(a.name)?"linear-gradient(135deg, rgba(220, 53, 69, 0.15), rgba(220, 53, 69, 0.2))":"white",border:H.includes(a.name)?"2px solid rgba(220, 53, 69, 0.4)":"1px solid #e9ecef",borderRadius:"8px",marginBottom:"8px",cursor:"pointer",transition:"all 0.2s ease"},children:[(0,b.jsx)("input",{type:"checkbox",checked:H.includes(a.name),onChange:b=>{b.target.checked?I([...H,a.name]):I(H.filter(b=>b!==a.name))},style:{marginRight:"10px",cursor:"pointer"}}),(0,b.jsx)("span",{style:{fontSize:"18px",marginRight:"8px"},children:a.emoji}),(0,b.jsx)("span",{style:{fontSize:"14px",fontWeight:500},children:a.name})]},a.name)),(0,b.jsxs)("div",{style:{marginTop:"15px"},children:[(0,b.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:600,marginBottom:"8px",color:"#333"},children:"üìù Diƒüer Alerjanlar ve √ñzel Durumlar"}),(0,b.jsx)("textarea",{value:L,onChange:a=>M(a.target.value),placeholder:"Diƒüer alerji veya √∂zel durumlarƒ±nƒ±zƒ± buraya yazƒ±n (virg√ºlle ayƒ±rƒ±n)",style:{width:"100%",minHeight:"80px",padding:"10px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"13px",fontFamily:"inherit",resize:"vertical"}}),(0,b.jsx)("div",{style:{fontSize:"11px",color:"#6c757d",marginTop:"5px"},children:"√ñrnek: Mantar, Ananas, Deniz √ºr√ºnleri"})]}),(0,b.jsxs)("button",{onClick:$,style:{width:"100%",padding:"12px",background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",color:"white",border:"none",borderRadius:"10px",fontSize:"14px",fontWeight:600,cursor:"pointer",marginTop:"15px"},children:[(0,b.jsx)("i",{className:"fas fa-save",style:{marginRight:"8px"}}),"Kaydet"]})]}),"settings"===l&&(0,b.jsxs)("div",{style:{padding:"15px"},children:[(0,b.jsx)("h4",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#333"},children:"‚öôÔ∏è Hesap Ayarlarƒ±"}),(0,b.jsxs)("div",{style:{background:"white",padding:"15px",borderRadius:"10px",marginBottom:"15px",border:"1px solid #e9ecef"},children:[(0,b.jsxs)("div",{style:{fontSize:"13px",marginBottom:"8px"},children:[(0,b.jsx)("strong",{children:"ƒ∞sim Soyisim:"})," ",f.firstName," ",f.lastName]}),f.email&&(0,b.jsxs)("div",{style:{fontSize:"13px",marginBottom:"8px"},children:[(0,b.jsx)("strong",{children:"Email:"})," ",f.email]}),f.phoneNumber&&(0,b.jsxs)("div",{style:{fontSize:"13px",marginBottom:"8px"},children:[(0,b.jsx)("strong",{children:"Telefon:"})," ",f.phoneNumber]}),f.birthDate&&(0,b.jsxs)("div",{style:{fontSize:"13px",marginBottom:"8px"},children:[(0,b.jsx)("strong",{children:"Doƒüum Tarihi:"})," ",new Date(f.birthDate).toLocaleDateString("tr-TR")]}),f.gender&&(0,b.jsxs)("div",{style:{fontSize:"13px"},children:[(0,b.jsx)("strong",{children:"Cinsiyet:"})," ","Male"===f.gender?"Erkek":"Female"===f.gender?"Kadƒ±n":"Diƒüer"]})]}),!f.email&&(0,b.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,b.jsx)("label",{style:{display:"block",fontSize:"13px",fontWeight:600,marginBottom:"6px",color:"#333"},children:"üìß Email Adresi Ekle"}),(0,b.jsx)("input",{type:"email",value:N.email,onChange:a=>O({...N,email:a.target.value}),placeholder:"ornek@email.com",style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"13px"}})]}),!f.phoneNumber&&(0,b.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,b.jsx)("label",{style:{display:"block",fontSize:"13px",fontWeight:600,marginBottom:"6px",color:"#333"},children:"üì± Telefon Numarasƒ± Ekle"}),(0,b.jsx)("input",{type:"tel",value:N.phoneNumber,onChange:a=>O({...N,phoneNumber:a.target.value}),placeholder:"05XXXXXXXXX",maxLength:11,style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"13px"}}),(0,b.jsx)("div",{style:{fontSize:"11px",color:"#6c757d",marginTop:"4px"},children:"11 hane, 05 ile ba≈ülamalƒ±"})]}),!f.birthDate&&(0,b.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,b.jsx)("label",{style:{display:"block",fontSize:"13px",fontWeight:600,marginBottom:"6px",color:"#333"},children:"üéÇ Doƒüum Tarihi"}),(0,b.jsx)("input",{type:"date",value:N.birthDate,onChange:a=>O({...N,birthDate:a.target.value}),style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"13px"}}),(0,b.jsx)("div",{style:{fontSize:"11px",color:"#dc3545",marginTop:"4px",fontWeight:500},children:"üéâ Doƒüru tarihi yazƒ±n, doƒüum g√ºn√ºn√ºz unutulmayacak! Bir daha deƒüi≈ütirilemez."})]}),!f.gender&&(0,b.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,b.jsx)("label",{style:{display:"block",fontSize:"13px",fontWeight:600,marginBottom:"6px",color:"#333"},children:"üë§ Cinsiyet"}),(0,b.jsxs)("select",{value:N.gender,onChange:a=>O({...N,gender:a.target.value}),style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"8px",fontSize:"13px",background:"white"},children:[(0,b.jsx)("option",{value:"",children:"Se√ßiniz"}),(0,b.jsx)("option",{value:"Male",children:"Erkek"}),(0,b.jsx)("option",{value:"Female",children:"Kadƒ±n"}),(0,b.jsx)("option",{value:"Other",children:"Diƒüer"})]}),(0,b.jsx)("div",{style:{fontSize:"11px",color:"#dc3545",marginTop:"4px",fontWeight:500},children:"‚ö†Ô∏è Bir defa se√ßebilirsiniz, sonra deƒüi≈ütirilemez."})]}),(!f.email||!f.phoneNumber||!f.birthDate||!f.gender)&&(0,b.jsxs)("button",{onClick:_,disabled:P,style:{width:"100%",padding:"12px",background:P?"#ccc":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"10px",fontSize:"14px",fontWeight:600,cursor:P?"not-allowed":"pointer",marginBottom:"15px"},children:[(0,b.jsx)("i",{className:"fas fa-save",style:{marginRight:"8px"}}),P?"G√ºncelleniyor...":"Profili G√ºncelle"]}),(0,b.jsxs)("button",{onClick:()=>{k(),alert("√áƒ±kƒ±≈ü yapƒ±ldƒ±")},style:{width:"100%",padding:"12px",background:"#dc3545",color:"white",border:"none",borderRadius:"10px",fontSize:"14px",fontWeight:600,cursor:"pointer",transition:"all 0.3s ease"},children:[(0,b.jsx)("i",{className:"fas fa-sign-out-alt",style:{marginRight:"8px"}}),"√áƒ±kƒ±≈ü Yap"]})]})]}):(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",textAlign:"center",color:"#6c757d"},children:[(0,b.jsx)("div",{style:{width:"80px",height:"80px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"20px",boxShadow:"0 4px 15px rgba(102, 126, 234, 0.3)"},children:(0,b.jsx)("i",{className:"fas fa-user-circle",style:{fontSize:"40px",color:"white"}})}),(0,b.jsx)("h4",{style:{margin:"0 0 10px 0",fontSize:"18px",fontWeight:600,color:"#333"},children:"Giri≈ü Yapƒ±n"}),(0,b.jsx)("p",{style:{margin:"0 0 20px 0",fontSize:"14px",opacity:.8},children:"Sipari≈ü ge√ßmi≈üiniz, jetonlarƒ±nƒ±z ve daha fazlasƒ± i√ßin giri≈ü yapƒ±n."}),(0,b.jsxs)("button",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",padding:"12px 32px",borderRadius:"25px",fontSize:"14px",fontWeight:600,cursor:"pointer",boxShadow:"0 4px 15px rgba(102, 126, 234, 0.3)",transition:"all 0.3s ease"},onClick:()=>o(!0),children:[(0,b.jsx)("i",{className:"fas fa-sign-in-alt",style:{marginRight:"8px"}}),"Giri≈ü Yap"]})]})})]}),n&&(0,b.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.6)",zIndex:1e5,backdropFilter:"blur(5px)",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>o(!1),children:(0,b.jsxs)("div",{style:{background:"white",borderRadius:"20px",padding:"30px",width:"90%",maxWidth:"450px",maxHeight:"90vh",overflowY:"auto",position:"relative"},onClick:a=>a.stopPropagation(),children:[(0,b.jsx)("button",{onClick:()=>o(!1),style:{position:"absolute",top:"15px",right:"15px",background:"none",border:"none",fontSize:"24px",color:"#999",cursor:"pointer",padding:"5px",borderRadius:"50%",transition:"all 0.3s ease"},children:(0,b.jsx)("i",{className:"fas fa-times"})}),(0,b.jsxs)("div",{style:{textAlign:"center",marginBottom:"25px"},children:[(0,b.jsx)("h2",{style:{margin:"0 0 8px 0",fontSize:"24px",fontWeight:600,color:"#333"},children:"üîê Giri≈ü Yap"}),(0,b.jsx)("p",{style:{margin:0,fontSize:"14px",color:"#666"},children:"Telefon numaranla hemen giri≈ü yap!"})]}),(0,b.jsxs)("button",{type:"button",onClick:T,disabled:r,style:{width:"100%",padding:"12px 20px",background:r?"#f5f5f5":"white",border:"1px solid #ddd",borderRadius:"10px",fontSize:"14px",fontWeight:600,cursor:r?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",transition:"all 0.3s ease",marginBottom:"20px",opacity:r?.6:1},children:[(0,b.jsx)("img",{src:"https://www.google.com/favicon.ico",alt:"Google",style:{width:"20px",height:"20px"}}),r?"Giri≈ü Yapƒ±lƒ±yor...":"Google ile Giri≈ü Yap"]}),(0,b.jsxs)("div",{style:{position:"relative",textAlign:"center",margin:"20px 0"},children:[(0,b.jsx)("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"1px",background:"#e0e0e0"}}),(0,b.jsx)("span",{style:{position:"relative",background:"white",padding:"0 15px",color:"#999",fontSize:"12px"},children:"veya"})]}),(0,b.jsxs)("form",{onSubmit:R,children:[(0,b.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",color:"#333",fontWeight:500},children:"Telefon Numarasƒ± veya E-posta"}),(0,b.jsx)("input",{type:"text",value:t,onChange:a=>u(a.target.value),placeholder:"05XX XXX XX XX veya email@ornek.com",required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"10px",fontSize:"14px"}})]}),(0,b.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",color:"#333",fontWeight:500},children:"≈ûifre"}),(0,b.jsx)("input",{type:"password",value:v,onChange:a=>w(a.target.value),placeholder:"≈ûifrenizi girin",required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"10px",fontSize:"14px"}})]}),(0,b.jsxs)("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px",background:r?"#ccc":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:600,cursor:r?"not-allowed":"pointer",boxShadow:"0 4px 15px rgba(102, 126, 234, 0.3)",transition:"all 0.3s ease"},children:[(0,b.jsx)("i",{className:"fas fa-sign-in-alt",style:{marginRight:"8px"}}),r?"Giri≈ü Yapƒ±lƒ±yor...":"Giri≈ü Yap"]})]}),(0,b.jsx)("div",{style:{textAlign:"center",marginTop:"20px"},children:(0,b.jsx)("a",{href:"#",onClick:a=>{a.preventDefault(),o(!1),q(!0)},style:{color:"#667eea",fontSize:"14px",textDecoration:"none"},children:"Hesabƒ±n yok mu? Hemen kayƒ±t ol"})})]})}),p&&(0,b.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.6)",zIndex:1e5,backdropFilter:"blur(5px)",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>q(!1),children:(0,b.jsxs)("div",{style:{background:"white",borderRadius:"20px",padding:"30px",width:"90%",maxWidth:"450px",maxHeight:"90vh",overflowY:"auto",position:"relative"},onClick:a=>a.stopPropagation(),children:[(0,b.jsx)("button",{onClick:()=>q(!1),style:{position:"absolute",top:"15px",right:"15px",background:"none",border:"none",fontSize:"24px",color:"#999",cursor:"pointer",padding:"5px",borderRadius:"50%",transition:"all 0.3s ease"},children:(0,b.jsx)("i",{className:"fas fa-times"})}),(0,b.jsxs)("div",{style:{textAlign:"center",marginBottom:"25px"},children:[(0,b.jsx)("h2",{style:{margin:"0 0 8px 0",fontSize:"24px",fontWeight:600,color:"#333"},children:"üéâ Kayƒ±t Ol"}),(0,b.jsx)("p",{style:{margin:0,fontSize:"14px",color:"#666"},children:"Hemen √ºye ol, avantajlardan faydalan!"})]}),(0,b.jsxs)("form",{onSubmit:U,children:[(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"15px"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",color:"#333",fontWeight:500},children:"ƒ∞sim"}),(0,b.jsx)("input",{type:"text",value:x.firstName,onChange:a=>y({...x,firstName:a.target.value}),placeholder:"ƒ∞sminiz",required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"10px",fontSize:"14px"}})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",color:"#333",fontWeight:500},children:"Soyisim"}),(0,b.jsx)("input",{type:"text",value:x.lastName,onChange:a=>y({...x,lastName:a.target.value}),placeholder:"Soyisminiz",required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"10px",fontSize:"14px"}})]})]}),(0,b.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",color:"#333",fontWeight:500},children:"Kullanƒ±cƒ± Adƒ±"}),(0,b.jsx)("input",{type:"text",value:x.nickName,onChange:a=>y({...x,nickName:a.target.value}),placeholder:"Kullanƒ±cƒ± adƒ±nƒ±z",required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"10px",fontSize:"14px"}})]}),(0,b.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",color:"#333",fontWeight:500},children:"E-posta"}),(0,b.jsx)("input",{type:"email",value:x.email,onChange:a=>y({...x,email:a.target.value}),placeholder:"email@ornek.com",required:!0,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"10px",fontSize:"14px"}})]}),(0,b.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",color:"#333",fontWeight:500},children:"Telefon Numarasƒ±"}),(0,b.jsx)("input",{type:"tel",value:x.phoneNumber,onChange:a=>y({...x,phoneNumber:a.target.value}),placeholder:"05XX XXX XX XX",required:!0,maxLength:11,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"10px",fontSize:"14px"}})]}),(0,b.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",color:"#333",fontWeight:500},children:"≈ûifre"}),(0,b.jsx)("input",{type:"password",value:x.password,onChange:a=>y({...x,password:a.target.value}),placeholder:"En az 6 karakter",required:!0,minLength:6,style:{width:"100%",padding:"12px",border:"1px solid #ddd",borderRadius:"10px",fontSize:"14px"}})]}),(0,b.jsxs)("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px",background:r?"#ccc":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:600,cursor:r?"not-allowed":"pointer",boxShadow:"0 4px 15px rgba(102, 126, 234, 0.3)",transition:"all 0.3s ease"},children:[(0,b.jsx)("i",{className:"fas fa-user-plus",style:{marginRight:"8px"}}),r?"Kayƒ±t Yapƒ±lƒ±yor...":"Kayƒ±t Ol"]})]}),(0,b.jsx)("div",{style:{textAlign:"center",marginTop:"20px"},children:(0,b.jsx)("a",{href:"#",onClick:a=>{a.preventDefault(),q(!1),o(!0)},style:{color:"#667eea",fontSize:"14px",textDecoration:"none"},children:"Zaten hesabƒ±n var mƒ±? Giri≈ü yap"})})]})})]})}function S({isOpen:a,onClose:d,customerCode:e,menuData:f}){let{messages:g,isLoading:h,isLoadingMenu:i,sendMessage:j,clearHistory:k}=function({customerCode:a,menuData:b}){let[d,e]=(0,c.useState)([]),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(30),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=localStorage.getItem("chatSessionId");a||(a=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem("chatSessionId",a)),k(a)},[]),(0,c.useEffect)(()=>{b&&b.categories?(console.log("‚úÖ Using external menu data from page:",{categoriesCount:b.categories.length}),m(b),o(!1)):(console.log("‚ö†Ô∏è No external menu data yet"),o(!0))},[b]),(0,c.useEffect)(()=>{if(!a)return;let b=`global_chat_history_${a}`,c=localStorage.getItem(b);if(c)try{let a=JSON.parse(c);e(a)}catch(a){console.error("Failed to parse chat history:",a)}},[a]);let p=(0,c.useCallback)(b=>{if(!a)return;let c=`global_chat_history_${a}`;localStorage.setItem(c,JSON.stringify(b))},[a]),q=(0,c.useCallback)((a,b)=>{let c={message:a,sender:b,timestamp:new Date().toISOString(),page:window.location.pathname};return e(a=>{let b=[...a,c];return p(b),b}),c},[p]),r=(0,c.useCallback)(async b=>{if(!b.trim()||!a)return null;if(h<=0){let a="G√ºnl√ºk 30 mesaj limitinize ula≈ütƒ±nƒ±z. Yarƒ±n tekrar deneyebilirsiniz. üòä";return q(a,"ai"),a}q(b,"user"),g(!0);try{let c=l?JSON.stringify(l):"";console.log("üì§ Sending message to AI:",{message:b.substring(0,50),customerCode:a,hasMenuData:!!l,menuDataLength:c.length,categoriesCount:l?.categories?.length||0});let d=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:b,customerCode:a,sessionId:j,pageUrl:window.location.href,menuData:c})}),e=await d.json();if(console.log("üì• Received AI response:",{success:e.success,hasResponse:!!e.response,source:e.source}),e.success)return void 0!==e.remainingMessages&&i(e.remainingMessages),q(e.response,"ai"),e.response;{let a=e.error||e.response||"Bir hata olu≈ütu. L√ºtfen tekrar deneyin.";return q(a,"ai"),a}}catch(b){console.error("Send message error:",b);let a="Baƒülantƒ± hatasƒ±. L√ºtfen internet baƒülantƒ±nƒ±zƒ± kontrol edin.";return q(a,"ai"),a}finally{g(!1)}},[a,j,l,h,q,n]);return{messages:d,isLoading:f,isLoadingMenu:n,remainingMessages:h,sendMessage:r,clearHistory:(0,c.useCallback)(()=>{if(e([]),a){let b=`global_chat_history_${a}`;localStorage.removeItem(b)}},[a])}}({customerCode:e,menuData:f}),[l,m]=(0,c.useState)(""),n=(0,c.useRef)(null),o=(0,c.useRef)(null);(0,c.useEffect)(()=>{n.current&&n.current.scrollIntoView({behavior:"smooth"})},[g]),(0,c.useEffect)(()=>{a&&o.current&&setTimeout(()=>{o.current?.focus()},300)},[a]);let p=async()=>{if(!l.trim()||h)return;let a=l.trim();m(""),await j(a)};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"ai-chat-overlay",onClick:d,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",opacity:+!!a,visibility:a?"visible":"hidden",transition:"all 0.3s ease",zIndex:99998}}),(0,b.jsxs)("div",{className:`ai-chat-sidebar ${a?"sidebar-open":""}`,style:{position:"fixed",top:0,left:a?0:"-100%",width:"100%",height:"100vh",background:"linear-gradient(180deg, #667eea 0%, #764ba2 100%)",transition:"left 0.3s ease",zIndex:99999,display:"flex",flexDirection:"column",boxShadow:"4px 0 20px rgba(0, 0, 0, 0.3)"},children:[(0,b.jsx)("div",{className:"chat-header",style:{background:"rgba(0, 0, 0, 0.2)",color:"white",padding:"15px 20px",flexShrink:0,borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,b.jsx)("i",{className:"fas fa-robot",style:{fontSize:"20px"}}),(0,b.jsx)("h3",{style:{margin:0,fontSize:"18px",fontWeight:600},children:"AI Men√º Asistanƒ±"})]}),(0,b.jsx)("button",{onClick:d,style:{background:"rgba(255, 255, 255, 0.2)",border:"2px solid rgba(255, 255, 255, 0.3)",color:"white",width:"32px",height:"32px",borderRadius:"50%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold"},children:"√ó"})]})}),(0,b.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"15px",display:"flex",flexDirection:"column",gap:"12px"},children:[0===g.length&&(0,b.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.95)",borderRadius:"12px 12px 12px 2px",padding:"12px 15px",color:"#333",fontSize:"14px",lineHeight:"1.5",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},children:"Merhaba! üëã Men√º ile ilgili her ≈üeyi sorabilirsiniz. Size nasƒ±l yardƒ±mcƒ± olabilirim? üòä"}),i&&0===g.length&&(0,b.jsx)("div",{style:{display:"flex",justifyContent:"flex-start"},children:(0,b.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.95)",borderRadius:"12px 12px 12px 2px",padding:"12px 15px",color:"#666",fontSize:"13px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[(0,b.jsx)("i",{className:"fas fa-spinner fa-spin"})," Men√º bilgileri y√ºkleniyor..."]})}),g.map((a,c)=>(0,b.jsx)("div",{style:{display:"flex",justifyContent:"user"===a.sender?"flex-end":"flex-start"},children:(0,b.jsx)("div",{style:{background:"user"===a.sender?"#fff":"rgba(255, 255, 255, 0.95)",borderRadius:"user"===a.sender?"12px 12px 2px 12px":"12px 12px 12px 2px",padding:"12px 15px",maxWidth:"85%",color:"#333",fontSize:"14px",lineHeight:"1.5",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",wordWrap:"break-word",whiteSpace:"pre-wrap"},children:a.message})},c)),h&&(0,b.jsx)("div",{style:{display:"flex",justifyContent:"flex-start"},children:(0,b.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.95)",borderRadius:"12px 12px 12px 2px",padding:"12px 15px",color:"#666",fontSize:"14px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[(0,b.jsx)("i",{className:"fas fa-spinner fa-spin"})," D√º≈ü√ºn√ºyorum..."]})}),(0,b.jsx)("div",{ref:n})]}),(0,b.jsxs)("div",{style:{padding:"15px",paddingBottom:"90px",background:"rgba(0, 0, 0, 0.2)",borderTop:"1px solid rgba(255, 255, 255, 0.1)",flexShrink:0},children:[(0,b.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,b.jsx)("input",{ref:o,type:"text",value:l,onChange:a=>m(a.target.value),onKeyPress:a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),p())},placeholder:i?"Men√º y√ºkleniyor...":"Mesajƒ±nƒ±zƒ± yazƒ±n...",disabled:h,style:{flex:1,padding:"12px 15px",border:"none",borderRadius:"25px",fontSize:"14px",background:"white",outline:"none"}}),(0,b.jsx)("button",{onClick:p,disabled:h||!l.trim(),style:{width:"48px",height:"48px",background:h||!l.trim()?"#ccc":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"50%",cursor:h||!l.trim()?"not-allowed":"pointer",fontSize:"18px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.2)"},children:(0,b.jsx)("i",{className:"fas fa-paper-plane"})})]}),g.length>0&&(0,b.jsxs)("button",{onClick:k,style:{width:"100%",marginTop:"8px",padding:"8px",background:"rgba(255, 255, 255, 0.1)",color:"white",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",fontSize:"12px",cursor:"pointer"},children:[(0,b.jsx)("i",{className:"fas fa-trash"})," Sohbeti Temizle"]})]})]})]})}function T({isOpen:a,onClose:d,venueCode:e}){let[f,g]=(0,c.useState)({name:"",newVenueRequest:"",type:"",content:""}),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)("idle"),l=async a=>{a.preventDefault(),i(!0);try{let a=await fetch("/api/suggestion/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerName:f.name||"Anonim",venueCode:e||"bilinmiyor",newVenueRequest:f.newVenueRequest,suggestionType:f.type,suggestionContent:f.content,userAgent:navigator.userAgent})});(await a.json()).success?(k("success"),setTimeout(()=>{d(),g({name:"",newVenueRequest:"",type:"",content:""}),k("idle")},2e3)):(k("error"),setTimeout(()=>k("idle"),2e3))}catch(a){console.error("Suggestion error:",a),k("error"),setTimeout(()=>k("idle"),2e3)}finally{i(!1)}};return a?(0,b.jsx)("div",{className:"modal-overlay",onClick:d,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(5px)",zIndex:1e5,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:(0,b.jsxs)("div",{className:"suggestion-modal-content",onClick:a=>a.stopPropagation(),style:{background:"linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%)",borderRadius:"20px",padding:"30px",width:"100%",maxWidth:"500px",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[(0,b.jsxs)("div",{style:{marginBottom:"20px",textAlign:"center"},children:[(0,b.jsx)("h2",{style:{margin:"0 0 10px 0",fontSize:"24px",color:"#fff",fontWeight:700},children:"üí° √ñneri & Geri Bildirim"}),(0,b.jsx)("p",{style:{margin:0,fontSize:"14px",color:"#aaa"},children:"Fikirleriniz bizim i√ßin deƒüerli!"})]}),(0,b.jsxs)("form",{onSubmit:l,children:[(0,b.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#ccc",fontWeight:600},children:"ƒ∞sim (Opsiyonel)"}),(0,b.jsx)("input",{type:"text",value:f.name,onChange:a=>g({...f,name:a.target.value}),placeholder:"Adƒ±nƒ±z",style:{width:"100%",padding:"12px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"10px",color:"#fff",fontSize:"14px"}})]}),(0,b.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#ccc",fontWeight:600},children:"üè™ G√∂rmek ƒ∞stediƒüiniz Mekan"}),(0,b.jsx)("input",{type:"text",value:f.newVenueRequest,onChange:a=>g({...f,newVenueRequest:a.target.value}),placeholder:"√ñrn: X Restoranƒ±, Y Kafe...",style:{width:"100%",padding:"12px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"10px",color:"#fff",fontSize:"14px"}})]}),(0,b.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#ccc",fontWeight:600},children:"Kategori"}),(0,b.jsxs)("select",{value:f.type,onChange:a=>g({...f,type:a.target.value}),required:!0,style:{width:"100%",padding:"12px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"10px",color:"#fff",fontSize:"14px"},children:[(0,b.jsx)("option",{value:"",children:"Se√ßiniz"}),(0,b.jsx)("option",{value:"suggestion",children:"üí° √ñneri"}),(0,b.jsx)("option",{value:"complaint",children:"üòû ≈ûikayet"}),(0,b.jsx)("option",{value:"compliment",children:"üòä Te≈üekk√ºr"}),(0,b.jsx)("option",{value:"feature",children:"‚ú® √ñzellik ƒ∞steƒüi"}),(0,b.jsx)("option",{value:"other",children:"üîñ Diƒüer"})]})]}),(0,b.jsxs)("div",{style:{marginBottom:"25px"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#ccc",fontWeight:600},children:"Mesajƒ±nƒ±z"}),(0,b.jsx)("textarea",{value:f.content,onChange:a=>g({...f,content:a.target.value}),required:!0,placeholder:"D√º≈ü√ºncelerinizi payla≈üƒ±n...",rows:5,style:{width:"100%",padding:"12px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"10px",color:"#fff",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}})]}),(0,b.jsx)("button",{type:"submit",disabled:h||"idle"!==j,style:{width:"100%",padding:"14px",background:"success"===j?"linear-gradient(135deg, #27ae60, #2ecc71)":"error"===j?"linear-gradient(135deg, #e74c3c, #c0392b)":h?"#666":"linear-gradient(135deg, #667eea, #764ba2)",color:"#fff",border:"none",borderRadius:"12px",fontSize:"16px",fontWeight:700,cursor:h||"idle"!==j?"not-allowed":"pointer",transition:"all 0.3s ease",marginBottom:"10px"},children:"success"===j?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("i",{className:"fas fa-heart",style:{marginRight:"8px"}}),"Te≈üekk√ºrler!"]}):"error"===j?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("i",{className:"fas fa-exclamation-triangle",style:{marginRight:"8px"}}),"Hata!"]}):h?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("i",{className:"fas fa-spinner fa-spin",style:{marginRight:"8px"}}),"G√∂nderiliyor..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("i",{className:"fas fa-paper-plane",style:{marginRight:"8px"}}),"G√∂nder"]})}),(0,b.jsx)("button",{type:"button",onClick:d,style:{width:"100%",padding:"12px",background:"rgba(255, 255, 255, 0.1)",color:"#ccc",border:"none",borderRadius:"10px",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:"ƒ∞ptal"})]})]})}):null}function U(){let[a,d]=(0,c.useState)(!1);return((0,c.useEffect)(()=>{"true"===localStorage.getItem("menupark_emailVerified")&&(localStorage.removeItem("menupark_emailVerified"),d(!0),setTimeout(()=>{d(!1)},2e3))},[]),a)?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.default,{id:"9533bfd2df5803e1",children:"@keyframes slideDown{0%{opacity:0;transform:translate(-50%)translateY(-20px)}to{opacity:1;transform:translate(-50%)translateY(0)}}@keyframes slideUp{0%{opacity:1;transform:translate(-50%)translateY(0)}to{opacity:0;transform:translate(-50%)translateY(-20px)}}.email-verified-popup.jsx-9533bfd2df5803e1{color:#fff;z-index:100001;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-radius:12px;align-items:center;gap:12px;padding:20px 40px;font-size:16px;font-weight:600;animation:.3s ease-out slideDown;display:flex;position:fixed;top:20px;left:50%;transform:translate(-50%);box-shadow:0 10px 30px #0000004d}.email-verified-popup.hiding.jsx-9533bfd2df5803e1{animation:.3s ease-out slideUp}"}),(0,b.jsxs)("div",{className:`jsx-9533bfd2df5803e1 email-verified-popup ${!a?"hiding":""}`,children:[(0,b.jsx)("span",{style:{fontSize:"24px"},className:"jsx-9533bfd2df5803e1",children:"‚úì"}),(0,b.jsx)("span",{className:"jsx-9533bfd2df5803e1",children:"Email adresiniz ba≈üarƒ±yla doƒürulandƒ±!"})]})]}):null}function V({isOpen:a,onClose:c,errorMessage:d,remainingSeconds:e,isRegistered:f}){if(!a)return null;let g=Math.floor(e/60),h=e%60,i=g>0?`${g} dakika ${h} saniye`:`${h} saniye`,j=f?null:"üí° √úye olun ve 10 dakikada bir √ßaƒüƒ±rƒ±n!";return(0,b.jsx)("div",{onClick:c,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(5px)",zIndex:1e5,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:(0,b.jsxs)("div",{onClick:a=>a.stopPropagation(),style:{background:"linear-gradient(135deg, rgba(255, 152, 0, 0.95) 0%, rgba(251, 140, 0, 0.95) 100%)",color:"white",padding:"30px",borderRadius:"20px",textAlign:"center",fontSize:"15px",fontWeight:500,boxShadow:"0 20px 60px rgba(0, 0, 0, 0.4)",maxWidth:"450px",width:"100%",lineHeight:1.6},children:[(0,b.jsx)("div",{style:{fontSize:"48px",marginBottom:"15px"},children:"‚è∞"}),(0,b.jsx)("div",{style:{fontWeight:700,fontSize:"20px",marginBottom:"15px"},children:"Garson √áaƒüƒ±rma Limiti"}),(0,b.jsx)("div",{style:{marginBottom:"20px",fontSize:"15px",opacity:.95},children:d}),(0,b.jsxs)("div",{style:{background:"rgba(255, 255, 255, 0.2)",padding:"15px",borderRadius:"12px",marginBottom:"20px",border:"1px solid rgba(255, 255, 255, 0.3)"},children:[(0,b.jsx)("div",{style:{fontSize:"13px",opacity:.9,marginBottom:"8px"},children:"Kalan S√ºre:"}),(0,b.jsx)("div",{style:{fontSize:"24px",fontWeight:700},children:i})]}),(0,b.jsxs)("div",{style:{paddingTop:"20px",borderTop:"1px solid rgba(255, 255, 255, 0.3)",fontSize:"14px",opacity:.95},children:[(0,b.jsx)("div",{style:{marginBottom:j?"8px":0},children:f?"‚ÑπÔ∏è √úye kullanƒ±cƒ±lar 10 dakikada bir garson √ßaƒüƒ±rabilir":"‚ÑπÔ∏è Misafirler 30 dakikada bir garson √ßaƒüƒ±rabilir"}),j&&(0,b.jsx)("div",{style:{fontWeight:600,fontSize:"15px",marginTop:"8px"},children:j})]}),(0,b.jsx)("button",{onClick:c,style:{marginTop:"25px",width:"100%",padding:"14px",background:"rgba(255, 255, 255, 0.25)",border:"1px solid rgba(255, 255, 255, 0.4)",borderRadius:"12px",color:"#fff",fontSize:"15px",fontWeight:700,cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:a=>{a.currentTarget.style.background="rgba(255, 255, 255, 0.35)"},onMouseLeave:a=>{a.currentTarget.style.background="rgba(255, 255, 255, 0.25)"},children:"Tamam"})]})})}function W({menuData:a,categoriesData:d,customerLogo:e,backgroundUrl:f,bannerUrl:g,onImagesLoaded:h}){let[i,j]=(0,c.useState)([]),k=(0,c.useRef)(0),l=(0,c.useRef)(0),m=(0,c.useRef)(!1);(0,c.useEffect)(()=>{if(!a)return;let b=new Set;f&&b.add(f),e&&b.add(e),g&&b.add(g),d&&d.forEach(a=>{if(a.picture){let c=a.picture;if(c.startsWith("http://")||c.startsWith("https://"))c.startsWith("http://")&&(c=c.replace("http://","https://"));else{let a=c.startsWith("Uploads/")?c.substring(8):c;c=`https://api.canlimenu.com/Uploads/${a}`}b.add(c)}}),a.menu.forEach(a=>{a.products.forEach(a=>{if(a.picture){let c=a.picture;if(c.startsWith("http://")||c.startsWith("https://"))c.startsWith("http://")&&(c=c.replace("http://","https://"));else{let a=c.startsWith("Uploads/")?c.substring(8):c;c=`https://api.canlimenu.com/Uploads/${a}`}b.add(c)}})});let c=Array.from(b);j(c),l.current=c.length,k.current=0,m.current=!1},[a,d,e,f,g]);let n=()=>{k.current++,k.current>=l.current&&!m.current&&h&&(m.current=!0,h())};return 0===i.length?null:(0,b.jsx)("div",{id:"imagePreloadContainer",style:{position:"absolute",width:0,height:0,overflow:"hidden",opacity:0,pointerEvents:"none"},"aria-hidden":"true",children:i.map((a,c)=>(0,b.jsx)("img",{src:a,alt:`Preload ${c}`,loading:"eager",fetchPriority:c<50?"high":"auto",decoding:"async",onLoad:n,onError:()=>{k.current++,k.current>=l.current&&!m.current&&h&&(m.current=!0,h())},style:{display:"none"}},`preload-${c}`))})}function X(){let a=(0,d.useParams)(),m=(0,d.useSearchParams)(),p=a.code,s=m.get("table"),t=m.get("session"),u=m.get("joinRoom"),v=m.get("joinBackgammon"),{isTableMode:w,isSelfService:x,canCallWaiter:B,tableId:D}=(0,f.useTable)(),{language:F}=(0,g.useLanguage)(),{currentUser:G}=(0,h.useAuth)(),{setMenuData:H,setCustomerData:I,setCategoriesData:J,setCustomerCode:K,setTableId:L,tableId:M,setProductTokenSettings:N,setUserTokenBalance:O,isGameModalOpen:X,activeGame:Y,openGameModal:Z,closeProductListModal:$,closeProductDetailModal:_,closeGameModal:aa,setPendingJoinRoomId:ab,isProfileOpen:ac,openProfile:ad,closeProfile:ae}=(0,e.useMenu)();(0,c.useEffect)(()=>{},[w,x,B,D,s,t]);let[af,ag]=(0,c.useState)(!0),[ah,ai]=(0,c.useState)(!1),[aj,ak]=(0,c.useState)(null),[al,am]=(0,c.useState)(null),[an,ao]=(0,c.useState)([]),[ap,aq]=(0,c.useState)(!0),[ar,as]=(0,c.useState)(!1),[at,au]=(0,c.useState)(null),[av,aw]=(0,c.useState)(!1),[ax,ay]=(0,c.useState)(!1),[az,aA]=(0,c.useState)(!1),[aB,aC]=(0,c.useState)({isOpen:!1,errorMessage:"",remainingSeconds:0,isRegistered:!1}),aD=(0,c.useCallback)(a=>{let b=localStorage.getItem("userData");if(b){let c=JSON.parse(b),d=c.id||c.userId||c.Id;d&&d===a.userId&&(O(a.currentTokens),a.message&&window.dispatchEvent(new CustomEvent("tokenBalanceUpdated",{detail:{balance:a.currentTokens,message:a.message}})))}},[O]);!function({customerId:a,onTokenBalanceUpdated:b,enabled:d=!0}){let e=(0,c.useRef)(null),f=(0,c.useRef)(void 0);(0,c.useEffect)(()=>{if(!d)return;if(e.current?.state===i.HubConnectionState.Connected)return void console.log("üîó SignalR: Already connected");let c=new j.HubConnectionBuilder().withUrl("https://api.canlimenu.com/apimenuhub",{transport:k.HttpTransportType.WebSockets|k.HttpTransportType.LongPolling}).withAutomaticReconnect([0,2e3,1e4,3e4]).configureLogging(l.LogLevel.Error).build();return e.current=c,c.onclose(()=>{console.log("üîå SignalR: Connection closed")}),c.onreconnecting(a=>{console.log("üîÑ SignalR: Reconnecting...",a)}),c.onreconnected(b=>{console.log("‚úÖ SignalR: Reconnected",b),a&&a>0&&c.invoke("JoinCustomerGroup",a).catch(a=>console.error("‚ùå SignalR: JoinCustomerGroup failed on reconnect",a))}),c.on("AdminApproveOrder",()=>{}),c.on("OrderStatusUpdate",()=>{}),c.on("OrderStatusChanged",()=>{}),c.on("OrderProcessResult",()=>{}),c.on("NewOrder",()=>{}),b&&c.on("TokenBalanceUpdated",a=>{console.log("ü™ô SignalR: TokenBalanceUpdated",a),b(a)}),c.start().then(()=>{if(console.log("‚úÖ SignalR: Connected successfully"),a&&a>0)return c.invoke("JoinCustomerGroup",a)}).then(()=>{a&&a>0&&console.log(`‚úÖ SignalR: Joined customer group ${a}`)}).catch(a=>{console.error("‚ùå SignalR: Connection failed",a)}),()=>{f.current&&clearTimeout(f.current),e.current&&e.current.stop().then(()=>console.log("üîå SignalR: Disconnected")).catch(a=>console.error("‚ùå SignalR: Disconnect error",a))}},[a,d,b]),e.current}({customerId:al?.customer.id,onTokenBalanceUpdated:aD,enabled:!!al?.customer.id}),(0,c.useEffect)(()=>{s&&L(s)},[s,L]),(0,c.useEffect)(()=>{async function a(){try{aq(!0),K(p);let a=await fetch(`/api/customer/${p}`);if(!a.ok)throw Error("M√º≈üteri bilgisi y√ºklenemedi");let b=await a.json();if(am(b),I(b),aq(!1),s&&b.customer.id){let a=await fetch(`/api/tables/${b.customer.id}`);if(a.ok){let b=(await a.json()).find(a=>a.secureId?.toLowerCase()===s.toLowerCase()||a.name?.toLowerCase()===s.toLowerCase());if(!b){window.location.href=`/${p}`;return}let c=b.name||b.tableName||s;localStorage.setItem("currentTableName",c)}}as(!0);let[c,d]=await Promise.all([fetch(`/api/menu/${p}`),fetch(`/api/categories/${p}`)]);if(!c.ok||!d.ok)throw Error("Veri y√ºklenemedi");let[e,f]=await Promise.all([c.json(),d.json()]);if(ak(e),ao(f),H(e),J(f),s)try{let a=await fetch(`/api/token-settings/${p}`);if(a.ok){let b=await a.json(),c={};b.settings.forEach(a=>{a.productId&&(c[a.productId]=a),a.sambaProductId&&(c[a.sambaProductId]=a)}),N(c)}}catch(a){console.error("Token settings load error:",a)}as(!1),au(null)}catch(a){console.error("Data fetch error:",a),au(a instanceof Error?a.message:"Bir hata olu≈ütu"),aq(!1),as(!1)}}p&&a()},[p,H]),(0,c.useEffect)(()=>{!ar&&al?.customer.showBanner&&al?.customer.banner&&ai(!0)},[ar,al]),(0,c.useEffect)(()=>{if(af||ap||!u)return;ab(u),Z("okey");let a=new URL(window.location.href);a.searchParams.delete("joinRoom"),window.history.replaceState({},"",a.toString())},[af,ap,u,G,ab,ad,Z]),(0,c.useEffect)(()=>{if(af||ap||!v)return;ab(v),Z("backgammon");let a=new URL(window.location.href);a.searchParams.delete("joinBackgammon"),window.history.replaceState({},"",a.toString())},[af,ap,v,G,ab,ad,Z]);let aE=async()=>{if(!M)return void alert("Masa bilgisi bulunamadƒ±. L√ºtfen QR kodu tekrar okutun.");try{let a=localStorage.getItem("userData"),b=a?JSON.parse(a).id:null,c=await fetch("/api/waiter-call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({CustomerCode:p,TableName:M,Message:"Garson √ßaƒürƒ±sƒ±",CallType:"General",EndUserId:b})}),d=await c.json();if(c.ok&&d.success)aF();else if(d.isRateLimited)aG(d.error,d.remainingSeconds,d.isRegistered||!1);else throw Error(d.error||"Garson √ßaƒüƒ±rma i≈ülemi ba≈üarƒ±sƒ±z oldu.")}catch(a){console.error("Garson √ßaƒüƒ±rma hatasƒ±:",a),alert(a instanceof Error?a.message:"Garson √ßaƒüƒ±rma i≈ülemi ba≈üarƒ±sƒ±z oldu. L√ºtfen tekrar deneyin.")}},aF=()=>{let a=document.createElement("div");a.innerHTML=`
      <div style="
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(76, 175, 80, 0.95);
        color: white;
        padding: 20px 30px;
        border-radius: 15px;
        text-align: center;
        z-index: 10000;
        font-size: 16px;
        font-weight: 600;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      ">
        <div style="font-size: 24px; margin-bottom: 10px;">‚úÖ</div>
        <div>Garson \xe7aƒüƒ±rƒ±ldƒ±!</div>
        <div style="font-size: 14px; opacity: 0.9; margin-top: 5px;">En kƒ±sa s\xfcrede yanƒ±nƒ±zda olacak</div>
      </div>
    `,document.body.appendChild(a),setTimeout(()=>{document.body.contains(a)&&document.body.removeChild(a)},3e3)},aG=(a,b,c)=>{aC({isOpen:!0,errorMessage:a,remainingSeconds:b,isRegistered:c})};if(ap||ar){let a=al?.customer.logo?al.customer.logo.startsWith("http")?al.customer.logo.replace("http://","https://"):`https://api.canlimenu.com/Uploads/${al.customer.logo.replace("Uploads/","")}`:void 0,c=al?.customer.webBackground?al.customer.webBackground.startsWith("http")?al.customer.webBackground.replace("http://","https://"):`https://api.canlimenu.com/Uploads/${al.customer.webBackground.replace("Uploads/","")}`:void 0;return(0,b.jsx)(q,{logoUrl:a,backgroundUrl:c})}if(at||!aj)return(0,b.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:(0,b.jsxs)("div",{style:{color:"white",textAlign:"center"},children:[(0,b.jsx)("h1",{style:{fontSize:"24px",marginBottom:"10px"},children:"‚ùå Hata"}),(0,b.jsx)("p",{children:at||"Men√º bulunamadƒ±"})]})});let aH=aj.menu||[],aI=al?.customer.logo?al.customer.logo.startsWith("http")?al.customer.logo.replace("http://","https://"):`https://api.canlimenu.com/Uploads/${al.customer.logo.replace("Uploads/","")}`:aj.customerLogo?aj.customerLogo.startsWith("http")?aj.customerLogo.replace("http://","https://"):`https://api.canlimenu.com/Uploads/${aj.customerLogo.replace("Uploads/","")}`:void 0,aJ=al?.customer.webBackground?al.customer.webBackground.startsWith("http")?al.customer.webBackground.replace("http://","https://"):`https://api.canlimenu.com/Uploads/${al.customer.webBackground.replace("Uploads/","")}`:void 0,aK=al?.customer.showBanner&&al?.customer.banner?al.customer.banner.startsWith("http")?al.customer.banner.replace("http://","https://"):`https://api.canlimenu.com/Uploads/${al.customer.banner.replace("Uploads/","")}`:void 0,aL=aJ?{backgroundImage:`url('${aJ}')`,backgroundPosition:"center center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundAttachment:"fixed"}:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},aM=aH.map(a=>{let b=an.find(b=>b.category.sambaId===a.sambaId),c="";if(b&&b.picture){let a=b.picture;if(a.startsWith("http"))c=a.replace("http://","https://");else{let b=a.startsWith("Uploads/")?a.substring(8):a;c=`https://api.canlimenu.com/Uploads/${b}`}}else c=aI||'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="300" height="300"%3E%3Crect fill="%23667eea" width="300" height="300"/%3E%3C/svg%3E';let d=b?.category?.titleEnglish||"";return{id:a.sambaId,name:a.title,nameEn:d,image:c}});return(0,b.jsxs)(b.Fragment,{children:[af&&aI&&(0,b.jsx)(n,{logoUrl:aI,backgroundUrl:aJ,onComplete:()=>{ag(!1)}}),aK&&(0,b.jsx)(o,{bannerUrl:aK,isOpen:ah,onClose:()=>{ai(!1)}}),(0,b.jsx)(W,{menuData:aj,categoriesData:an,customerLogo:aI,backgroundUrl:aJ,bannerUrl:aK,onImagesLoaded:()=>{}}),(0,b.jsxs)("div",{className:"main-container",style:{...aL,minHeight:"100vh"},children:[(0,b.jsx)(r,{}),(0,b.jsx)(y,{customerCode:p,fallbackLogoUrl:aI}),(0,b.jsx)(z,{categories:aM})]}),"okey"!==Y&&(0,b.jsx)(A,{onProfileClick:()=>{aw(!1),ay(!1),ac?ae():ad()},onAIClick:()=>{aw(!1),ae(),ay(a=>!a)},onCartClick:()=>{ae(),ay(!1),aw(a=>!a)},onWaiterCall:aE,onGameClick:()=>{X?aa():(aw(!1),ae(),ay(!1),Z())},onContactClick:()=>{al?.customer.phone&&(window.location.href=`tel:${al.customer.phone}`)},onSuggestionClick:()=>aA(!0),showAIChat:al?.customer.showAIChat??!0,showCart:w,showWaiterCall:B,tableId:M||void 0,phone:al?.customer.phone,cartItemCount:0}),(0,b.jsx)(C,{}),(0,b.jsx)(E,{}),(0,b.jsx)(P,{}),w&&(0,b.jsx)(Q,{isOpen:av,onClose:()=>aw(!1),tableId:M||"",customerCode:p}),(0,b.jsx)(R,{isOpen:ac,onClose:ae,customerCode:p}),(0,b.jsx)(S,{isOpen:ax,onClose:()=>ay(!1),customerCode:p,menuData:aj?{customerCode:p,customerTitle:aj.customerTitle,categories:aj.menu.map(a=>({title:a.title,sambaId:a.sambaId.toString(),products:a.products.map(a=>({title:a.title,price:a.price,detail:a.detail||a.description||""}))}))}:void 0}),(0,b.jsx)(T,{isOpen:az,onClose:()=>aA(!1),venueCode:p}),(0,b.jsx)(U,{}),(0,b.jsx)(V,{isOpen:aB.isOpen,onClose:()=>aC({...aB,isOpen:!1}),errorMessage:aB.errorMessage,remainingSeconds:aB.remainingSeconds,isRegistered:aB.isRegistered})]})}a.s(["default",()=>X],63945)}];

//# sourceMappingURL=app_%5Bcode%5D_page_tsx_3a83e6c1._.js.map